<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Grouping Data – Data Analysis Tools</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sql_join.html" rel="next">
<link href="./sql_data_cleaning.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Analysis Tools</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sql_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_creating_database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Creating Database</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_statement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Query Statement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_text_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with Text</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_date_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with Date</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_group_windows_function.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_join.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_sub_queries_cte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subquery &amp; CTE</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Project</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_operators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_exploratory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">EDA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Project Concept</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./python_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./powerbi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power BI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./powerbi_data_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool_source.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Data Tool Referenece</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#group-by" id="toc-group-by" class="nav-link active" data-scroll-target="#group-by"><span class="header-section-number">7.1</span> GROUP BY</a>
  <ul class="collapse">
  <li><a href="#quick-illustration-of-group-by" id="toc-quick-illustration-of-group-by" class="nav-link" data-scroll-target="#quick-illustration-of-group-by">Quick illustration of GROUP BY:</a></li>
  <li><a href="#simple-group-by-with-count" id="toc-simple-group-by-with-count" class="nav-link" data-scroll-target="#simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></a></li>
  <li><a href="#group-by-with-multiple-columns" id="toc-group-by-with-multiple-columns" class="nav-link" data-scroll-target="#group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</a></li>
  <li><a href="#using-aggregate-functions" id="toc-using-aggregate-functions" class="nav-link" data-scroll-target="#using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</a></li>
  <li><a href="#having-clause-with-group-by" id="toc-having-clause-with-group-by" class="nav-link" data-scroll-target="#having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</a></li>
  <li><a href="#group-by-with-date" id="toc-group-by-with-date" class="nav-link" data-scroll-target="#group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></a></li>
  <li><a href="#group-by-with-expressions" id="toc-group-by-with-expressions" class="nav-link" data-scroll-target="#group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</a></li>
  <li><a href="#group-by-with-order-by" id="toc-group-by-with-order-by" class="nav-link" data-scroll-target="#group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></a></li>
  <li><a href="#grouping-with-a-conditional-aggregate" id="toc-grouping-with-a-conditional-aggregate" class="nav-link" data-scroll-target="#grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</a></li>
  </ul></li>
  <li><a href="#window-function" id="toc-window-function" class="nav-link" data-scroll-target="#window-function"><span class="header-section-number">7.2</span> Window Function</a>
  <ul class="collapse">
  <li><a href="#row_number" id="toc-row_number" class="nav-link" data-scroll-target="#row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</a></li>
  <li><a href="#quick-illustration-of-window-function" id="toc-quick-illustration-of-window-function" class="nav-link" data-scroll-target="#quick-illustration-of-window-function">Quick illustration of window function</a></li>
  <li><a href="#aggregate-function-sum-as-a-window-function" id="toc-aggregate-function-sum-as-a-window-function" class="nav-link" data-scroll-target="#aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</a></li>
  <li><a href="#rank" id="toc-rank" class="nav-link" data-scroll-target="#rank"><span class="header-section-number">7.2.3</span> RANK</a></li>
  <li><a href="#dense_rank" id="toc-dense_rank" class="nav-link" data-scroll-target="#dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</a></li>
  <li><a href="#ntile" id="toc-ntile" class="nav-link" data-scroll-target="#ntile"><span class="header-section-number">7.2.5</span> NTILE</a></li>
  <li><a href="#lag" id="toc-lag" class="nav-link" data-scroll-target="#lag"><span class="header-section-number">7.2.6</span> LAG</a></li>
  <li><a href="#lead" id="toc-lead" class="nav-link" data-scroll-target="#lead"><span class="header-section-number">7.2.7</span> LEAD</a></li>
  <li><a href="#combining-multiple-window-functions" id="toc-combining-multiple-window-functions" class="nav-link" data-scroll-target="#combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</a></li>
  </ul></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task"><span class="header-section-number">7.3</span> Task</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="group-by" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="group-by"><span class="header-section-number">7.1</span> GROUP BY</h2>
<p>The <code>GROUP BY</code> clause is used to arrange identical data into groups. It is often used with aggregate functions such as <code>COUNT()</code>, <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code>, and <code>MIN()</code> to perform operations on each group of data.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Basic Syntax</span></span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name1, aggregate_function(column_column2)</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-5" class="code-annotation-target"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> column_name1;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3" data-code-annotation="1">aggregate_function like <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code> etc.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="5" data-code-annotation="2">The name of the column to group the table by.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts of the <code>GROUP BY</code> clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>The <code>GROUP BY</code> clause groups rows that have the same values in specified columns into summary rows.</p></li>
<li><p>Functions such as <code>COUNT</code>, <code>SUM</code>, <code>AVG</code>, <code>MAX</code>, and <code>MIN</code> are commonly used with <code>GROUP BY</code> <strong>to perform calculations on each group</strong>.</p></li>
<li><p>The <code>HAVING</code> clause is used to filter groups based on conditions, similar to how <code>WHERE</code> filters rows.</p></li>
</ul>
</div>
</div>
</div>
<section id="example-table-sales" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-table-sales">Example Table: Sales</h4>
<div class="cell">
<div class="cell-output-display">
<div id="sbnishjyba" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sbnishjyba table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sbnishjyba thead, #sbnishjyba tbody, #sbnishjyba tfoot, #sbnishjyba tr, #sbnishjyba td, #sbnishjyba th {
  border-style: none;
}

#sbnishjyba p {
  margin: 0;
  padding: 0;
}

#sbnishjyba .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sbnishjyba .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sbnishjyba .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sbnishjyba .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sbnishjyba .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sbnishjyba .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sbnishjyba .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sbnishjyba .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sbnishjyba .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sbnishjyba .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sbnishjyba .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sbnishjyba .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sbnishjyba .gt_spanner_row {
  border-bottom-style: hidden;
}

#sbnishjyba .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sbnishjyba .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sbnishjyba .gt_from_md > :first-child {
  margin-top: 0;
}

#sbnishjyba .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sbnishjyba .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sbnishjyba .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#sbnishjyba .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sbnishjyba .gt_row_group_first td {
  border-top-width: 2px;
}

#sbnishjyba .gt_row_group_first th {
  border-top-width: 2px;
}

#sbnishjyba .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sbnishjyba .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sbnishjyba .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sbnishjyba .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sbnishjyba .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sbnishjyba .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sbnishjyba .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sbnishjyba .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sbnishjyba .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sbnishjyba .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sbnishjyba .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sbnishjyba .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sbnishjyba .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sbnishjyba .gt_left {
  text-align: left;
}

#sbnishjyba .gt_center {
  text-align: center;
}

#sbnishjyba .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sbnishjyba .gt_font_normal {
  font-weight: normal;
}

#sbnishjyba .gt_font_bold {
  font-weight: bold;
}

#sbnishjyba .gt_font_italic {
  font-style: italic;
}

#sbnishjyba .gt_super {
  font-size: 65%;
}

#sbnishjyba .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sbnishjyba .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sbnishjyba .gt_indent_1 {
  text-indent: 5px;
}

#sbnishjyba .gt_indent_2 {
  text-indent: 10px;
}

#sbnishjyba .gt_indent_3 {
  text-indent: 15px;
}

#sbnishjyba .gt_indent_4 {
  text-indent: 20px;
}

#sbnishjyba .gt_indent_5 {
  text-indent: 25px;
}

#sbnishjyba .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sbnishjyba div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="quick-illustration-of-group-by" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-group-by">Quick illustration of GROUP BY:</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To get the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-2" class="code-annotation-target"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="xspjsnwjmx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xspjsnwjmx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xspjsnwjmx thead, #xspjsnwjmx tbody, #xspjsnwjmx tfoot, #xspjsnwjmx tr, #xspjsnwjmx td, #xspjsnwjmx th {
  border-style: none;
}

#xspjsnwjmx p {
  margin: 0;
  padding: 0;
}

#xspjsnwjmx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xspjsnwjmx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xspjsnwjmx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xspjsnwjmx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xspjsnwjmx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xspjsnwjmx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xspjsnwjmx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xspjsnwjmx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xspjsnwjmx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xspjsnwjmx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xspjsnwjmx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xspjsnwjmx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xspjsnwjmx .gt_spanner_row {
  border-bottom-style: hidden;
}

#xspjsnwjmx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xspjsnwjmx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xspjsnwjmx .gt_from_md > :first-child {
  margin-top: 0;
}

#xspjsnwjmx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xspjsnwjmx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xspjsnwjmx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xspjsnwjmx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xspjsnwjmx .gt_row_group_first td {
  border-top-width: 2px;
}

#xspjsnwjmx .gt_row_group_first th {
  border-top-width: 2px;
}

#xspjsnwjmx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xspjsnwjmx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xspjsnwjmx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xspjsnwjmx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xspjsnwjmx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xspjsnwjmx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xspjsnwjmx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xspjsnwjmx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xspjsnwjmx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xspjsnwjmx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xspjsnwjmx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xspjsnwjmx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xspjsnwjmx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xspjsnwjmx .gt_left {
  text-align: left;
}

#xspjsnwjmx .gt_center {
  text-align: center;
}

#xspjsnwjmx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xspjsnwjmx .gt_font_normal {
  font-weight: normal;
}

#xspjsnwjmx .gt_font_bold {
  font-weight: bold;
}

#xspjsnwjmx .gt_font_italic {
  font-style: italic;
}

#xspjsnwjmx .gt_super {
  font-size: 65%;
}

#xspjsnwjmx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xspjsnwjmx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xspjsnwjmx .gt_indent_1 {
  text-indent: 5px;
}

#xspjsnwjmx .gt_indent_2 {
  text-indent: 10px;
}

#xspjsnwjmx .gt_indent_3 {
  text-indent: 15px;
}

#xspjsnwjmx .gt_indent_4 {
  text-indent: 20px;
}

#xspjsnwjmx .gt_indent_5 {
  text-indent: 25px;
}

#xspjsnwjmx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xspjsnwjmx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Full Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="nzjbeodkxj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nzjbeodkxj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nzjbeodkxj thead, #nzjbeodkxj tbody, #nzjbeodkxj tfoot, #nzjbeodkxj tr, #nzjbeodkxj td, #nzjbeodkxj th {
  border-style: none;
}

#nzjbeodkxj p {
  margin: 0;
  padding: 0;
}

#nzjbeodkxj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nzjbeodkxj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nzjbeodkxj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nzjbeodkxj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nzjbeodkxj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nzjbeodkxj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzjbeodkxj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nzjbeodkxj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nzjbeodkxj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nzjbeodkxj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nzjbeodkxj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nzjbeodkxj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nzjbeodkxj .gt_spanner_row {
  border-bottom-style: hidden;
}

#nzjbeodkxj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nzjbeodkxj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nzjbeodkxj .gt_from_md > :first-child {
  margin-top: 0;
}

#nzjbeodkxj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nzjbeodkxj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nzjbeodkxj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nzjbeodkxj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nzjbeodkxj .gt_row_group_first td {
  border-top-width: 2px;
}

#nzjbeodkxj .gt_row_group_first th {
  border-top-width: 2px;
}

#nzjbeodkxj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzjbeodkxj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nzjbeodkxj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nzjbeodkxj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzjbeodkxj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzjbeodkxj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nzjbeodkxj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nzjbeodkxj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nzjbeodkxj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzjbeodkxj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nzjbeodkxj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzjbeodkxj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nzjbeodkxj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzjbeodkxj .gt_left {
  text-align: left;
}

#nzjbeodkxj .gt_center {
  text-align: center;
}

#nzjbeodkxj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nzjbeodkxj .gt_font_normal {
  font-weight: normal;
}

#nzjbeodkxj .gt_font_bold {
  font-weight: bold;
}

#nzjbeodkxj .gt_font_italic {
  font-style: italic;
}

#nzjbeodkxj .gt_super {
  font-size: 65%;
}

#nzjbeodkxj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nzjbeodkxj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nzjbeodkxj .gt_indent_1 {
  text-indent: 5px;
}

#nzjbeodkxj .gt_indent_2 {
  text-indent: 10px;
}

#nzjbeodkxj .gt_indent_3 {
  text-indent: 15px;
}

#nzjbeodkxj .gt_indent_4 {
  text-indent: 20px;
}

#nzjbeodkxj .gt_indent_5 {
  text-indent: 25px;
}

#nzjbeodkxj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nzjbeodkxj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Grouped Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="simple-group-by-with-count" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To count the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-2" class="code-annotation-target"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="jcplllnfeg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jcplllnfeg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jcplllnfeg thead, #jcplllnfeg tbody, #jcplllnfeg tfoot, #jcplllnfeg tr, #jcplllnfeg td, #jcplllnfeg th {
  border-style: none;
}

#jcplllnfeg p {
  margin: 0;
  padding: 0;
}

#jcplllnfeg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jcplllnfeg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jcplllnfeg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jcplllnfeg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jcplllnfeg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jcplllnfeg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jcplllnfeg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jcplllnfeg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jcplllnfeg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jcplllnfeg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jcplllnfeg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jcplllnfeg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jcplllnfeg .gt_spanner_row {
  border-bottom-style: hidden;
}

#jcplllnfeg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jcplllnfeg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jcplllnfeg .gt_from_md > :first-child {
  margin-top: 0;
}

#jcplllnfeg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jcplllnfeg .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jcplllnfeg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#jcplllnfeg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jcplllnfeg .gt_row_group_first td {
  border-top-width: 2px;
}

#jcplllnfeg .gt_row_group_first th {
  border-top-width: 2px;
}

#jcplllnfeg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jcplllnfeg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jcplllnfeg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jcplllnfeg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jcplllnfeg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jcplllnfeg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jcplllnfeg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jcplllnfeg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jcplllnfeg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jcplllnfeg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jcplllnfeg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jcplllnfeg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jcplllnfeg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jcplllnfeg .gt_left {
  text-align: left;
}

#jcplllnfeg .gt_center {
  text-align: center;
}

#jcplllnfeg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jcplllnfeg .gt_font_normal {
  font-weight: normal;
}

#jcplllnfeg .gt_font_bold {
  font-weight: bold;
}

#jcplllnfeg .gt_font_italic {
  font-style: italic;
}

#jcplllnfeg .gt_super {
  font-size: 65%;
}

#jcplllnfeg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jcplllnfeg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jcplllnfeg .gt_indent_1 {
  text-indent: 5px;
}

#jcplllnfeg .gt_indent_2 {
  text-indent: 10px;
}

#jcplllnfeg .gt_indent_3 {
  text-indent: 15px;
}

#jcplllnfeg .gt_indent_4 {
  text-indent: 20px;
}

#jcplllnfeg .gt_indent_5 {
  text-indent: 25px;
}

#jcplllnfeg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jcplllnfeg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_number_of_sales" class="gt_row gt_center">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_number_of_sales" class="gt_row gt_center">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="group-by-with-multiple-columns" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</h3>
<p>Grouping by multiple columns can give more <em>granular summaries</em>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- count the number of sales per store and product:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, product_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id, product_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store and product id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="znevhxcnin" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#znevhxcnin table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#znevhxcnin thead, #znevhxcnin tbody, #znevhxcnin tfoot, #znevhxcnin tr, #znevhxcnin td, #znevhxcnin th {
  border-style: none;
}

#znevhxcnin p {
  margin: 0;
  padding: 0;
}

#znevhxcnin .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#znevhxcnin .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#znevhxcnin .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#znevhxcnin .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#znevhxcnin .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#znevhxcnin .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znevhxcnin .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#znevhxcnin .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#znevhxcnin .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#znevhxcnin .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#znevhxcnin .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#znevhxcnin .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#znevhxcnin .gt_spanner_row {
  border-bottom-style: hidden;
}

#znevhxcnin .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#znevhxcnin .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#znevhxcnin .gt_from_md > :first-child {
  margin-top: 0;
}

#znevhxcnin .gt_from_md > :last-child {
  margin-bottom: 0;
}

#znevhxcnin .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#znevhxcnin .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#znevhxcnin .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#znevhxcnin .gt_row_group_first td {
  border-top-width: 2px;
}

#znevhxcnin .gt_row_group_first th {
  border-top-width: 2px;
}

#znevhxcnin .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#znevhxcnin .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#znevhxcnin .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#znevhxcnin .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znevhxcnin .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#znevhxcnin .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#znevhxcnin .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#znevhxcnin .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#znevhxcnin .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#znevhxcnin .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#znevhxcnin .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#znevhxcnin .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#znevhxcnin .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#znevhxcnin .gt_left {
  text-align: left;
}

#znevhxcnin .gt_center {
  text-align: center;
}

#znevhxcnin .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#znevhxcnin .gt_font_normal {
  font-weight: normal;
}

#znevhxcnin .gt_font_bold {
  font-weight: bold;
}

#znevhxcnin .gt_font_italic {
  font-style: italic;
}

#znevhxcnin .gt_super {
  font-size: 65%;
}

#znevhxcnin .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#znevhxcnin .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#znevhxcnin .gt_indent_1 {
  text-indent: 5px;
}

#znevhxcnin .gt_indent_2 {
  text-indent: 10px;
}

#znevhxcnin .gt_indent_3 {
  text-indent: 15px;
}

#znevhxcnin .gt_indent_4 {
  text-indent: 20px;
}

#znevhxcnin .gt_indent_5 {
  text-indent: 25px;
}

#znevhxcnin .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#znevhxcnin div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="using-aggregate-functions" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Calculate the average amount of sales per store:</span></span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, </span>
<span id="annotated-cell-5-3"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(amount) <span class="kw">AS</span> <span class="fu">count</span>,</span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MIN</span>(amount) <span class="kw">AS</span>, lowest_amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1">1</button><span id="annotated-cell-5-5" class="code-annotation-target"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(amount) <span class="kw">AS</span> average_amount,</span>
<span id="annotated-cell-5-6"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MAX</span>(amount) <span class="kw">AS</span> highest_amount,</span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_anount</span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2">2</button><span id="annotated-cell-5-9" class="code-annotation-target"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="5" data-code-annotation="1">Get the average of all the amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="9" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ovlnhibyhx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ovlnhibyhx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ovlnhibyhx thead, #ovlnhibyhx tbody, #ovlnhibyhx tfoot, #ovlnhibyhx tr, #ovlnhibyhx td, #ovlnhibyhx th {
  border-style: none;
}

#ovlnhibyhx p {
  margin: 0;
  padding: 0;
}

#ovlnhibyhx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ovlnhibyhx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ovlnhibyhx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ovlnhibyhx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ovlnhibyhx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ovlnhibyhx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ovlnhibyhx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ovlnhibyhx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ovlnhibyhx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ovlnhibyhx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ovlnhibyhx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ovlnhibyhx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ovlnhibyhx .gt_spanner_row {
  border-bottom-style: hidden;
}

#ovlnhibyhx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ovlnhibyhx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ovlnhibyhx .gt_from_md > :first-child {
  margin-top: 0;
}

#ovlnhibyhx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ovlnhibyhx .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ovlnhibyhx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#ovlnhibyhx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ovlnhibyhx .gt_row_group_first td {
  border-top-width: 2px;
}

#ovlnhibyhx .gt_row_group_first th {
  border-top-width: 2px;
}

#ovlnhibyhx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovlnhibyhx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ovlnhibyhx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ovlnhibyhx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ovlnhibyhx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovlnhibyhx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ovlnhibyhx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ovlnhibyhx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ovlnhibyhx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ovlnhibyhx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ovlnhibyhx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovlnhibyhx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ovlnhibyhx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovlnhibyhx .gt_left {
  text-align: left;
}

#ovlnhibyhx .gt_center {
  text-align: center;
}

#ovlnhibyhx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ovlnhibyhx .gt_font_normal {
  font-weight: normal;
}

#ovlnhibyhx .gt_font_bold {
  font-weight: bold;
}

#ovlnhibyhx .gt_font_italic {
  font-style: italic;
}

#ovlnhibyhx .gt_super {
  font-size: 65%;
}

#ovlnhibyhx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ovlnhibyhx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ovlnhibyhx .gt_indent_1 {
  text-indent: 5px;
}

#ovlnhibyhx .gt_indent_2 {
  text-indent: 10px;
}

#ovlnhibyhx .gt_indent_3 {
  text-indent: 15px;
}

#ovlnhibyhx .gt_indent_4 {
  text-indent: 20px;
}

#ovlnhibyhx .gt_indent_5 {
  text-indent: 25px;
}

#ovlnhibyhx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ovlnhibyhx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="count">count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lowest_amount">lowest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="average_amount">average_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="highest_amount">highest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="count" class="gt_row gt_right">4</td>
<td headers="lowest_amount" class="gt_row gt_right">100</td>
<td headers="average_amount" class="gt_row gt_right">225</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="count" class="gt_row gt_right">3</td>
<td headers="lowest_amount" class="gt_row gt_right">200</td>
<td headers="average_amount" class="gt_row gt_right">200</td>
<td headers="highest_amount" class="gt_row gt_right">200</td>
<td headers="total_amount" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="count" class="gt_row gt_right">5</td>
<td headers="lowest_amount" class="gt_row gt_right">150</td>
<td headers="average_amount" class="gt_row gt_right">250</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="having-clause-with-group-by" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</h3>
<p>The <code>HAVING</code> clause is used to filter groups <strong>after the aggregation</strong>.</p>
<section id="quick-illustration-of-using-having" class="level4" data-number="7.1.4.1">
<h4 data-number="7.1.4.1" class="anchored" data-anchor-id="quick-illustration-of-using-having"><span class="header-section-number">7.1.4.1</span> Quick Illustration of using HAVING</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-3" class="code-annotation-target"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span>
<span id="annotated-cell-6-4"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-6-7"><a href="#annotated-cell-6-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2">2</button><span id="annotated-cell-6-8" class="code-annotation-target"><a href="#annotated-cell-6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">600</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="3" data-code-annotation="1">Group the table using the <code>store_id</code></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="8" data-code-annotation="2">Filter only stores with <code>total_amount</code> greater than 600</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="kecwxsjxic" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kecwxsjxic table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kecwxsjxic thead, #kecwxsjxic tbody, #kecwxsjxic tfoot, #kecwxsjxic tr, #kecwxsjxic td, #kecwxsjxic th {
  border-style: none;
}

#kecwxsjxic p {
  margin: 0;
  padding: 0;
}

#kecwxsjxic .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kecwxsjxic .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kecwxsjxic .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kecwxsjxic .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kecwxsjxic .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kecwxsjxic .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kecwxsjxic .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kecwxsjxic .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kecwxsjxic .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kecwxsjxic .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kecwxsjxic .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kecwxsjxic .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kecwxsjxic .gt_spanner_row {
  border-bottom-style: hidden;
}

#kecwxsjxic .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kecwxsjxic .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kecwxsjxic .gt_from_md > :first-child {
  margin-top: 0;
}

#kecwxsjxic .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kecwxsjxic .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kecwxsjxic .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kecwxsjxic .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kecwxsjxic .gt_row_group_first td {
  border-top-width: 2px;
}

#kecwxsjxic .gt_row_group_first th {
  border-top-width: 2px;
}

#kecwxsjxic .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kecwxsjxic .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kecwxsjxic .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kecwxsjxic .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kecwxsjxic .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kecwxsjxic .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kecwxsjxic .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kecwxsjxic .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kecwxsjxic .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kecwxsjxic .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kecwxsjxic .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kecwxsjxic .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kecwxsjxic .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kecwxsjxic .gt_left {
  text-align: left;
}

#kecwxsjxic .gt_center {
  text-align: center;
}

#kecwxsjxic .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kecwxsjxic .gt_font_normal {
  font-weight: normal;
}

#kecwxsjxic .gt_font_bold {
  font-weight: bold;
}

#kecwxsjxic .gt_font_italic {
  font-style: italic;
}

#kecwxsjxic .gt_super {
  font-size: 65%;
}

#kecwxsjxic .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kecwxsjxic .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kecwxsjxic .gt_indent_1 {
  text-indent: 5px;
}

#kecwxsjxic .gt_indent_2 {
  text-indent: 10px;
}

#kecwxsjxic .gt_indent_3 {
  text-indent: 15px;
}

#kecwxsjxic .gt_indent_4 {
  text-indent: 20px;
}

#kecwxsjxic .gt_indent_5 {
  text-indent: 25px;
}

#kecwxsjxic .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kecwxsjxic div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Grouped Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="duqpsimfld" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#duqpsimfld table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#duqpsimfld thead, #duqpsimfld tbody, #duqpsimfld tfoot, #duqpsimfld tr, #duqpsimfld td, #duqpsimfld th {
  border-style: none;
}

#duqpsimfld p {
  margin: 0;
  padding: 0;
}

#duqpsimfld .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#duqpsimfld .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#duqpsimfld .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#duqpsimfld .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#duqpsimfld .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#duqpsimfld .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#duqpsimfld .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#duqpsimfld .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#duqpsimfld .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#duqpsimfld .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#duqpsimfld .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#duqpsimfld .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#duqpsimfld .gt_spanner_row {
  border-bottom-style: hidden;
}

#duqpsimfld .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#duqpsimfld .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#duqpsimfld .gt_from_md > :first-child {
  margin-top: 0;
}

#duqpsimfld .gt_from_md > :last-child {
  margin-bottom: 0;
}

#duqpsimfld .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#duqpsimfld .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#duqpsimfld .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#duqpsimfld .gt_row_group_first td {
  border-top-width: 2px;
}

#duqpsimfld .gt_row_group_first th {
  border-top-width: 2px;
}

#duqpsimfld .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#duqpsimfld .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#duqpsimfld .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#duqpsimfld .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#duqpsimfld .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#duqpsimfld .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#duqpsimfld .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#duqpsimfld .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#duqpsimfld .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#duqpsimfld .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#duqpsimfld .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#duqpsimfld .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#duqpsimfld .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#duqpsimfld .gt_left {
  text-align: left;
}

#duqpsimfld .gt_center {
  text-align: center;
}

#duqpsimfld .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#duqpsimfld .gt_font_normal {
  font-weight: normal;
}

#duqpsimfld .gt_font_bold {
  font-weight: bold;
}

#duqpsimfld .gt_font_italic {
  font-style: italic;
}

#duqpsimfld .gt_super {
  font-size: 65%;
}

#duqpsimfld .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#duqpsimfld .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#duqpsimfld .gt_indent_1 {
  text-indent: 5px;
}

#duqpsimfld .gt_indent_2 {
  text-indent: 10px;
}

#duqpsimfld .gt_indent_3 {
  text-indent: 15px;
}

#duqpsimfld .gt_indent_4 {
  text-indent: 20px;
}

#duqpsimfld .gt_indent_5 {
  text-indent: 25px;
}

#duqpsimfld .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#duqpsimfld div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Filtered Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why HAVING when there is WHERE
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>HAVING</code> is used because <code>WHERE</code> can’t filter on aggregate functions (like <code>SUM</code>, <code>AVG</code>, <code>COUNT</code>) that are often used with grouped data.</p>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find stores with total sales greater than N300:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1">1</button><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-7-3"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3">3</button><span id="annotated-cell-7-5" class="code-annotation-target"><a href="#annotated-cell-7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">300</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="5" data-code-annotation="3">Filter all total_sales_amount greater than 300.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fptikvlrbc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fptikvlrbc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fptikvlrbc thead, #fptikvlrbc tbody, #fptikvlrbc tfoot, #fptikvlrbc tr, #fptikvlrbc td, #fptikvlrbc th {
  border-style: none;
}

#fptikvlrbc p {
  margin: 0;
  padding: 0;
}

#fptikvlrbc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fptikvlrbc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fptikvlrbc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fptikvlrbc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fptikvlrbc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fptikvlrbc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fptikvlrbc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fptikvlrbc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fptikvlrbc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fptikvlrbc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fptikvlrbc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fptikvlrbc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fptikvlrbc .gt_spanner_row {
  border-bottom-style: hidden;
}

#fptikvlrbc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fptikvlrbc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fptikvlrbc .gt_from_md > :first-child {
  margin-top: 0;
}

#fptikvlrbc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fptikvlrbc .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fptikvlrbc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#fptikvlrbc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fptikvlrbc .gt_row_group_first td {
  border-top-width: 2px;
}

#fptikvlrbc .gt_row_group_first th {
  border-top-width: 2px;
}

#fptikvlrbc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fptikvlrbc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fptikvlrbc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fptikvlrbc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fptikvlrbc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fptikvlrbc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fptikvlrbc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fptikvlrbc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fptikvlrbc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fptikvlrbc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fptikvlrbc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fptikvlrbc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fptikvlrbc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fptikvlrbc .gt_left {
  text-align: left;
}

#fptikvlrbc .gt_center {
  text-align: center;
}

#fptikvlrbc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fptikvlrbc .gt_font_normal {
  font-weight: normal;
}

#fptikvlrbc .gt_font_bold {
  font-weight: bold;
}

#fptikvlrbc .gt_font_italic {
  font-style: italic;
}

#fptikvlrbc .gt_super {
  font-size: 65%;
}

#fptikvlrbc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fptikvlrbc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fptikvlrbc .gt_indent_1 {
  text-indent: 5px;
}

#fptikvlrbc .gt_indent_2 {
  text-indent: 10px;
}

#fptikvlrbc .gt_indent_3 {
  text-indent: 15px;
}

#fptikvlrbc .gt_indent_4 {
  text-indent: 20px;
}

#fptikvlrbc .gt_indent_5 {
  text-indent: 25px;
}

#fptikvlrbc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fptikvlrbc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_left">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_left">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_left">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="group-by-with-date" class="level3" data-number="7.1.5">
<h3 data-number="7.1.5" class="anchored" data-anchor-id="group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></h3>
<p>You can also group by date or time intervals.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find the total sales per day:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_date, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> sales_date;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="2">Group all rows by each unique date (day).</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="kmycuusdmq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kmycuusdmq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kmycuusdmq thead, #kmycuusdmq tbody, #kmycuusdmq tfoot, #kmycuusdmq tr, #kmycuusdmq td, #kmycuusdmq th {
  border-style: none;
}

#kmycuusdmq p {
  margin: 0;
  padding: 0;
}

#kmycuusdmq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kmycuusdmq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kmycuusdmq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kmycuusdmq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kmycuusdmq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmycuusdmq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmycuusdmq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmycuusdmq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kmycuusdmq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kmycuusdmq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kmycuusdmq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kmycuusdmq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kmycuusdmq .gt_spanner_row {
  border-bottom-style: hidden;
}

#kmycuusdmq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kmycuusdmq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kmycuusdmq .gt_from_md > :first-child {
  margin-top: 0;
}

#kmycuusdmq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kmycuusdmq .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kmycuusdmq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#kmycuusdmq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kmycuusdmq .gt_row_group_first td {
  border-top-width: 2px;
}

#kmycuusdmq .gt_row_group_first th {
  border-top-width: 2px;
}

#kmycuusdmq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmycuusdmq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kmycuusdmq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kmycuusdmq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmycuusdmq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmycuusdmq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kmycuusdmq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kmycuusdmq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kmycuusdmq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmycuusdmq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmycuusdmq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmycuusdmq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmycuusdmq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmycuusdmq .gt_left {
  text-align: left;
}

#kmycuusdmq .gt_center {
  text-align: center;
}

#kmycuusdmq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kmycuusdmq .gt_font_normal {
  font-weight: normal;
}

#kmycuusdmq .gt_font_bold {
  font-weight: bold;
}

#kmycuusdmq .gt_font_italic {
  font-style: italic;
}

#kmycuusdmq .gt_super {
  font-size: 65%;
}

#kmycuusdmq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kmycuusdmq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kmycuusdmq .gt_indent_1 {
  text-indent: 5px;
}

#kmycuusdmq .gt_indent_2 {
  text-indent: 10px;
}

#kmycuusdmq .gt_indent_3 {
  text-indent: 15px;
}

#kmycuusdmq .gt_indent_4 {
  text-indent: 20px;
}

#kmycuusdmq .gt_indent_5 {
  text-indent: 25px;
}

#kmycuusdmq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kmycuusdmq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="daily_sales" class="gt_row gt_center">250</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="daily_sales" class="gt_row gt_center">600</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="daily_sales" class="gt_row gt_center">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-expressions" class="level3" data-number="7.1.6">
<h3 data-number="7.1.6" class="anchored" data-anchor-id="group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</h3>
<p>You can also use expressions or functions in <code>GROUP BY</code></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Group by the year of the sales date:</span></span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-4" class="code-annotation-target"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date) <span class="kw">AS</span> sales_day,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2">2</button><span id="annotated-cell-9-5" class="code-annotation-target"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3">3</button><span id="annotated-cell-9-7" class="code-annotation-target"><a href="#annotated-cell-9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date);</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="4" data-code-annotation="1">Extract the day from the date.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="5" data-code-annotation="2">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="7" data-code-annotation="3">Group all rows by each unique day.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="xlhtgqzgth" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xlhtgqzgth table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xlhtgqzgth thead, #xlhtgqzgth tbody, #xlhtgqzgth tfoot, #xlhtgqzgth tr, #xlhtgqzgth td, #xlhtgqzgth th {
  border-style: none;
}

#xlhtgqzgth p {
  margin: 0;
  padding: 0;
}

#xlhtgqzgth .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xlhtgqzgth .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xlhtgqzgth .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xlhtgqzgth .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xlhtgqzgth .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xlhtgqzgth .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xlhtgqzgth .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xlhtgqzgth .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xlhtgqzgth .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xlhtgqzgth .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xlhtgqzgth .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xlhtgqzgth .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xlhtgqzgth .gt_spanner_row {
  border-bottom-style: hidden;
}

#xlhtgqzgth .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xlhtgqzgth .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xlhtgqzgth .gt_from_md > :first-child {
  margin-top: 0;
}

#xlhtgqzgth .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xlhtgqzgth .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xlhtgqzgth .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#xlhtgqzgth .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xlhtgqzgth .gt_row_group_first td {
  border-top-width: 2px;
}

#xlhtgqzgth .gt_row_group_first th {
  border-top-width: 2px;
}

#xlhtgqzgth .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xlhtgqzgth .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xlhtgqzgth .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xlhtgqzgth .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xlhtgqzgth .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xlhtgqzgth .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xlhtgqzgth .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xlhtgqzgth .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xlhtgqzgth .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xlhtgqzgth .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xlhtgqzgth .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xlhtgqzgth .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xlhtgqzgth .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xlhtgqzgth .gt_left {
  text-align: left;
}

#xlhtgqzgth .gt_center {
  text-align: center;
}

#xlhtgqzgth .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xlhtgqzgth .gt_font_normal {
  font-weight: normal;
}

#xlhtgqzgth .gt_font_bold {
  font-weight: bold;
}

#xlhtgqzgth .gt_font_italic {
  font-style: italic;
}

#xlhtgqzgth .gt_super {
  font-size: 65%;
}

#xlhtgqzgth .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xlhtgqzgth .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xlhtgqzgth .gt_indent_1 {
  text-indent: 5px;
}

#xlhtgqzgth .gt_indent_2 {
  text-indent: 10px;
}

#xlhtgqzgth .gt_indent_3 {
  text-indent: 15px;
}

#xlhtgqzgth .gt_indent_4 {
  text-indent: 20px;
}

#xlhtgqzgth .gt_indent_5 {
  text-indent: 25px;
}

#xlhtgqzgth .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xlhtgqzgth div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="sales_day">sales_day</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">1</td>
<td headers="daily_sales" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">2</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">3</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">4</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">5</td>
<td headers="daily_sales" class="gt_row gt_right">600</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">6</td>
<td headers="daily_sales" class="gt_row gt_right">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-order-by" class="level3" data-number="7.1.7">
<h3 data-number="7.1.7" class="anchored" data-anchor-id="group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></h3>
<p>You can order the results of a <code>GROUP BY</code> query by the aggregated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-10-2"><a href="#annotated-cell-10-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-3" class="code-annotation-target"><a href="#annotated-cell-10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-5" class="code-annotation-target"><a href="#annotated-cell-10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="3">3</button><span id="annotated-cell-10-6" class="code-annotation-target"><a href="#annotated-cell-10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_sales_amount <span class="kw">DESC</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="3" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="5" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="6" data-code-annotation="3">Sort the aggregated output by the total sales amount in descending order.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="gqfpiswqyx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gqfpiswqyx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gqfpiswqyx thead, #gqfpiswqyx tbody, #gqfpiswqyx tfoot, #gqfpiswqyx tr, #gqfpiswqyx td, #gqfpiswqyx th {
  border-style: none;
}

#gqfpiswqyx p {
  margin: 0;
  padding: 0;
}

#gqfpiswqyx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gqfpiswqyx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gqfpiswqyx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gqfpiswqyx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gqfpiswqyx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gqfpiswqyx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gqfpiswqyx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gqfpiswqyx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gqfpiswqyx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gqfpiswqyx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gqfpiswqyx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gqfpiswqyx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gqfpiswqyx .gt_spanner_row {
  border-bottom-style: hidden;
}

#gqfpiswqyx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gqfpiswqyx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gqfpiswqyx .gt_from_md > :first-child {
  margin-top: 0;
}

#gqfpiswqyx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gqfpiswqyx .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gqfpiswqyx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#gqfpiswqyx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gqfpiswqyx .gt_row_group_first td {
  border-top-width: 2px;
}

#gqfpiswqyx .gt_row_group_first th {
  border-top-width: 2px;
}

#gqfpiswqyx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gqfpiswqyx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gqfpiswqyx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gqfpiswqyx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gqfpiswqyx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gqfpiswqyx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gqfpiswqyx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gqfpiswqyx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gqfpiswqyx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gqfpiswqyx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gqfpiswqyx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gqfpiswqyx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gqfpiswqyx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gqfpiswqyx .gt_left {
  text-align: left;
}

#gqfpiswqyx .gt_center {
  text-align: center;
}

#gqfpiswqyx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gqfpiswqyx .gt_font_normal {
  font-weight: normal;
}

#gqfpiswqyx .gt_font_bold {
  font-weight: bold;
}

#gqfpiswqyx .gt_font_italic {
  font-style: italic;
}

#gqfpiswqyx .gt_super {
  font-size: 65%;
}

#gqfpiswqyx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gqfpiswqyx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gqfpiswqyx .gt_indent_1 {
  text-indent: 5px;
}

#gqfpiswqyx .gt_indent_2 {
  text-indent: 10px;
}

#gqfpiswqyx .gt_indent_3 {
  text-indent: 15px;
}

#gqfpiswqyx .gt_indent_4 {
  text-indent: 20px;
}

#gqfpiswqyx .gt_indent_5 {
  text-indent: 25px;
}

#gqfpiswqyx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gqfpiswqyx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_center">1250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_center">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_center">600</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="grouping-with-a-conditional-aggregate" class="level3" data-number="7.1.8">
<h3 data-number="7.1.8" class="anchored" data-anchor-id="grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</h3>
<p>To calculate the number of sales and the total amount for each store, but only for sales over $100:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-11"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-11-1"><a href="#annotated-cell-11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="1">1</button><span id="annotated-cell-11-2" class="code-annotation-target"><a href="#annotated-cell-11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_sales_count,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="2">2</button><span id="annotated-cell-11-3" class="code-annotation-target"><a href="#annotated-cell-11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> amount <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_total_amount</span>
<span id="annotated-cell-11-4"><a href="#annotated-cell-11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-11-5"><a href="#annotated-cell-11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-11" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="2" data-code-annotation="1">If sales amount is greater than 100 count it.</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="3" data-code-annotation="2">If sales amount is greater than 100 then add sales amount else add zero.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="vqkcxzqmxo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vqkcxzqmxo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vqkcxzqmxo thead, #vqkcxzqmxo tbody, #vqkcxzqmxo tfoot, #vqkcxzqmxo tr, #vqkcxzqmxo td, #vqkcxzqmxo th {
  border-style: none;
}

#vqkcxzqmxo p {
  margin: 0;
  padding: 0;
}

#vqkcxzqmxo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vqkcxzqmxo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vqkcxzqmxo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vqkcxzqmxo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vqkcxzqmxo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vqkcxzqmxo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vqkcxzqmxo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vqkcxzqmxo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vqkcxzqmxo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vqkcxzqmxo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vqkcxzqmxo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vqkcxzqmxo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vqkcxzqmxo .gt_spanner_row {
  border-bottom-style: hidden;
}

#vqkcxzqmxo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vqkcxzqmxo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vqkcxzqmxo .gt_from_md > :first-child {
  margin-top: 0;
}

#vqkcxzqmxo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vqkcxzqmxo .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vqkcxzqmxo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#vqkcxzqmxo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vqkcxzqmxo .gt_row_group_first td {
  border-top-width: 2px;
}

#vqkcxzqmxo .gt_row_group_first th {
  border-top-width: 2px;
}

#vqkcxzqmxo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vqkcxzqmxo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vqkcxzqmxo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vqkcxzqmxo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vqkcxzqmxo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vqkcxzqmxo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vqkcxzqmxo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vqkcxzqmxo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vqkcxzqmxo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vqkcxzqmxo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vqkcxzqmxo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vqkcxzqmxo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vqkcxzqmxo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vqkcxzqmxo .gt_left {
  text-align: left;
}

#vqkcxzqmxo .gt_center {
  text-align: center;
}

#vqkcxzqmxo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vqkcxzqmxo .gt_font_normal {
  font-weight: normal;
}

#vqkcxzqmxo .gt_font_bold {
  font-weight: bold;
}

#vqkcxzqmxo .gt_font_italic {
  font-style: italic;
}

#vqkcxzqmxo .gt_super {
  font-size: 65%;
}

#vqkcxzqmxo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vqkcxzqmxo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vqkcxzqmxo .gt_indent_1 {
  text-indent: 5px;
}

#vqkcxzqmxo .gt_indent_2 {
  text-indent: 10px;
}

#vqkcxzqmxo .gt_indent_3 {
  text-indent: 15px;
}

#vqkcxzqmxo .gt_indent_4 {
  text-indent: 20px;
}

#vqkcxzqmxo .gt_indent_5 {
  text-indent: 25px;
}

#vqkcxzqmxo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vqkcxzqmxo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_sales_count">high_value_sales_count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_total_amount">high_value_total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">800</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="high_value_sales_count" class="gt_row gt_center">5</td>
<td headers="high_value_total_amount" class="gt_row gt_center">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group by Summary
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>It is often used with aggregate functions <strong>to perform calculations on each group.</strong></p></li>
<li><p><code>HAVING</code> clause can be used to filter groups after the aggregation.</p></li>
<li><p><code>ORDER BY</code> can be combined with <code>GROUP BY</code> to sort the results by the aggregated values.</p></li>
</ul>
</div>
</div>
<p><br> <br> <br></p>
<!------- GROUP BY ---------------------------------------------------------->
</section>
</section>
<section id="window-function" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="window-function"><span class="header-section-number">7.2</span> Window Function</h2>
<p>Window functions <strong>perform calculations across a set of table rows related to the current row</strong>. Unlike aggregate functions, which return a single value after grouping rows, window functions return multiple rows with calculated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-12-2"><a href="#annotated-cell-12-2" aria-hidden="true" tabindex="-1"></a>  col_name1, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1">1</button><span id="annotated-cell-12-3" class="code-annotation-target"><a href="#annotated-cell-12-3" aria-hidden="true" tabindex="-1"></a>  window_function() <span class="kw">OVER</span> ([<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2] [<span class="kw">ORDER</span> <span class="kw">BY</span> col_name3]) <span class="kw">AS</span> alias_name</span>
<span id="annotated-cell-12-4"><a href="#annotated-cell-12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="3" data-code-annotation="1">Define the window function and how it should be grouped and sorted.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Key Concepts of Window Function
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>OVER()</code> Clause defines the window of rows the function operates on.</li>
<li><code>PARTITION BY</code> divides the result set into <strong>partitions</strong> (like a GROUP BY).</li>
<li><code>ORDER BY</code> defines the order of rows within each partition.</li>
</ul>
</div>
</div>
<section id="row_number" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</h3>
<p>This function will assign a unique row number within a partition.</p>
</section>
<section id="quick-illustration-of-window-function" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-window-function">Quick illustration of window function</h3>
<p>A Simple example of how window function works.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">row_number</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="trfbdwipzz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#trfbdwipzz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#trfbdwipzz thead, #trfbdwipzz tbody, #trfbdwipzz tfoot, #trfbdwipzz tr, #trfbdwipzz td, #trfbdwipzz th {
  border-style: none;
}

#trfbdwipzz p {
  margin: 0;
  padding: 0;
}

#trfbdwipzz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#trfbdwipzz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#trfbdwipzz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#trfbdwipzz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#trfbdwipzz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#trfbdwipzz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#trfbdwipzz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#trfbdwipzz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#trfbdwipzz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#trfbdwipzz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#trfbdwipzz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#trfbdwipzz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#trfbdwipzz .gt_spanner_row {
  border-bottom-style: hidden;
}

#trfbdwipzz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#trfbdwipzz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#trfbdwipzz .gt_from_md > :first-child {
  margin-top: 0;
}

#trfbdwipzz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#trfbdwipzz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#trfbdwipzz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#trfbdwipzz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#trfbdwipzz .gt_row_group_first td {
  border-top-width: 2px;
}

#trfbdwipzz .gt_row_group_first th {
  border-top-width: 2px;
}

#trfbdwipzz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#trfbdwipzz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#trfbdwipzz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#trfbdwipzz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#trfbdwipzz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#trfbdwipzz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#trfbdwipzz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#trfbdwipzz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#trfbdwipzz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#trfbdwipzz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#trfbdwipzz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#trfbdwipzz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#trfbdwipzz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#trfbdwipzz .gt_left {
  text-align: left;
}

#trfbdwipzz .gt_center {
  text-align: center;
}

#trfbdwipzz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#trfbdwipzz .gt_font_normal {
  font-weight: normal;
}

#trfbdwipzz .gt_font_bold {
  font-weight: bold;
}

#trfbdwipzz .gt_font_italic {
  font-style: italic;
}

#trfbdwipzz .gt_super {
  font-size: 65%;
}

#trfbdwipzz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#trfbdwipzz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#trfbdwipzz .gt_indent_1 {
  text-indent: 5px;
}

#trfbdwipzz .gt_indent_2 {
  text-indent: 10px;
}

#trfbdwipzz .gt_indent_3 {
  text-indent: 15px;
}

#trfbdwipzz .gt_indent_4 {
  text-indent: 20px;
}

#trfbdwipzz .gt_indent_5 {
  text-indent: 25px;
}

#trfbdwipzz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#trfbdwipzz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="row_number">row_number</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br></p>
<section id="unordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="unordered">Unordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-14-3"><a href="#annotated-cell-14-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-14-4"><a href="#annotated-cell-14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1">1</button><span id="annotated-cell-14-5" class="code-annotation-target"><a href="#annotated-cell-14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-14-6"><a href="#annotated-cell-14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id then get the row number for each partition.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tnnkcfwyyw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tnnkcfwyyw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tnnkcfwyyw thead, #tnnkcfwyyw tbody, #tnnkcfwyyw tfoot, #tnnkcfwyyw tr, #tnnkcfwyyw td, #tnnkcfwyyw th {
  border-style: none;
}

#tnnkcfwyyw p {
  margin: 0;
  padding: 0;
}

#tnnkcfwyyw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tnnkcfwyyw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tnnkcfwyyw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tnnkcfwyyw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tnnkcfwyyw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tnnkcfwyyw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnnkcfwyyw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tnnkcfwyyw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tnnkcfwyyw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tnnkcfwyyw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tnnkcfwyyw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tnnkcfwyyw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tnnkcfwyyw .gt_spanner_row {
  border-bottom-style: hidden;
}

#tnnkcfwyyw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tnnkcfwyyw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tnnkcfwyyw .gt_from_md > :first-child {
  margin-top: 0;
}

#tnnkcfwyyw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tnnkcfwyyw .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tnnkcfwyyw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#tnnkcfwyyw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tnnkcfwyyw .gt_row_group_first td {
  border-top-width: 2px;
}

#tnnkcfwyyw .gt_row_group_first th {
  border-top-width: 2px;
}

#tnnkcfwyyw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnkcfwyyw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tnnkcfwyyw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tnnkcfwyyw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnnkcfwyyw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnkcfwyyw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tnnkcfwyyw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tnnkcfwyyw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tnnkcfwyyw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tnnkcfwyyw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tnnkcfwyyw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnkcfwyyw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tnnkcfwyyw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tnnkcfwyyw .gt_left {
  text-align: left;
}

#tnnkcfwyyw .gt_center {
  text-align: center;
}

#tnnkcfwyyw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tnnkcfwyyw .gt_font_normal {
  font-weight: normal;
}

#tnnkcfwyyw .gt_font_bold {
  font-weight: bold;
}

#tnnkcfwyyw .gt_font_italic {
  font-style: italic;
}

#tnnkcfwyyw .gt_super {
  font-size: 65%;
}

#tnnkcfwyyw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tnnkcfwyyw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tnnkcfwyyw .gt_indent_1 {
  text-indent: 5px;
}

#tnnkcfwyyw .gt_indent_2 {
  text-indent: 10px;
}

#tnnkcfwyyw .gt_indent_3 {
  text-indent: 15px;
}

#tnnkcfwyyw .gt_indent_4 {
  text-indent: 20px;
}

#tnnkcfwyyw .gt_indent_5 {
  text-indent: 25px;
}

#tnnkcfwyyw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tnnkcfwyyw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="ordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ordered">Ordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-15"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-15-1"><a href="#annotated-cell-15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-15-2"><a href="#annotated-cell-15-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-15-3"><a href="#annotated-cell-15-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-15-4"><a href="#annotated-cell-15-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-15" data-target-annotation="1">1</button><span id="annotated-cell-15-5" class="code-annotation-target"><a href="#annotated-cell-15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-15-6"><a href="#annotated-cell-15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-15" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-15" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id, then order by the sales date. Then get the row number by the partition. In other words, the rows are numbered sequentially for each store_id based on sales_date.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="yeudhczdom" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yeudhczdom table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yeudhczdom thead, #yeudhczdom tbody, #yeudhczdom tfoot, #yeudhczdom tr, #yeudhczdom td, #yeudhczdom th {
  border-style: none;
}

#yeudhczdom p {
  margin: 0;
  padding: 0;
}

#yeudhczdom .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yeudhczdom .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yeudhczdom .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yeudhczdom .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yeudhczdom .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yeudhczdom .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yeudhczdom .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yeudhczdom .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yeudhczdom .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yeudhczdom .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yeudhczdom .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yeudhczdom .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yeudhczdom .gt_spanner_row {
  border-bottom-style: hidden;
}

#yeudhczdom .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yeudhczdom .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yeudhczdom .gt_from_md > :first-child {
  margin-top: 0;
}

#yeudhczdom .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yeudhczdom .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yeudhczdom .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#yeudhczdom .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yeudhczdom .gt_row_group_first td {
  border-top-width: 2px;
}

#yeudhczdom .gt_row_group_first th {
  border-top-width: 2px;
}

#yeudhczdom .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yeudhczdom .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yeudhczdom .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yeudhczdom .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yeudhczdom .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yeudhczdom .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yeudhczdom .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yeudhczdom .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yeudhczdom .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yeudhczdom .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yeudhczdom .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yeudhczdom .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yeudhczdom .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yeudhczdom .gt_left {
  text-align: left;
}

#yeudhczdom .gt_center {
  text-align: center;
}

#yeudhczdom .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yeudhczdom .gt_font_normal {
  font-weight: normal;
}

#yeudhczdom .gt_font_bold {
  font-weight: bold;
}

#yeudhczdom .gt_font_italic {
  font-style: italic;
}

#yeudhczdom .gt_super {
  font-size: 65%;
}

#yeudhczdom .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yeudhczdom .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yeudhczdom .gt_indent_1 {
  text-indent: 5px;
}

#yeudhczdom .gt_indent_2 {
  text-indent: 10px;
}

#yeudhczdom .gt_indent_3 {
  text-indent: 15px;
}

#yeudhczdom .gt_indent_4 {
  text-indent: 20px;
}

#yeudhczdom .gt_indent_5 {
  text-indent: 25px;
}

#yeudhczdom .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yeudhczdom div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="aggregate-function-sum-as-a-window-function" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</h3>
<section id="quick-illustration-of-window-aggregate-functions" class="level4" data-number="7.2.2.1">
<h4 data-number="7.2.2.1" class="anchored" data-anchor-id="quick-illustration-of-window-aggregate-functions"><span class="header-section-number">7.2.2.1</span> Quick Illustration of window aggregate functions</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-16"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-16-1"><a href="#annotated-cell-16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="annotated-cell-16-2"><a href="#annotated-cell-16-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="annotated-cell-16-3"><a href="#annotated-cell-16-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="annotated-cell-16-4"><a href="#annotated-cell-16-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="1">1</button><span id="annotated-cell-16-5" class="code-annotation-target"><a href="#annotated-cell-16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span>) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-16-6"><a href="#annotated-cell-16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-16" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="5" data-code-annotation="1">Get the total amount of each partition.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="dlycxyyoyd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dlycxyyoyd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dlycxyyoyd thead, #dlycxyyoyd tbody, #dlycxyyoyd tfoot, #dlycxyyoyd tr, #dlycxyyoyd td, #dlycxyyoyd th {
  border-style: none;
}

#dlycxyyoyd p {
  margin: 0;
  padding: 0;
}

#dlycxyyoyd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dlycxyyoyd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dlycxyyoyd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dlycxyyoyd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dlycxyyoyd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dlycxyyoyd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dlycxyyoyd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dlycxyyoyd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dlycxyyoyd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dlycxyyoyd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dlycxyyoyd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dlycxyyoyd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dlycxyyoyd .gt_spanner_row {
  border-bottom-style: hidden;
}

#dlycxyyoyd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dlycxyyoyd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dlycxyyoyd .gt_from_md > :first-child {
  margin-top: 0;
}

#dlycxyyoyd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dlycxyyoyd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dlycxyyoyd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dlycxyyoyd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dlycxyyoyd .gt_row_group_first td {
  border-top-width: 2px;
}

#dlycxyyoyd .gt_row_group_first th {
  border-top-width: 2px;
}

#dlycxyyoyd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dlycxyyoyd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dlycxyyoyd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dlycxyyoyd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dlycxyyoyd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dlycxyyoyd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dlycxyyoyd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dlycxyyoyd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dlycxyyoyd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dlycxyyoyd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dlycxyyoyd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dlycxyyoyd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dlycxyyoyd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dlycxyyoyd .gt_left {
  text-align: left;
}

#dlycxyyoyd .gt_center {
  text-align: center;
}

#dlycxyyoyd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dlycxyyoyd .gt_font_normal {
  font-weight: normal;
}

#dlycxyyoyd .gt_font_bold {
  font-weight: bold;
}

#dlycxyyoyd .gt_font_italic {
  font-style: italic;
}

#dlycxyyoyd .gt_super {
  font-size: 65%;
}

#dlycxyyoyd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dlycxyyoyd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dlycxyyoyd .gt_indent_1 {
  text-indent: 5px;
}

#dlycxyyoyd .gt_indent_2 {
  text-indent: 10px;
}

#dlycxyyoyd .gt_indent_3 {
  text-indent: 15px;
}

#dlycxyyoyd .gt_indent_4 {
  text-indent: 20px;
}

#dlycxyyoyd .gt_indent_5 {
  text-indent: 25px;
}

#dlycxyyoyd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dlycxyyoyd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> running_total</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="djioousevg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#djioousevg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#djioousevg thead, #djioousevg tbody, #djioousevg tfoot, #djioousevg tr, #djioousevg td, #djioousevg th {
  border-style: none;
}

#djioousevg p {
  margin: 0;
  padding: 0;
}

#djioousevg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#djioousevg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#djioousevg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#djioousevg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#djioousevg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#djioousevg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djioousevg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#djioousevg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#djioousevg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#djioousevg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#djioousevg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#djioousevg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#djioousevg .gt_spanner_row {
  border-bottom-style: hidden;
}

#djioousevg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#djioousevg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#djioousevg .gt_from_md > :first-child {
  margin-top: 0;
}

#djioousevg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#djioousevg .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#djioousevg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#djioousevg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#djioousevg .gt_row_group_first td {
  border-top-width: 2px;
}

#djioousevg .gt_row_group_first th {
  border-top-width: 2px;
}

#djioousevg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#djioousevg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#djioousevg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#djioousevg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djioousevg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#djioousevg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#djioousevg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#djioousevg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#djioousevg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djioousevg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#djioousevg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#djioousevg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#djioousevg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#djioousevg .gt_left {
  text-align: left;
}

#djioousevg .gt_center {
  text-align: center;
}

#djioousevg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#djioousevg .gt_font_normal {
  font-weight: normal;
}

#djioousevg .gt_font_bold {
  font-weight: bold;
}

#djioousevg .gt_font_italic {
  font-style: italic;
}

#djioousevg .gt_super {
  font-size: 65%;
}

#djioousevg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#djioousevg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#djioousevg .gt_indent_1 {
  text-indent: 5px;
}

#djioousevg .gt_indent_2 {
  text-indent: 10px;
}

#djioousevg .gt_indent_3 {
  text-indent: 15px;
}

#djioousevg .gt_indent_4 {
  text-indent: 20px;
}

#djioousevg .gt_indent_5 {
  text-indent: 25px;
}

#djioousevg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#djioousevg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="running_total">running_total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="running_total" class="gt_row gt_right">550</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">650</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="rank" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="rank"><span class="header-section-number">7.2.3</span> RANK</h3>
<p>Ranks the rows within a partition. Ties result in the same rank, but with gaps in the sequence.</p>
<section id="quick-illustration" class="level4" data-number="7.2.3.1">
<h4 data-number="7.2.3.1" class="anchored" data-anchor-id="quick-illustration"><span class="header-section-number">7.2.3.1</span> Quick Illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    product,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    amount</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="zealcqooug" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zealcqooug table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zealcqooug thead, #zealcqooug tbody, #zealcqooug tfoot, #zealcqooug tr, #zealcqooug td, #zealcqooug th {
  border-style: none;
}

#zealcqooug p {
  margin: 0;
  padding: 0;
}

#zealcqooug .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zealcqooug .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zealcqooug .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zealcqooug .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zealcqooug .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zealcqooug .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zealcqooug .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zealcqooug .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zealcqooug .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zealcqooug .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zealcqooug .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zealcqooug .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zealcqooug .gt_spanner_row {
  border-bottom-style: hidden;
}

#zealcqooug .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zealcqooug .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zealcqooug .gt_from_md > :first-child {
  margin-top: 0;
}

#zealcqooug .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zealcqooug .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zealcqooug .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zealcqooug .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zealcqooug .gt_row_group_first td {
  border-top-width: 2px;
}

#zealcqooug .gt_row_group_first th {
  border-top-width: 2px;
}

#zealcqooug .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zealcqooug .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zealcqooug .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zealcqooug .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zealcqooug .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zealcqooug .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zealcqooug .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zealcqooug .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zealcqooug .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zealcqooug .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zealcqooug .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zealcqooug .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zealcqooug .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zealcqooug .gt_left {
  text-align: left;
}

#zealcqooug .gt_center {
  text-align: center;
}

#zealcqooug .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zealcqooug .gt_font_normal {
  font-weight: normal;
}

#zealcqooug .gt_font_bold {
  font-weight: bold;
}

#zealcqooug .gt_font_italic {
  font-style: italic;
}

#zealcqooug .gt_super {
  font-size: 65%;
}

#zealcqooug .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zealcqooug .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zealcqooug .gt_indent_1 {
  text-indent: 5px;
}

#zealcqooug .gt_indent_2 {
  text-indent: 10px;
}

#zealcqooug .gt_indent_3 {
  text-indent: 15px;
}

#zealcqooug .gt_indent_4 {
  text-indent: 20px;
}

#zealcqooug .gt_indent_5 {
  text-indent: 25px;
}

#zealcqooug .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zealcqooug div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">4</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="sowlfkamqf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#sowlfkamqf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#sowlfkamqf thead, #sowlfkamqf tbody, #sowlfkamqf tfoot, #sowlfkamqf tr, #sowlfkamqf td, #sowlfkamqf th {
  border-style: none;
}

#sowlfkamqf p {
  margin: 0;
  padding: 0;
}

#sowlfkamqf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#sowlfkamqf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#sowlfkamqf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#sowlfkamqf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#sowlfkamqf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sowlfkamqf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sowlfkamqf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#sowlfkamqf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#sowlfkamqf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#sowlfkamqf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#sowlfkamqf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#sowlfkamqf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#sowlfkamqf .gt_spanner_row {
  border-bottom-style: hidden;
}

#sowlfkamqf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#sowlfkamqf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#sowlfkamqf .gt_from_md > :first-child {
  margin-top: 0;
}

#sowlfkamqf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#sowlfkamqf .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#sowlfkamqf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#sowlfkamqf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#sowlfkamqf .gt_row_group_first td {
  border-top-width: 2px;
}

#sowlfkamqf .gt_row_group_first th {
  border-top-width: 2px;
}

#sowlfkamqf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sowlfkamqf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#sowlfkamqf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#sowlfkamqf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sowlfkamqf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#sowlfkamqf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#sowlfkamqf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#sowlfkamqf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#sowlfkamqf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#sowlfkamqf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sowlfkamqf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sowlfkamqf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#sowlfkamqf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#sowlfkamqf .gt_left {
  text-align: left;
}

#sowlfkamqf .gt_center {
  text-align: center;
}

#sowlfkamqf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#sowlfkamqf .gt_font_normal {
  font-weight: normal;
}

#sowlfkamqf .gt_font_bold {
  font-weight: bold;
}

#sowlfkamqf .gt_font_italic {
  font-style: italic;
}

#sowlfkamqf .gt_super {
  font-size: 65%;
}

#sowlfkamqf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#sowlfkamqf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#sowlfkamqf .gt_indent_1 {
  text-indent: 5px;
}

#sowlfkamqf .gt_indent_2 {
  text-indent: 10px;
}

#sowlfkamqf .gt_indent_3 {
  text-indent: 15px;
}

#sowlfkamqf .gt_indent_4 {
  text-indent: 20px;
}

#sowlfkamqf .gt_indent_5 {
  text-indent: 25px;
}

#sowlfkamqf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#sowlfkamqf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>If two rows have the same amount within the same store_id, they will get the same rank, and the next rank will be skipped.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="dense_rank" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</h3>
<p>Similar to <code>RANK()</code>, but without gaps in the ranking sequence.</p>
<section id="quick-illustration-1" class="level4" data-number="7.2.4.1">
<h4 data-number="7.2.4.1" class="anchored" data-anchor-id="quick-illustration-1"><span class="header-section-number">7.2.4.1</span> Quick Illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    product,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    amount</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="bmzrwscnud" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bmzrwscnud table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bmzrwscnud thead, #bmzrwscnud tbody, #bmzrwscnud tfoot, #bmzrwscnud tr, #bmzrwscnud td, #bmzrwscnud th {
  border-style: none;
}

#bmzrwscnud p {
  margin: 0;
  padding: 0;
}

#bmzrwscnud .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bmzrwscnud .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bmzrwscnud .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bmzrwscnud .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bmzrwscnud .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bmzrwscnud .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bmzrwscnud .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bmzrwscnud .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bmzrwscnud .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bmzrwscnud .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bmzrwscnud .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bmzrwscnud .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bmzrwscnud .gt_spanner_row {
  border-bottom-style: hidden;
}

#bmzrwscnud .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bmzrwscnud .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bmzrwscnud .gt_from_md > :first-child {
  margin-top: 0;
}

#bmzrwscnud .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bmzrwscnud .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bmzrwscnud .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bmzrwscnud .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bmzrwscnud .gt_row_group_first td {
  border-top-width: 2px;
}

#bmzrwscnud .gt_row_group_first th {
  border-top-width: 2px;
}

#bmzrwscnud .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bmzrwscnud .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bmzrwscnud .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bmzrwscnud .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bmzrwscnud .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bmzrwscnud .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bmzrwscnud .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bmzrwscnud .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bmzrwscnud .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bmzrwscnud .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bmzrwscnud .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bmzrwscnud .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bmzrwscnud .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bmzrwscnud .gt_left {
  text-align: left;
}

#bmzrwscnud .gt_center {
  text-align: center;
}

#bmzrwscnud .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bmzrwscnud .gt_font_normal {
  font-weight: normal;
}

#bmzrwscnud .gt_font_bold {
  font-weight: bold;
}

#bmzrwscnud .gt_font_italic {
  font-style: italic;
}

#bmzrwscnud .gt_super {
  font-size: 65%;
}

#bmzrwscnud .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bmzrwscnud .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bmzrwscnud .gt_indent_1 {
  text-indent: 5px;
}

#bmzrwscnud .gt_indent_2 {
  text-indent: 10px;
}

#bmzrwscnud .gt_indent_3 {
  text-indent: 15px;
}

#bmzrwscnud .gt_indent_4 {
  text-indent: 20px;
}

#bmzrwscnud .gt_indent_5 {
  text-indent: 25px;
}

#bmzrwscnud .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bmzrwscnud div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="dense_rank">dense_rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="jopwvtiajw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jopwvtiajw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jopwvtiajw thead, #jopwvtiajw tbody, #jopwvtiajw tfoot, #jopwvtiajw tr, #jopwvtiajw td, #jopwvtiajw th {
  border-style: none;
}

#jopwvtiajw p {
  margin: 0;
  padding: 0;
}

#jopwvtiajw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jopwvtiajw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jopwvtiajw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jopwvtiajw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jopwvtiajw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jopwvtiajw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jopwvtiajw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jopwvtiajw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jopwvtiajw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jopwvtiajw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jopwvtiajw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jopwvtiajw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jopwvtiajw .gt_spanner_row {
  border-bottom-style: hidden;
}

#jopwvtiajw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jopwvtiajw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jopwvtiajw .gt_from_md > :first-child {
  margin-top: 0;
}

#jopwvtiajw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jopwvtiajw .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jopwvtiajw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#jopwvtiajw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jopwvtiajw .gt_row_group_first td {
  border-top-width: 2px;
}

#jopwvtiajw .gt_row_group_first th {
  border-top-width: 2px;
}

#jopwvtiajw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jopwvtiajw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jopwvtiajw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jopwvtiajw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jopwvtiajw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jopwvtiajw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jopwvtiajw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jopwvtiajw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jopwvtiajw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jopwvtiajw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jopwvtiajw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jopwvtiajw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jopwvtiajw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jopwvtiajw .gt_left {
  text-align: left;
}

#jopwvtiajw .gt_center {
  text-align: center;
}

#jopwvtiajw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jopwvtiajw .gt_font_normal {
  font-weight: normal;
}

#jopwvtiajw .gt_font_bold {
  font-weight: bold;
}

#jopwvtiajw .gt_font_italic {
  font-style: italic;
}

#jopwvtiajw .gt_super {
  font-size: 65%;
}

#jopwvtiajw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jopwvtiajw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jopwvtiajw .gt_indent_1 {
  text-indent: 5px;
}

#jopwvtiajw .gt_indent_2 {
  text-indent: 10px;
}

#jopwvtiajw .gt_indent_3 {
  text-indent: 15px;
}

#jopwvtiajw .gt_indent_4 {
  text-indent: 20px;
}

#jopwvtiajw .gt_indent_5 {
  text-indent: 25px;
}

#jopwvtiajw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jopwvtiajw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This will rank rows without gaps, even if there are ties.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="ntile" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="ntile"><span class="header-section-number">7.2.5</span> NTILE</h3>
<p>Divides the result set into a specified number of buckets.</p>
<section id="quick-illustration-2" class="level4" data-number="7.2.5.1">
<h4 data-number="7.2.5.1" class="anchored" data-anchor-id="quick-illustration-2"><span class="header-section-number">7.2.5.1</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    product, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">3</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="gktgrjxlct" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gktgrjxlct table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gktgrjxlct thead, #gktgrjxlct tbody, #gktgrjxlct tfoot, #gktgrjxlct tr, #gktgrjxlct td, #gktgrjxlct th {
  border-style: none;
}

#gktgrjxlct p {
  margin: 0;
  padding: 0;
}

#gktgrjxlct .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gktgrjxlct .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gktgrjxlct .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gktgrjxlct .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gktgrjxlct .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gktgrjxlct .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gktgrjxlct .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gktgrjxlct .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gktgrjxlct .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gktgrjxlct .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gktgrjxlct .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gktgrjxlct .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gktgrjxlct .gt_spanner_row {
  border-bottom-style: hidden;
}

#gktgrjxlct .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gktgrjxlct .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gktgrjxlct .gt_from_md > :first-child {
  margin-top: 0;
}

#gktgrjxlct .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gktgrjxlct .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gktgrjxlct .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgrjxlct .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gktgrjxlct .gt_row_group_first td {
  border-top-width: 2px;
}

#gktgrjxlct .gt_row_group_first th {
  border-top-width: 2px;
}

#gktgrjxlct .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgrjxlct .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gktgrjxlct .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gktgrjxlct .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gktgrjxlct .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgrjxlct .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gktgrjxlct .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gktgrjxlct .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gktgrjxlct .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gktgrjxlct .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gktgrjxlct .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgrjxlct .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gktgrjxlct .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgrjxlct .gt_left {
  text-align: left;
}

#gktgrjxlct .gt_center {
  text-align: center;
}

#gktgrjxlct .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gktgrjxlct .gt_font_normal {
  font-weight: normal;
}

#gktgrjxlct .gt_font_bold {
  font-weight: bold;
}

#gktgrjxlct .gt_font_italic {
  font-style: italic;
}

#gktgrjxlct .gt_super {
  font-size: 65%;
}

#gktgrjxlct .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gktgrjxlct .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gktgrjxlct .gt_indent_1 {
  text-indent: 5px;
}

#gktgrjxlct .gt_indent_2 {
  text-indent: 10px;
}

#gktgrjxlct .gt_indent_3 {
  text-indent: 15px;
}

#gktgrjxlct .gt_indent_4 {
  text-indent: 20px;
}

#gktgrjxlct .gt_indent_5 {
  text-indent: 25px;
}

#gktgrjxlct .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gktgrjxlct div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">20</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">30</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">30</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">70</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">80</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">120</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">120</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    sales_id, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">4</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="kmdnzoqtoz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kmdnzoqtoz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kmdnzoqtoz thead, #kmdnzoqtoz tbody, #kmdnzoqtoz tfoot, #kmdnzoqtoz tr, #kmdnzoqtoz td, #kmdnzoqtoz th {
  border-style: none;
}

#kmdnzoqtoz p {
  margin: 0;
  padding: 0;
}

#kmdnzoqtoz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kmdnzoqtoz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kmdnzoqtoz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kmdnzoqtoz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kmdnzoqtoz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmdnzoqtoz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmdnzoqtoz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmdnzoqtoz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kmdnzoqtoz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kmdnzoqtoz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kmdnzoqtoz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kmdnzoqtoz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kmdnzoqtoz .gt_spanner_row {
  border-bottom-style: hidden;
}

#kmdnzoqtoz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kmdnzoqtoz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kmdnzoqtoz .gt_from_md > :first-child {
  margin-top: 0;
}

#kmdnzoqtoz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kmdnzoqtoz .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kmdnzoqtoz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#kmdnzoqtoz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kmdnzoqtoz .gt_row_group_first td {
  border-top-width: 2px;
}

#kmdnzoqtoz .gt_row_group_first th {
  border-top-width: 2px;
}

#kmdnzoqtoz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmdnzoqtoz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kmdnzoqtoz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kmdnzoqtoz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmdnzoqtoz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmdnzoqtoz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kmdnzoqtoz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kmdnzoqtoz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kmdnzoqtoz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmdnzoqtoz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmdnzoqtoz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmdnzoqtoz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmdnzoqtoz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmdnzoqtoz .gt_left {
  text-align: left;
}

#kmdnzoqtoz .gt_center {
  text-align: center;
}

#kmdnzoqtoz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kmdnzoqtoz .gt_font_normal {
  font-weight: normal;
}

#kmdnzoqtoz .gt_font_bold {
  font-weight: bold;
}

#kmdnzoqtoz .gt_font_italic {
  font-style: italic;
}

#kmdnzoqtoz .gt_super {
  font-size: 65%;
}

#kmdnzoqtoz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kmdnzoqtoz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kmdnzoqtoz .gt_indent_1 {
  text-indent: 5px;
}

#kmdnzoqtoz .gt_indent_2 {
  text-indent: 10px;
}

#kmdnzoqtoz .gt_indent_3 {
  text-indent: 15px;
}

#kmdnzoqtoz .gt_indent_4 {
  text-indent: 20px;
}

#kmdnzoqtoz .gt_indent_5 {
  text-indent: 25px;
}

#kmdnzoqtoz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kmdnzoqtoz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">300</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This divides the result set into 2 buckets based on the Amount. Rows with the highest amounts go into the first bucket, and so on.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="lag" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="lag"><span class="header-section-number">7.2.6</span> LAG</h3>
<p><code>LAG()</code> is a function that allows users to access data from a previous row within the same result set. It is particularly useful for performing comparisons between the current row and its preceding rows.</p>
<section id="basic-syntax" class="level4" data-number="7.2.6.1">
<h4 data-number="7.2.6.1" class="anchored" data-anchor-id="basic-syntax"><span class="header-section-number">7.2.6.1</span> Basic syntax</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LAG</span>(expression [, offset [, default_value]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><p><strong>expression:</strong> This is the column or expression from which you want to retrieve the value from a previous row.</p></li>
<li><p><strong>offset:</strong> This optional parameter specifies how many rows back to look. The default value is 1 if not specified.</p></li>
<li><p><strong>default_value:</strong> This optional parameter defines what value to return if there is no previous row available (e.g., when looking back beyond the first row). If omitted, NULL will be returned.</p></li>
</ul>
</section>
<section id="quick-illustration-3" class="level4" data-number="7.2.6.2">
<h4 data-number="7.2.6.2" class="anchored" data-anchor-id="quick-illustration-3"><span class="header-section-number">7.2.6.2</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-25-1"><a href="#annotated-cell-25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-25-2"><a href="#annotated-cell-25-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>,</span>
<span id="annotated-cell-25-3"><a href="#annotated-cell-25-3" aria-hidden="true" tabindex="-1"></a>      product,</span>
<span id="annotated-cell-25-4"><a href="#annotated-cell-25-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="1">1</button><span id="annotated-cell-25-5" class="code-annotation-target"><a href="#annotated-cell-25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="annotated-cell-25-6"><a href="#annotated-cell-25-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="5" data-code-annotation="1">retrieve the value from the previous row in the amount column.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="iwidgpvbqx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iwidgpvbqx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iwidgpvbqx thead, #iwidgpvbqx tbody, #iwidgpvbqx tfoot, #iwidgpvbqx tr, #iwidgpvbqx td, #iwidgpvbqx th {
  border-style: none;
}

#iwidgpvbqx p {
  margin: 0;
  padding: 0;
}

#iwidgpvbqx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iwidgpvbqx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iwidgpvbqx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iwidgpvbqx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iwidgpvbqx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iwidgpvbqx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwidgpvbqx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iwidgpvbqx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iwidgpvbqx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iwidgpvbqx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iwidgpvbqx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iwidgpvbqx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iwidgpvbqx .gt_spanner_row {
  border-bottom-style: hidden;
}

#iwidgpvbqx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iwidgpvbqx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iwidgpvbqx .gt_from_md > :first-child {
  margin-top: 0;
}

#iwidgpvbqx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iwidgpvbqx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iwidgpvbqx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iwidgpvbqx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iwidgpvbqx .gt_row_group_first td {
  border-top-width: 2px;
}

#iwidgpvbqx .gt_row_group_first th {
  border-top-width: 2px;
}

#iwidgpvbqx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwidgpvbqx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iwidgpvbqx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iwidgpvbqx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwidgpvbqx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwidgpvbqx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iwidgpvbqx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iwidgpvbqx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iwidgpvbqx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwidgpvbqx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iwidgpvbqx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwidgpvbqx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iwidgpvbqx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwidgpvbqx .gt_left {
  text-align: left;
}

#iwidgpvbqx .gt_center {
  text-align: center;
}

#iwidgpvbqx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iwidgpvbqx .gt_font_normal {
  font-weight: normal;
}

#iwidgpvbqx .gt_font_bold {
  font-weight: bold;
}

#iwidgpvbqx .gt_font_italic {
  font-style: italic;
}

#iwidgpvbqx .gt_super {
  font-size: 65%;
}

#iwidgpvbqx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iwidgpvbqx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iwidgpvbqx .gt_indent_1 {
  text-indent: 5px;
}

#iwidgpvbqx .gt_indent_2 {
  text-indent: 10px;
}

#iwidgpvbqx .gt_indent_3 {
  text-indent: 15px;
}

#iwidgpvbqx .gt_indent_4 {
  text-indent: 20px;
}

#iwidgpvbqx .gt_indent_5 {
  text-indent: 25px;
}

#iwidgpvbqx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iwidgpvbqx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">100</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #CD69C9; font-size: 20; font-weight: bolder;">0</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">120</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">100</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">20</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">120</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">80</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">20</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">70</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">80</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center">30</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">70</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong> Get the previous row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="qvqtriowem" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qvqtriowem table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qvqtriowem thead, #qvqtriowem tbody, #qvqtriowem tfoot, #qvqtriowem tr, #qvqtriowem td, #qvqtriowem th {
  border-style: none;
}

#qvqtriowem p {
  margin: 0;
  padding: 0;
}

#qvqtriowem .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qvqtriowem .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qvqtriowem .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qvqtriowem .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qvqtriowem .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qvqtriowem .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvqtriowem .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qvqtriowem .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qvqtriowem .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qvqtriowem .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qvqtriowem .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qvqtriowem .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qvqtriowem .gt_spanner_row {
  border-bottom-style: hidden;
}

#qvqtriowem .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qvqtriowem .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qvqtriowem .gt_from_md > :first-child {
  margin-top: 0;
}

#qvqtriowem .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qvqtriowem .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qvqtriowem .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#qvqtriowem .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qvqtriowem .gt_row_group_first td {
  border-top-width: 2px;
}

#qvqtriowem .gt_row_group_first th {
  border-top-width: 2px;
}

#qvqtriowem .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvqtriowem .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qvqtriowem .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qvqtriowem .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvqtriowem .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvqtriowem .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qvqtriowem .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qvqtriowem .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qvqtriowem .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvqtriowem .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qvqtriowem .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvqtriowem .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qvqtriowem .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvqtriowem .gt_left {
  text-align: left;
}

#qvqtriowem .gt_center {
  text-align: center;
}

#qvqtriowem .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qvqtriowem .gt_font_normal {
  font-weight: normal;
}

#qvqtriowem .gt_font_bold {
  font-weight: bold;
}

#qvqtriowem .gt_font_italic {
  font-style: italic;
}

#qvqtriowem .gt_super {
  font-size: 65%;
}

#qvqtriowem .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qvqtriowem .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qvqtriowem .gt_indent_1 {
  text-indent: 5px;
}

#qvqtriowem .gt_indent_2 {
  text-indent: 10px;
}

#qvqtriowem .gt_indent_3 {
  text-indent: 15px;
}

#qvqtriowem .gt_indent_4 {
  text-indent: 20px;
}

#qvqtriowem .gt_indent_5 {
  text-indent: 25px;
}

#qvqtriowem .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qvqtriowem div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="partition-by-store_id" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="zkeytkagoz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zkeytkagoz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zkeytkagoz thead, #zkeytkagoz tbody, #zkeytkagoz tfoot, #zkeytkagoz tr, #zkeytkagoz td, #zkeytkagoz th {
  border-style: none;
}

#zkeytkagoz p {
  margin: 0;
  padding: 0;
}

#zkeytkagoz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zkeytkagoz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zkeytkagoz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zkeytkagoz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zkeytkagoz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zkeytkagoz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zkeytkagoz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zkeytkagoz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zkeytkagoz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zkeytkagoz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zkeytkagoz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zkeytkagoz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zkeytkagoz .gt_spanner_row {
  border-bottom-style: hidden;
}

#zkeytkagoz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zkeytkagoz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zkeytkagoz .gt_from_md > :first-child {
  margin-top: 0;
}

#zkeytkagoz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zkeytkagoz .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zkeytkagoz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#zkeytkagoz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zkeytkagoz .gt_row_group_first td {
  border-top-width: 2px;
}

#zkeytkagoz .gt_row_group_first th {
  border-top-width: 2px;
}

#zkeytkagoz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zkeytkagoz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zkeytkagoz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zkeytkagoz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zkeytkagoz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zkeytkagoz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zkeytkagoz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zkeytkagoz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zkeytkagoz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zkeytkagoz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zkeytkagoz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zkeytkagoz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zkeytkagoz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zkeytkagoz .gt_left {
  text-align: left;
}

#zkeytkagoz .gt_center {
  text-align: center;
}

#zkeytkagoz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zkeytkagoz .gt_font_normal {
  font-weight: normal;
}

#zkeytkagoz .gt_font_bold {
  font-weight: bold;
}

#zkeytkagoz .gt_font_italic {
  font-style: italic;
}

#zkeytkagoz .gt_super {
  font-size: 65%;
}

#zkeytkagoz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zkeytkagoz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zkeytkagoz .gt_indent_1 {
  text-indent: 5px;
}

#zkeytkagoz .gt_indent_2 {
  text-indent: 10px;
}

#zkeytkagoz .gt_indent_3 {
  text-indent: 15px;
}

#zkeytkagoz .gt_indent_4 {
  text-indent: 20px;
}

#zkeytkagoz .gt_indent_5 {
  text-indent: 25px;
}

#zkeytkagoz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zkeytkagoz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="lead" class="level3" data-number="7.2.7">
<h3 data-number="7.2.7" class="anchored" data-anchor-id="lead"><span class="header-section-number">7.2.7</span> LEAD</h3>
<p>The <code>LEAD()</code> function allows users to access data from subsequent rows in a result set. It is particularly useful for comparing values between the current row and one or more following rows.</p>
<section id="basic-syntax-1" class="level4" data-number="7.2.7.1">
<h4 data-number="7.2.7.1" class="anchored" data-anchor-id="basic-syntax-1"><span class="header-section-number">7.2.7.1</span> Basic syntax</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LEAD</span>(expression [, offset [, default_value]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><p><strong>expression:</strong> This is the column or expression whose value you want to retrieve from the following row.</p></li>
<li><p><strong>offset:</strong> This optional parameter specifies how many rows forward from the current row you want to look. If not specified, it defaults to 1.</p></li>
<li><p><strong>default_value:</strong> This optional parameter defines what value should be returned if there is no following row available (e.g., at the end of a dataset). By default, this is NULL.</p></li>
</ul>
</section>
<section id="quick-illustration-4" class="level4" data-number="7.2.7.2">
<h4 data-number="7.2.7.2" class="anchored" data-anchor-id="quick-illustration-4"><span class="header-section-number">7.2.7.2</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-29"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-29-1"><a href="#annotated-cell-29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-29-2"><a href="#annotated-cell-29-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>,</span>
<span id="annotated-cell-29-3"><a href="#annotated-cell-29-3" aria-hidden="true" tabindex="-1"></a>      product,</span>
<span id="annotated-cell-29-4"><a href="#annotated-cell-29-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="1">1</button><span id="annotated-cell-29-5" class="code-annotation-target"><a href="#annotated-cell-29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount) <span class="kw">AS</span> next_amount</span>
<span id="annotated-cell-29-6"><a href="#annotated-cell-29-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="5" data-code-annotation="1">retrieve the value from the next row in the amount column.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="pmqnpaymda" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pmqnpaymda table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pmqnpaymda thead, #pmqnpaymda tbody, #pmqnpaymda tfoot, #pmqnpaymda tr, #pmqnpaymda td, #pmqnpaymda th {
  border-style: none;
}

#pmqnpaymda p {
  margin: 0;
  padding: 0;
}

#pmqnpaymda .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pmqnpaymda .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pmqnpaymda .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pmqnpaymda .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pmqnpaymda .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pmqnpaymda .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pmqnpaymda .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pmqnpaymda .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pmqnpaymda .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pmqnpaymda .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pmqnpaymda .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pmqnpaymda .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pmqnpaymda .gt_spanner_row {
  border-bottom-style: hidden;
}

#pmqnpaymda .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pmqnpaymda .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pmqnpaymda .gt_from_md > :first-child {
  margin-top: 0;
}

#pmqnpaymda .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pmqnpaymda .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pmqnpaymda .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pmqnpaymda .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pmqnpaymda .gt_row_group_first td {
  border-top-width: 2px;
}

#pmqnpaymda .gt_row_group_first th {
  border-top-width: 2px;
}

#pmqnpaymda .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmqnpaymda .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pmqnpaymda .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pmqnpaymda .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pmqnpaymda .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmqnpaymda .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pmqnpaymda .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pmqnpaymda .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pmqnpaymda .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pmqnpaymda .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pmqnpaymda .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmqnpaymda .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pmqnpaymda .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmqnpaymda .gt_left {
  text-align: left;
}

#pmqnpaymda .gt_center {
  text-align: center;
}

#pmqnpaymda .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pmqnpaymda .gt_font_normal {
  font-weight: normal;
}

#pmqnpaymda .gt_font_bold {
  font-weight: bold;
}

#pmqnpaymda .gt_font_italic {
  font-style: italic;
}

#pmqnpaymda .gt_super {
  font-size: 65%;
}

#pmqnpaymda .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pmqnpaymda .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pmqnpaymda .gt_indent_1 {
  text-indent: 5px;
}

#pmqnpaymda .gt_indent_2 {
  text-indent: 10px;
}

#pmqnpaymda .gt_indent_3 {
  text-indent: 15px;
}

#pmqnpaymda .gt_indent_4 {
  text-indent: 20px;
}

#pmqnpaymda .gt_indent_5 {
  text-indent: 25px;
}

#pmqnpaymda .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pmqnpaymda div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="next_amount">next_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center">100</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">120</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">120</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">20</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">20</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">80</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">80</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">70</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">70</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">30</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">30</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #CD69C9; font-size: 20; font-weight: bolder;">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong> Get the next row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="cbxycyvgku" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cbxycyvgku table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cbxycyvgku thead, #cbxycyvgku tbody, #cbxycyvgku tfoot, #cbxycyvgku tr, #cbxycyvgku td, #cbxycyvgku th {
  border-style: none;
}

#cbxycyvgku p {
  margin: 0;
  padding: 0;
}

#cbxycyvgku .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cbxycyvgku .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cbxycyvgku .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cbxycyvgku .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cbxycyvgku .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cbxycyvgku .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbxycyvgku .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cbxycyvgku .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cbxycyvgku .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cbxycyvgku .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cbxycyvgku .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cbxycyvgku .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cbxycyvgku .gt_spanner_row {
  border-bottom-style: hidden;
}

#cbxycyvgku .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cbxycyvgku .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cbxycyvgku .gt_from_md > :first-child {
  margin-top: 0;
}

#cbxycyvgku .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cbxycyvgku .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cbxycyvgku .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#cbxycyvgku .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cbxycyvgku .gt_row_group_first td {
  border-top-width: 2px;
}

#cbxycyvgku .gt_row_group_first th {
  border-top-width: 2px;
}

#cbxycyvgku .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbxycyvgku .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cbxycyvgku .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cbxycyvgku .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbxycyvgku .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbxycyvgku .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cbxycyvgku .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cbxycyvgku .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cbxycyvgku .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cbxycyvgku .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cbxycyvgku .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbxycyvgku .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cbxycyvgku .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cbxycyvgku .gt_left {
  text-align: left;
}

#cbxycyvgku .gt_center {
  text-align: center;
}

#cbxycyvgku .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cbxycyvgku .gt_font_normal {
  font-weight: normal;
}

#cbxycyvgku .gt_font_bold {
  font-weight: bold;
}

#cbxycyvgku .gt_font_italic {
  font-style: italic;
}

#cbxycyvgku .gt_super {
  font-size: 65%;
}

#cbxycyvgku .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cbxycyvgku .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cbxycyvgku .gt_indent_1 {
  text-indent: 5px;
}

#cbxycyvgku .gt_indent_2 {
  text-indent: 10px;
}

#cbxycyvgku .gt_indent_3 {
  text-indent: 15px;
}

#cbxycyvgku .gt_indent_4 {
  text-indent: 20px;
}

#cbxycyvgku .gt_indent_5 {
  text-indent: 25px;
}

#cbxycyvgku .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cbxycyvgku div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="partition-by-store_id-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id-1">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ccdlqwivum" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ccdlqwivum table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ccdlqwivum thead, #ccdlqwivum tbody, #ccdlqwivum tfoot, #ccdlqwivum tr, #ccdlqwivum td, #ccdlqwivum th {
  border-style: none;
}

#ccdlqwivum p {
  margin: 0;
  padding: 0;
}

#ccdlqwivum .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ccdlqwivum .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ccdlqwivum .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ccdlqwivum .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ccdlqwivum .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ccdlqwivum .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ccdlqwivum .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ccdlqwivum .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ccdlqwivum .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ccdlqwivum .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ccdlqwivum .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ccdlqwivum .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ccdlqwivum .gt_spanner_row {
  border-bottom-style: hidden;
}

#ccdlqwivum .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ccdlqwivum .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ccdlqwivum .gt_from_md > :first-child {
  margin-top: 0;
}

#ccdlqwivum .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ccdlqwivum .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ccdlqwivum .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#ccdlqwivum .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ccdlqwivum .gt_row_group_first td {
  border-top-width: 2px;
}

#ccdlqwivum .gt_row_group_first th {
  border-top-width: 2px;
}

#ccdlqwivum .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ccdlqwivum .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ccdlqwivum .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ccdlqwivum .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ccdlqwivum .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ccdlqwivum .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ccdlqwivum .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ccdlqwivum .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ccdlqwivum .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ccdlqwivum .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ccdlqwivum .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ccdlqwivum .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ccdlqwivum .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ccdlqwivum .gt_left {
  text-align: left;
}

#ccdlqwivum .gt_center {
  text-align: center;
}

#ccdlqwivum .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ccdlqwivum .gt_font_normal {
  font-weight: normal;
}

#ccdlqwivum .gt_font_bold {
  font-weight: bold;
}

#ccdlqwivum .gt_font_italic {
  font-style: italic;
}

#ccdlqwivum .gt_super {
  font-size: 65%;
}

#ccdlqwivum .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ccdlqwivum .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ccdlqwivum .gt_indent_1 {
  text-indent: 5px;
}

#ccdlqwivum .gt_indent_2 {
  text-indent: 10px;
}

#ccdlqwivum .gt_indent_3 {
  text-indent: 15px;
}

#ccdlqwivum .gt_indent_4 {
  text-indent: 20px;
}

#ccdlqwivum .gt_indent_5 {
  text-indent: 25px;
}

#ccdlqwivum .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ccdlqwivum div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="combining-multiple-window-functions" class="level3" data-number="7.2.8">
<h3 data-number="7.2.8" class="anchored" data-anchor-id="combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</h3>
<p>You can combine multiple window functions in a single query.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> row_num,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> total_amount,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>This query assigns a row number, calculates the total amount per store, and retrieves the previous amount for each sale.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>FRAME</code> Clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AVG</span>(sale) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2 <span class="kw">ORDER</span> <span class="kw">BY</span> col_name3 <span class="kw">ROWS</span> <span class="kw">BETWEEN</span> <span class="kw">CURRENT</span> <span class="kw">ROW</span> <span class="kw">AND</span> <span class="kw">UNBOUNDED</span> <span class="kw">PRECEDING</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><strong>ROWS:</strong> The frame type. values such as ROWS or RANGE</li>
<li><strong>CURRENT ROW:</strong> The frame boundary (Lower value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING</li>
<li><strong>UNBOUNDED PRECEDING:</strong> The frame Boundary (Higher value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING.</li>
</ul>
<p><br></p>
<p><strong>Rules:</strong> - You can only use the Frame clause with Order by clause.</p>
<ul>
<li>The lower value should be placed before the higher value.</li>
</ul>
</div>
</div>
</div>
<p><br> <br> <br></p>
<!------- Window Function -------------------------------------------------->
</section>
</section>
<section id="task" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="task"><span class="header-section-number">7.3</span> Task</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./sql_data_cleaning.html" class="pagination-link" aria-label="Data Cleaning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sql_join.html" class="pagination-link" aria-label="Joins">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>