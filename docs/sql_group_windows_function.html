<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Grouping Data – Data Analysis Tools</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sql_join.html" rel="next">
<link href="./sql_data_cleaning.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Analysis Tools</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sql_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_creating_database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Creating Database</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_statement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Query Statement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_text_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with Text</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_date_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with Date</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_group_windows_function.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_join.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_sub_queries_cte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subquery &amp; CTE</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Project</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_operators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_exploratory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">EDA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./python_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./powerbi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power BI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./powerbi_data_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool_source.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Data Tool Referenece</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#group-by" id="toc-group-by" class="nav-link active" data-scroll-target="#group-by"><span class="header-section-number">7.1</span> GROUP BY</a>
  <ul class="collapse">
  <li><a href="#quick-illustration-of-group-by" id="toc-quick-illustration-of-group-by" class="nav-link" data-scroll-target="#quick-illustration-of-group-by">Quick illustration of GROUP BY:</a></li>
  <li><a href="#simple-group-by-with-count" id="toc-simple-group-by-with-count" class="nav-link" data-scroll-target="#simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></a></li>
  <li><a href="#group-by-with-multiple-columns" id="toc-group-by-with-multiple-columns" class="nav-link" data-scroll-target="#group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</a></li>
  <li><a href="#using-aggregate-functions" id="toc-using-aggregate-functions" class="nav-link" data-scroll-target="#using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</a></li>
  <li><a href="#having-clause-with-group-by" id="toc-having-clause-with-group-by" class="nav-link" data-scroll-target="#having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</a></li>
  <li><a href="#group-by-with-date" id="toc-group-by-with-date" class="nav-link" data-scroll-target="#group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></a></li>
  <li><a href="#group-by-with-expressions" id="toc-group-by-with-expressions" class="nav-link" data-scroll-target="#group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</a></li>
  <li><a href="#group-by-with-order-by" id="toc-group-by-with-order-by" class="nav-link" data-scroll-target="#group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></a></li>
  <li><a href="#grouping-with-a-conditional-aggregate" id="toc-grouping-with-a-conditional-aggregate" class="nav-link" data-scroll-target="#grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</a></li>
  </ul></li>
  <li><a href="#window-function" id="toc-window-function" class="nav-link" data-scroll-target="#window-function"><span class="header-section-number">7.2</span> Window Function</a>
  <ul class="collapse">
  <li><a href="#row_number" id="toc-row_number" class="nav-link" data-scroll-target="#row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</a></li>
  <li><a href="#quick-illustration-of-window-function" id="toc-quick-illustration-of-window-function" class="nav-link" data-scroll-target="#quick-illustration-of-window-function">Quick illustration of window function</a></li>
  <li><a href="#aggregate-function-sum-as-a-window-function" id="toc-aggregate-function-sum-as-a-window-function" class="nav-link" data-scroll-target="#aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</a></li>
  <li><a href="#rank" id="toc-rank" class="nav-link" data-scroll-target="#rank"><span class="header-section-number">7.2.3</span> RANK</a></li>
  <li><a href="#dense_rank" id="toc-dense_rank" class="nav-link" data-scroll-target="#dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</a></li>
  <li><a href="#ntile" id="toc-ntile" class="nav-link" data-scroll-target="#ntile"><span class="header-section-number">7.2.5</span> NTILE</a></li>
  <li><a href="#lag" id="toc-lag" class="nav-link" data-scroll-target="#lag"><span class="header-section-number">7.2.6</span> LAG</a></li>
  <li><a href="#lead" id="toc-lead" class="nav-link" data-scroll-target="#lead"><span class="header-section-number">7.2.7</span> LEAD</a></li>
  <li><a href="#combining-multiple-window-functions" id="toc-combining-multiple-window-functions" class="nav-link" data-scroll-target="#combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</a></li>
  </ul></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task"><span class="header-section-number">7.3</span> Task</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="group-by" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="group-by"><span class="header-section-number">7.1</span> GROUP BY</h2>
<p>The <code>GROUP BY</code> clause is used to arrange identical data into groups. It is often used with aggregate functions such as <code>COUNT()</code>, <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code>, and <code>MIN()</code> to perform operations on each group of data.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Basic Syntax</span></span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name1, aggregate_function(column_column2)</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-5" class="code-annotation-target"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> column_name1;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3" data-code-annotation="1">aggregate_function like <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code> etc.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="5" data-code-annotation="2">The name of the column to group the table by.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts of the <code>GROUP BY</code> clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>The <code>GROUP BY</code> clause groups rows that have the same values in specified columns into summary rows.</p></li>
<li><p>Functions such as <code>COUNT</code>, <code>SUM</code>, <code>AVG</code>, <code>MAX</code>, and <code>MIN</code> are commonly used with <code>GROUP BY</code> <strong>to perform calculations on each group</strong>.</p></li>
<li><p>The <code>HAVING</code> clause is used to filter groups based on conditions, similar to how <code>WHERE</code> filters rows.</p></li>
</ul>
</div>
</div>
</div>
<section id="example-table-sales" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-table-sales">Example Table: Sales</h4>
<div class="cell">
<div class="cell-output-display">
<div id="rukdocdmne" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rukdocdmne table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rukdocdmne thead, #rukdocdmne tbody, #rukdocdmne tfoot, #rukdocdmne tr, #rukdocdmne td, #rukdocdmne th {
  border-style: none;
}

#rukdocdmne p {
  margin: 0;
  padding: 0;
}

#rukdocdmne .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rukdocdmne .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rukdocdmne .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rukdocdmne .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rukdocdmne .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rukdocdmne .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rukdocdmne .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rukdocdmne .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rukdocdmne .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rukdocdmne .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rukdocdmne .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rukdocdmne .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rukdocdmne .gt_spanner_row {
  border-bottom-style: hidden;
}

#rukdocdmne .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rukdocdmne .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rukdocdmne .gt_from_md > :first-child {
  margin-top: 0;
}

#rukdocdmne .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rukdocdmne .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rukdocdmne .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#rukdocdmne .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rukdocdmne .gt_row_group_first td {
  border-top-width: 2px;
}

#rukdocdmne .gt_row_group_first th {
  border-top-width: 2px;
}

#rukdocdmne .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rukdocdmne .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rukdocdmne .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rukdocdmne .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rukdocdmne .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rukdocdmne .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rukdocdmne .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rukdocdmne .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rukdocdmne .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rukdocdmne .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rukdocdmne .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rukdocdmne .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rukdocdmne .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rukdocdmne .gt_left {
  text-align: left;
}

#rukdocdmne .gt_center {
  text-align: center;
}

#rukdocdmne .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rukdocdmne .gt_font_normal {
  font-weight: normal;
}

#rukdocdmne .gt_font_bold {
  font-weight: bold;
}

#rukdocdmne .gt_font_italic {
  font-style: italic;
}

#rukdocdmne .gt_super {
  font-size: 65%;
}

#rukdocdmne .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rukdocdmne .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rukdocdmne .gt_indent_1 {
  text-indent: 5px;
}

#rukdocdmne .gt_indent_2 {
  text-indent: 10px;
}

#rukdocdmne .gt_indent_3 {
  text-indent: 15px;
}

#rukdocdmne .gt_indent_4 {
  text-indent: 20px;
}

#rukdocdmne .gt_indent_5 {
  text-indent: 25px;
}

#rukdocdmne .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#rukdocdmne div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="quick-illustration-of-group-by" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-group-by">Quick illustration of GROUP BY:</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To get the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-2" class="code-annotation-target"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="zzqojltwvz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zzqojltwvz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zzqojltwvz thead, #zzqojltwvz tbody, #zzqojltwvz tfoot, #zzqojltwvz tr, #zzqojltwvz td, #zzqojltwvz th {
  border-style: none;
}

#zzqojltwvz p {
  margin: 0;
  padding: 0;
}

#zzqojltwvz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zzqojltwvz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zzqojltwvz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zzqojltwvz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zzqojltwvz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zzqojltwvz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zzqojltwvz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zzqojltwvz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zzqojltwvz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zzqojltwvz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zzqojltwvz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zzqojltwvz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zzqojltwvz .gt_spanner_row {
  border-bottom-style: hidden;
}

#zzqojltwvz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zzqojltwvz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zzqojltwvz .gt_from_md > :first-child {
  margin-top: 0;
}

#zzqojltwvz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zzqojltwvz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zzqojltwvz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zzqojltwvz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zzqojltwvz .gt_row_group_first td {
  border-top-width: 2px;
}

#zzqojltwvz .gt_row_group_first th {
  border-top-width: 2px;
}

#zzqojltwvz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zzqojltwvz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zzqojltwvz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zzqojltwvz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zzqojltwvz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zzqojltwvz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zzqojltwvz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zzqojltwvz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zzqojltwvz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zzqojltwvz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zzqojltwvz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zzqojltwvz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zzqojltwvz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zzqojltwvz .gt_left {
  text-align: left;
}

#zzqojltwvz .gt_center {
  text-align: center;
}

#zzqojltwvz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zzqojltwvz .gt_font_normal {
  font-weight: normal;
}

#zzqojltwvz .gt_font_bold {
  font-weight: bold;
}

#zzqojltwvz .gt_font_italic {
  font-style: italic;
}

#zzqojltwvz .gt_super {
  font-size: 65%;
}

#zzqojltwvz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zzqojltwvz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zzqojltwvz .gt_indent_1 {
  text-indent: 5px;
}

#zzqojltwvz .gt_indent_2 {
  text-indent: 10px;
}

#zzqojltwvz .gt_indent_3 {
  text-indent: 15px;
}

#zzqojltwvz .gt_indent_4 {
  text-indent: 20px;
}

#zzqojltwvz .gt_indent_5 {
  text-indent: 25px;
}

#zzqojltwvz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zzqojltwvz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Full Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="yzwuffuckg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yzwuffuckg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yzwuffuckg thead, #yzwuffuckg tbody, #yzwuffuckg tfoot, #yzwuffuckg tr, #yzwuffuckg td, #yzwuffuckg th {
  border-style: none;
}

#yzwuffuckg p {
  margin: 0;
  padding: 0;
}

#yzwuffuckg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yzwuffuckg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yzwuffuckg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yzwuffuckg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yzwuffuckg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzwuffuckg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzwuffuckg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzwuffuckg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yzwuffuckg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yzwuffuckg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yzwuffuckg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yzwuffuckg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yzwuffuckg .gt_spanner_row {
  border-bottom-style: hidden;
}

#yzwuffuckg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yzwuffuckg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yzwuffuckg .gt_from_md > :first-child {
  margin-top: 0;
}

#yzwuffuckg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yzwuffuckg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yzwuffuckg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yzwuffuckg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yzwuffuckg .gt_row_group_first td {
  border-top-width: 2px;
}

#yzwuffuckg .gt_row_group_first th {
  border-top-width: 2px;
}

#yzwuffuckg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzwuffuckg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yzwuffuckg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yzwuffuckg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzwuffuckg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzwuffuckg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yzwuffuckg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yzwuffuckg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yzwuffuckg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzwuffuckg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzwuffuckg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzwuffuckg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzwuffuckg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzwuffuckg .gt_left {
  text-align: left;
}

#yzwuffuckg .gt_center {
  text-align: center;
}

#yzwuffuckg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yzwuffuckg .gt_font_normal {
  font-weight: normal;
}

#yzwuffuckg .gt_font_bold {
  font-weight: bold;
}

#yzwuffuckg .gt_font_italic {
  font-style: italic;
}

#yzwuffuckg .gt_super {
  font-size: 65%;
}

#yzwuffuckg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yzwuffuckg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yzwuffuckg .gt_indent_1 {
  text-indent: 5px;
}

#yzwuffuckg .gt_indent_2 {
  text-indent: 10px;
}

#yzwuffuckg .gt_indent_3 {
  text-indent: 15px;
}

#yzwuffuckg .gt_indent_4 {
  text-indent: 20px;
}

#yzwuffuckg .gt_indent_5 {
  text-indent: 25px;
}

#yzwuffuckg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yzwuffuckg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Grouped Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="simple-group-by-with-count" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To count the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-2" class="code-annotation-target"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="dyozyncrlb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dyozyncrlb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dyozyncrlb thead, #dyozyncrlb tbody, #dyozyncrlb tfoot, #dyozyncrlb tr, #dyozyncrlb td, #dyozyncrlb th {
  border-style: none;
}

#dyozyncrlb p {
  margin: 0;
  padding: 0;
}

#dyozyncrlb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dyozyncrlb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dyozyncrlb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dyozyncrlb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dyozyncrlb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dyozyncrlb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dyozyncrlb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dyozyncrlb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dyozyncrlb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dyozyncrlb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dyozyncrlb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dyozyncrlb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dyozyncrlb .gt_spanner_row {
  border-bottom-style: hidden;
}

#dyozyncrlb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dyozyncrlb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dyozyncrlb .gt_from_md > :first-child {
  margin-top: 0;
}

#dyozyncrlb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dyozyncrlb .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dyozyncrlb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#dyozyncrlb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dyozyncrlb .gt_row_group_first td {
  border-top-width: 2px;
}

#dyozyncrlb .gt_row_group_first th {
  border-top-width: 2px;
}

#dyozyncrlb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dyozyncrlb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dyozyncrlb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dyozyncrlb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dyozyncrlb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dyozyncrlb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dyozyncrlb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dyozyncrlb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dyozyncrlb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dyozyncrlb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dyozyncrlb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dyozyncrlb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dyozyncrlb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dyozyncrlb .gt_left {
  text-align: left;
}

#dyozyncrlb .gt_center {
  text-align: center;
}

#dyozyncrlb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dyozyncrlb .gt_font_normal {
  font-weight: normal;
}

#dyozyncrlb .gt_font_bold {
  font-weight: bold;
}

#dyozyncrlb .gt_font_italic {
  font-style: italic;
}

#dyozyncrlb .gt_super {
  font-size: 65%;
}

#dyozyncrlb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dyozyncrlb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dyozyncrlb .gt_indent_1 {
  text-indent: 5px;
}

#dyozyncrlb .gt_indent_2 {
  text-indent: 10px;
}

#dyozyncrlb .gt_indent_3 {
  text-indent: 15px;
}

#dyozyncrlb .gt_indent_4 {
  text-indent: 20px;
}

#dyozyncrlb .gt_indent_5 {
  text-indent: 25px;
}

#dyozyncrlb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dyozyncrlb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_number_of_sales" class="gt_row gt_center">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_number_of_sales" class="gt_row gt_center">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="group-by-with-multiple-columns" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</h3>
<p>Grouping by multiple columns can give more <em>granular summaries</em>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- count the number of sales per store and product:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, product_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id, product_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store and product id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="purowexqkq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#purowexqkq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#purowexqkq thead, #purowexqkq tbody, #purowexqkq tfoot, #purowexqkq tr, #purowexqkq td, #purowexqkq th {
  border-style: none;
}

#purowexqkq p {
  margin: 0;
  padding: 0;
}

#purowexqkq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#purowexqkq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#purowexqkq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#purowexqkq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#purowexqkq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#purowexqkq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#purowexqkq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#purowexqkq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#purowexqkq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#purowexqkq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#purowexqkq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#purowexqkq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#purowexqkq .gt_spanner_row {
  border-bottom-style: hidden;
}

#purowexqkq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#purowexqkq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#purowexqkq .gt_from_md > :first-child {
  margin-top: 0;
}

#purowexqkq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#purowexqkq .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#purowexqkq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#purowexqkq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#purowexqkq .gt_row_group_first td {
  border-top-width: 2px;
}

#purowexqkq .gt_row_group_first th {
  border-top-width: 2px;
}

#purowexqkq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#purowexqkq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#purowexqkq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#purowexqkq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#purowexqkq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#purowexqkq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#purowexqkq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#purowexqkq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#purowexqkq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#purowexqkq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#purowexqkq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#purowexqkq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#purowexqkq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#purowexqkq .gt_left {
  text-align: left;
}

#purowexqkq .gt_center {
  text-align: center;
}

#purowexqkq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#purowexqkq .gt_font_normal {
  font-weight: normal;
}

#purowexqkq .gt_font_bold {
  font-weight: bold;
}

#purowexqkq .gt_font_italic {
  font-style: italic;
}

#purowexqkq .gt_super {
  font-size: 65%;
}

#purowexqkq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#purowexqkq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#purowexqkq .gt_indent_1 {
  text-indent: 5px;
}

#purowexqkq .gt_indent_2 {
  text-indent: 10px;
}

#purowexqkq .gt_indent_3 {
  text-indent: 15px;
}

#purowexqkq .gt_indent_4 {
  text-indent: 20px;
}

#purowexqkq .gt_indent_5 {
  text-indent: 25px;
}

#purowexqkq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#purowexqkq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="using-aggregate-functions" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Calculate the average amount of sales per store:</span></span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, </span>
<span id="annotated-cell-5-3"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(amount) <span class="kw">AS</span> <span class="fu">count</span>,</span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MIN</span>(amount) <span class="kw">AS</span>, lowest_amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1">1</button><span id="annotated-cell-5-5" class="code-annotation-target"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(amount) <span class="kw">AS</span> average_amount,</span>
<span id="annotated-cell-5-6"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MAX</span>(amount) <span class="kw">AS</span> highest_amount,</span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_anount</span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2">2</button><span id="annotated-cell-5-9" class="code-annotation-target"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="5" data-code-annotation="1">Get the average of all the amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="9" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="qvxdtttcbt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qvxdtttcbt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qvxdtttcbt thead, #qvxdtttcbt tbody, #qvxdtttcbt tfoot, #qvxdtttcbt tr, #qvxdtttcbt td, #qvxdtttcbt th {
  border-style: none;
}

#qvxdtttcbt p {
  margin: 0;
  padding: 0;
}

#qvxdtttcbt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qvxdtttcbt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qvxdtttcbt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qvxdtttcbt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qvxdtttcbt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qvxdtttcbt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvxdtttcbt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qvxdtttcbt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qvxdtttcbt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qvxdtttcbt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qvxdtttcbt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qvxdtttcbt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qvxdtttcbt .gt_spanner_row {
  border-bottom-style: hidden;
}

#qvxdtttcbt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qvxdtttcbt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qvxdtttcbt .gt_from_md > :first-child {
  margin-top: 0;
}

#qvxdtttcbt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qvxdtttcbt .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qvxdtttcbt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#qvxdtttcbt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qvxdtttcbt .gt_row_group_first td {
  border-top-width: 2px;
}

#qvxdtttcbt .gt_row_group_first th {
  border-top-width: 2px;
}

#qvxdtttcbt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvxdtttcbt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qvxdtttcbt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qvxdtttcbt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvxdtttcbt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvxdtttcbt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qvxdtttcbt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qvxdtttcbt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qvxdtttcbt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qvxdtttcbt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qvxdtttcbt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvxdtttcbt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qvxdtttcbt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qvxdtttcbt .gt_left {
  text-align: left;
}

#qvxdtttcbt .gt_center {
  text-align: center;
}

#qvxdtttcbt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qvxdtttcbt .gt_font_normal {
  font-weight: normal;
}

#qvxdtttcbt .gt_font_bold {
  font-weight: bold;
}

#qvxdtttcbt .gt_font_italic {
  font-style: italic;
}

#qvxdtttcbt .gt_super {
  font-size: 65%;
}

#qvxdtttcbt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qvxdtttcbt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qvxdtttcbt .gt_indent_1 {
  text-indent: 5px;
}

#qvxdtttcbt .gt_indent_2 {
  text-indent: 10px;
}

#qvxdtttcbt .gt_indent_3 {
  text-indent: 15px;
}

#qvxdtttcbt .gt_indent_4 {
  text-indent: 20px;
}

#qvxdtttcbt .gt_indent_5 {
  text-indent: 25px;
}

#qvxdtttcbt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qvxdtttcbt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="count">count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lowest_amount">lowest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="average_amount">average_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="highest_amount">highest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="count" class="gt_row gt_right">4</td>
<td headers="lowest_amount" class="gt_row gt_right">100</td>
<td headers="average_amount" class="gt_row gt_right">225</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="count" class="gt_row gt_right">3</td>
<td headers="lowest_amount" class="gt_row gt_right">200</td>
<td headers="average_amount" class="gt_row gt_right">200</td>
<td headers="highest_amount" class="gt_row gt_right">200</td>
<td headers="total_amount" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="count" class="gt_row gt_right">5</td>
<td headers="lowest_amount" class="gt_row gt_right">150</td>
<td headers="average_amount" class="gt_row gt_right">250</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="having-clause-with-group-by" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</h3>
<p>The <code>HAVING</code> clause is used to filter groups <strong>after the aggregation</strong>.</p>
<section id="quick-illustration-of-using-having" class="level4" data-number="7.1.4.1">
<h4 data-number="7.1.4.1" class="anchored" data-anchor-id="quick-illustration-of-using-having"><span class="header-section-number">7.1.4.1</span> Quick Illustration of using HAVING</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-3" class="code-annotation-target"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span>
<span id="annotated-cell-6-4"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-6-7"><a href="#annotated-cell-6-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2">2</button><span id="annotated-cell-6-8" class="code-annotation-target"><a href="#annotated-cell-6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">600</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="3" data-code-annotation="1">Group the table using the <code>store_id</code></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="8" data-code-annotation="2">Filter only stores with <code>total_amount</code> greater than 600</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="auoejflmam" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#auoejflmam table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#auoejflmam thead, #auoejflmam tbody, #auoejflmam tfoot, #auoejflmam tr, #auoejflmam td, #auoejflmam th {
  border-style: none;
}

#auoejflmam p {
  margin: 0;
  padding: 0;
}

#auoejflmam .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#auoejflmam .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#auoejflmam .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#auoejflmam .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#auoejflmam .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#auoejflmam .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#auoejflmam .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#auoejflmam .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#auoejflmam .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#auoejflmam .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#auoejflmam .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#auoejflmam .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#auoejflmam .gt_spanner_row {
  border-bottom-style: hidden;
}

#auoejflmam .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#auoejflmam .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#auoejflmam .gt_from_md > :first-child {
  margin-top: 0;
}

#auoejflmam .gt_from_md > :last-child {
  margin-bottom: 0;
}

#auoejflmam .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#auoejflmam .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#auoejflmam .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#auoejflmam .gt_row_group_first td {
  border-top-width: 2px;
}

#auoejflmam .gt_row_group_first th {
  border-top-width: 2px;
}

#auoejflmam .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#auoejflmam .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#auoejflmam .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#auoejflmam .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#auoejflmam .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#auoejflmam .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#auoejflmam .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#auoejflmam .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#auoejflmam .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#auoejflmam .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#auoejflmam .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#auoejflmam .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#auoejflmam .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#auoejflmam .gt_left {
  text-align: left;
}

#auoejflmam .gt_center {
  text-align: center;
}

#auoejflmam .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#auoejflmam .gt_font_normal {
  font-weight: normal;
}

#auoejflmam .gt_font_bold {
  font-weight: bold;
}

#auoejflmam .gt_font_italic {
  font-style: italic;
}

#auoejflmam .gt_super {
  font-size: 65%;
}

#auoejflmam .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#auoejflmam .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#auoejflmam .gt_indent_1 {
  text-indent: 5px;
}

#auoejflmam .gt_indent_2 {
  text-indent: 10px;
}

#auoejflmam .gt_indent_3 {
  text-indent: 15px;
}

#auoejflmam .gt_indent_4 {
  text-indent: 20px;
}

#auoejflmam .gt_indent_5 {
  text-indent: 25px;
}

#auoejflmam .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#auoejflmam div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Grouped Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="dpvnxrccpq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dpvnxrccpq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dpvnxrccpq thead, #dpvnxrccpq tbody, #dpvnxrccpq tfoot, #dpvnxrccpq tr, #dpvnxrccpq td, #dpvnxrccpq th {
  border-style: none;
}

#dpvnxrccpq p {
  margin: 0;
  padding: 0;
}

#dpvnxrccpq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dpvnxrccpq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dpvnxrccpq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dpvnxrccpq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dpvnxrccpq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dpvnxrccpq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dpvnxrccpq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dpvnxrccpq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dpvnxrccpq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dpvnxrccpq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dpvnxrccpq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dpvnxrccpq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dpvnxrccpq .gt_spanner_row {
  border-bottom-style: hidden;
}

#dpvnxrccpq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dpvnxrccpq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dpvnxrccpq .gt_from_md > :first-child {
  margin-top: 0;
}

#dpvnxrccpq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dpvnxrccpq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dpvnxrccpq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dpvnxrccpq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dpvnxrccpq .gt_row_group_first td {
  border-top-width: 2px;
}

#dpvnxrccpq .gt_row_group_first th {
  border-top-width: 2px;
}

#dpvnxrccpq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpvnxrccpq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dpvnxrccpq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dpvnxrccpq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dpvnxrccpq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpvnxrccpq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dpvnxrccpq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dpvnxrccpq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dpvnxrccpq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dpvnxrccpq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dpvnxrccpq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpvnxrccpq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dpvnxrccpq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpvnxrccpq .gt_left {
  text-align: left;
}

#dpvnxrccpq .gt_center {
  text-align: center;
}

#dpvnxrccpq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dpvnxrccpq .gt_font_normal {
  font-weight: normal;
}

#dpvnxrccpq .gt_font_bold {
  font-weight: bold;
}

#dpvnxrccpq .gt_font_italic {
  font-style: italic;
}

#dpvnxrccpq .gt_super {
  font-size: 65%;
}

#dpvnxrccpq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dpvnxrccpq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dpvnxrccpq .gt_indent_1 {
  text-indent: 5px;
}

#dpvnxrccpq .gt_indent_2 {
  text-indent: 10px;
}

#dpvnxrccpq .gt_indent_3 {
  text-indent: 15px;
}

#dpvnxrccpq .gt_indent_4 {
  text-indent: 20px;
}

#dpvnxrccpq .gt_indent_5 {
  text-indent: 25px;
}

#dpvnxrccpq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dpvnxrccpq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Filtered Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why HAVING when there is WHERE
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>HAVING</code> is used because <code>WHERE</code> can’t filter on aggregate functions (like <code>SUM</code>, <code>AVG</code>, <code>COUNT</code>) that are often used with grouped data.</p>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find stores with total sales greater than N300:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1">1</button><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-7-3"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3">3</button><span id="annotated-cell-7-5" class="code-annotation-target"><a href="#annotated-cell-7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">300</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="5" data-code-annotation="3">Filter all total_sales_amount greater than 300.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="lnxikouexr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lnxikouexr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lnxikouexr thead, #lnxikouexr tbody, #lnxikouexr tfoot, #lnxikouexr tr, #lnxikouexr td, #lnxikouexr th {
  border-style: none;
}

#lnxikouexr p {
  margin: 0;
  padding: 0;
}

#lnxikouexr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lnxikouexr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lnxikouexr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lnxikouexr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lnxikouexr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lnxikouexr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lnxikouexr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lnxikouexr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lnxikouexr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lnxikouexr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lnxikouexr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lnxikouexr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lnxikouexr .gt_spanner_row {
  border-bottom-style: hidden;
}

#lnxikouexr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lnxikouexr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lnxikouexr .gt_from_md > :first-child {
  margin-top: 0;
}

#lnxikouexr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lnxikouexr .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lnxikouexr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#lnxikouexr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lnxikouexr .gt_row_group_first td {
  border-top-width: 2px;
}

#lnxikouexr .gt_row_group_first th {
  border-top-width: 2px;
}

#lnxikouexr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lnxikouexr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lnxikouexr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lnxikouexr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lnxikouexr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lnxikouexr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lnxikouexr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lnxikouexr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lnxikouexr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lnxikouexr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lnxikouexr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lnxikouexr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lnxikouexr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lnxikouexr .gt_left {
  text-align: left;
}

#lnxikouexr .gt_center {
  text-align: center;
}

#lnxikouexr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lnxikouexr .gt_font_normal {
  font-weight: normal;
}

#lnxikouexr .gt_font_bold {
  font-weight: bold;
}

#lnxikouexr .gt_font_italic {
  font-style: italic;
}

#lnxikouexr .gt_super {
  font-size: 65%;
}

#lnxikouexr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lnxikouexr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lnxikouexr .gt_indent_1 {
  text-indent: 5px;
}

#lnxikouexr .gt_indent_2 {
  text-indent: 10px;
}

#lnxikouexr .gt_indent_3 {
  text-indent: 15px;
}

#lnxikouexr .gt_indent_4 {
  text-indent: 20px;
}

#lnxikouexr .gt_indent_5 {
  text-indent: 25px;
}

#lnxikouexr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lnxikouexr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_left">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_left">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_left">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="group-by-with-date" class="level3" data-number="7.1.5">
<h3 data-number="7.1.5" class="anchored" data-anchor-id="group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></h3>
<p>You can also group by date or time intervals.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find the total sales per day:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_date, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> sales_date;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="2">Group all rows by each unique date (day).</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="xwjjpvnivo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xwjjpvnivo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xwjjpvnivo thead, #xwjjpvnivo tbody, #xwjjpvnivo tfoot, #xwjjpvnivo tr, #xwjjpvnivo td, #xwjjpvnivo th {
  border-style: none;
}

#xwjjpvnivo p {
  margin: 0;
  padding: 0;
}

#xwjjpvnivo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xwjjpvnivo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xwjjpvnivo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xwjjpvnivo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xwjjpvnivo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwjjpvnivo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwjjpvnivo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwjjpvnivo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xwjjpvnivo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xwjjpvnivo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xwjjpvnivo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xwjjpvnivo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xwjjpvnivo .gt_spanner_row {
  border-bottom-style: hidden;
}

#xwjjpvnivo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xwjjpvnivo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xwjjpvnivo .gt_from_md > :first-child {
  margin-top: 0;
}

#xwjjpvnivo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xwjjpvnivo .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xwjjpvnivo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#xwjjpvnivo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xwjjpvnivo .gt_row_group_first td {
  border-top-width: 2px;
}

#xwjjpvnivo .gt_row_group_first th {
  border-top-width: 2px;
}

#xwjjpvnivo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwjjpvnivo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xwjjpvnivo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xwjjpvnivo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwjjpvnivo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwjjpvnivo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xwjjpvnivo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xwjjpvnivo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xwjjpvnivo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwjjpvnivo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwjjpvnivo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwjjpvnivo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwjjpvnivo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwjjpvnivo .gt_left {
  text-align: left;
}

#xwjjpvnivo .gt_center {
  text-align: center;
}

#xwjjpvnivo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xwjjpvnivo .gt_font_normal {
  font-weight: normal;
}

#xwjjpvnivo .gt_font_bold {
  font-weight: bold;
}

#xwjjpvnivo .gt_font_italic {
  font-style: italic;
}

#xwjjpvnivo .gt_super {
  font-size: 65%;
}

#xwjjpvnivo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xwjjpvnivo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xwjjpvnivo .gt_indent_1 {
  text-indent: 5px;
}

#xwjjpvnivo .gt_indent_2 {
  text-indent: 10px;
}

#xwjjpvnivo .gt_indent_3 {
  text-indent: 15px;
}

#xwjjpvnivo .gt_indent_4 {
  text-indent: 20px;
}

#xwjjpvnivo .gt_indent_5 {
  text-indent: 25px;
}

#xwjjpvnivo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xwjjpvnivo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="daily_sales" class="gt_row gt_center">250</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="daily_sales" class="gt_row gt_center">600</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="daily_sales" class="gt_row gt_center">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-expressions" class="level3" data-number="7.1.6">
<h3 data-number="7.1.6" class="anchored" data-anchor-id="group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</h3>
<p>You can also use expressions or functions in <code>GROUP BY</code></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Group by the year of the sales date:</span></span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-4" class="code-annotation-target"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date) <span class="kw">AS</span> sales_day,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2">2</button><span id="annotated-cell-9-5" class="code-annotation-target"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3">3</button><span id="annotated-cell-9-7" class="code-annotation-target"><a href="#annotated-cell-9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date);</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="4" data-code-annotation="1">Extract the day from the date.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="5" data-code-annotation="2">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="7" data-code-annotation="3">Group all rows by each unique day.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="foeidzdrcn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#foeidzdrcn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#foeidzdrcn thead, #foeidzdrcn tbody, #foeidzdrcn tfoot, #foeidzdrcn tr, #foeidzdrcn td, #foeidzdrcn th {
  border-style: none;
}

#foeidzdrcn p {
  margin: 0;
  padding: 0;
}

#foeidzdrcn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#foeidzdrcn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#foeidzdrcn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#foeidzdrcn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#foeidzdrcn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#foeidzdrcn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#foeidzdrcn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#foeidzdrcn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#foeidzdrcn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#foeidzdrcn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#foeidzdrcn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#foeidzdrcn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#foeidzdrcn .gt_spanner_row {
  border-bottom-style: hidden;
}

#foeidzdrcn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#foeidzdrcn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#foeidzdrcn .gt_from_md > :first-child {
  margin-top: 0;
}

#foeidzdrcn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#foeidzdrcn .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#foeidzdrcn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#foeidzdrcn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#foeidzdrcn .gt_row_group_first td {
  border-top-width: 2px;
}

#foeidzdrcn .gt_row_group_first th {
  border-top-width: 2px;
}

#foeidzdrcn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#foeidzdrcn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#foeidzdrcn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#foeidzdrcn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#foeidzdrcn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#foeidzdrcn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#foeidzdrcn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#foeidzdrcn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#foeidzdrcn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#foeidzdrcn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#foeidzdrcn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#foeidzdrcn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#foeidzdrcn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#foeidzdrcn .gt_left {
  text-align: left;
}

#foeidzdrcn .gt_center {
  text-align: center;
}

#foeidzdrcn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#foeidzdrcn .gt_font_normal {
  font-weight: normal;
}

#foeidzdrcn .gt_font_bold {
  font-weight: bold;
}

#foeidzdrcn .gt_font_italic {
  font-style: italic;
}

#foeidzdrcn .gt_super {
  font-size: 65%;
}

#foeidzdrcn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#foeidzdrcn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#foeidzdrcn .gt_indent_1 {
  text-indent: 5px;
}

#foeidzdrcn .gt_indent_2 {
  text-indent: 10px;
}

#foeidzdrcn .gt_indent_3 {
  text-indent: 15px;
}

#foeidzdrcn .gt_indent_4 {
  text-indent: 20px;
}

#foeidzdrcn .gt_indent_5 {
  text-indent: 25px;
}

#foeidzdrcn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#foeidzdrcn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="sales_day">sales_day</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">1</td>
<td headers="daily_sales" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">2</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">3</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">4</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">5</td>
<td headers="daily_sales" class="gt_row gt_right">600</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">6</td>
<td headers="daily_sales" class="gt_row gt_right">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-order-by" class="level3" data-number="7.1.7">
<h3 data-number="7.1.7" class="anchored" data-anchor-id="group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></h3>
<p>You can order the results of a <code>GROUP BY</code> query by the aggregated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-10-2"><a href="#annotated-cell-10-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-3" class="code-annotation-target"><a href="#annotated-cell-10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-5" class="code-annotation-target"><a href="#annotated-cell-10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="3">3</button><span id="annotated-cell-10-6" class="code-annotation-target"><a href="#annotated-cell-10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_sales_amount <span class="kw">DESC</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="3" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="5" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="6" data-code-annotation="3">Sort the aggregated output by the total sales amount in descending order.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="atzpcojnfj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#atzpcojnfj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#atzpcojnfj thead, #atzpcojnfj tbody, #atzpcojnfj tfoot, #atzpcojnfj tr, #atzpcojnfj td, #atzpcojnfj th {
  border-style: none;
}

#atzpcojnfj p {
  margin: 0;
  padding: 0;
}

#atzpcojnfj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#atzpcojnfj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#atzpcojnfj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#atzpcojnfj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#atzpcojnfj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#atzpcojnfj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#atzpcojnfj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#atzpcojnfj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#atzpcojnfj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#atzpcojnfj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#atzpcojnfj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#atzpcojnfj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#atzpcojnfj .gt_spanner_row {
  border-bottom-style: hidden;
}

#atzpcojnfj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#atzpcojnfj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#atzpcojnfj .gt_from_md > :first-child {
  margin-top: 0;
}

#atzpcojnfj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#atzpcojnfj .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#atzpcojnfj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#atzpcojnfj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#atzpcojnfj .gt_row_group_first td {
  border-top-width: 2px;
}

#atzpcojnfj .gt_row_group_first th {
  border-top-width: 2px;
}

#atzpcojnfj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#atzpcojnfj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#atzpcojnfj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#atzpcojnfj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#atzpcojnfj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#atzpcojnfj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#atzpcojnfj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#atzpcojnfj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#atzpcojnfj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#atzpcojnfj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#atzpcojnfj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#atzpcojnfj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#atzpcojnfj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#atzpcojnfj .gt_left {
  text-align: left;
}

#atzpcojnfj .gt_center {
  text-align: center;
}

#atzpcojnfj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#atzpcojnfj .gt_font_normal {
  font-weight: normal;
}

#atzpcojnfj .gt_font_bold {
  font-weight: bold;
}

#atzpcojnfj .gt_font_italic {
  font-style: italic;
}

#atzpcojnfj .gt_super {
  font-size: 65%;
}

#atzpcojnfj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#atzpcojnfj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#atzpcojnfj .gt_indent_1 {
  text-indent: 5px;
}

#atzpcojnfj .gt_indent_2 {
  text-indent: 10px;
}

#atzpcojnfj .gt_indent_3 {
  text-indent: 15px;
}

#atzpcojnfj .gt_indent_4 {
  text-indent: 20px;
}

#atzpcojnfj .gt_indent_5 {
  text-indent: 25px;
}

#atzpcojnfj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#atzpcojnfj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_center">1250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_center">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_center">600</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="grouping-with-a-conditional-aggregate" class="level3" data-number="7.1.8">
<h3 data-number="7.1.8" class="anchored" data-anchor-id="grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</h3>
<p>To calculate the number of sales and the total amount for each store, but only for sales over $100:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-11"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-11-1"><a href="#annotated-cell-11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="1">1</button><span id="annotated-cell-11-2" class="code-annotation-target"><a href="#annotated-cell-11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_sales_count,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="2">2</button><span id="annotated-cell-11-3" class="code-annotation-target"><a href="#annotated-cell-11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> amount <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_total_amount</span>
<span id="annotated-cell-11-4"><a href="#annotated-cell-11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-11-5"><a href="#annotated-cell-11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-11" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="2" data-code-annotation="1">If sales amount is greater than 100 count it.</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="3" data-code-annotation="2">If sales amount is greater than 100 then add sales amount else add zero.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="pcoqqnhsir" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pcoqqnhsir table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pcoqqnhsir thead, #pcoqqnhsir tbody, #pcoqqnhsir tfoot, #pcoqqnhsir tr, #pcoqqnhsir td, #pcoqqnhsir th {
  border-style: none;
}

#pcoqqnhsir p {
  margin: 0;
  padding: 0;
}

#pcoqqnhsir .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pcoqqnhsir .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pcoqqnhsir .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pcoqqnhsir .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pcoqqnhsir .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pcoqqnhsir .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pcoqqnhsir .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pcoqqnhsir .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pcoqqnhsir .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pcoqqnhsir .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pcoqqnhsir .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pcoqqnhsir .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pcoqqnhsir .gt_spanner_row {
  border-bottom-style: hidden;
}

#pcoqqnhsir .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pcoqqnhsir .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pcoqqnhsir .gt_from_md > :first-child {
  margin-top: 0;
}

#pcoqqnhsir .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pcoqqnhsir .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pcoqqnhsir .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#pcoqqnhsir .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pcoqqnhsir .gt_row_group_first td {
  border-top-width: 2px;
}

#pcoqqnhsir .gt_row_group_first th {
  border-top-width: 2px;
}

#pcoqqnhsir .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcoqqnhsir .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pcoqqnhsir .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pcoqqnhsir .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pcoqqnhsir .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcoqqnhsir .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pcoqqnhsir .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pcoqqnhsir .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pcoqqnhsir .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pcoqqnhsir .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pcoqqnhsir .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcoqqnhsir .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pcoqqnhsir .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcoqqnhsir .gt_left {
  text-align: left;
}

#pcoqqnhsir .gt_center {
  text-align: center;
}

#pcoqqnhsir .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pcoqqnhsir .gt_font_normal {
  font-weight: normal;
}

#pcoqqnhsir .gt_font_bold {
  font-weight: bold;
}

#pcoqqnhsir .gt_font_italic {
  font-style: italic;
}

#pcoqqnhsir .gt_super {
  font-size: 65%;
}

#pcoqqnhsir .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pcoqqnhsir .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pcoqqnhsir .gt_indent_1 {
  text-indent: 5px;
}

#pcoqqnhsir .gt_indent_2 {
  text-indent: 10px;
}

#pcoqqnhsir .gt_indent_3 {
  text-indent: 15px;
}

#pcoqqnhsir .gt_indent_4 {
  text-indent: 20px;
}

#pcoqqnhsir .gt_indent_5 {
  text-indent: 25px;
}

#pcoqqnhsir .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pcoqqnhsir div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_sales_count">high_value_sales_count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_total_amount">high_value_total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">800</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="high_value_sales_count" class="gt_row gt_center">5</td>
<td headers="high_value_total_amount" class="gt_row gt_center">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group by Summary
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>It is often used with aggregate functions <strong>to perform calculations on each group.</strong></p></li>
<li><p><code>HAVING</code> clause can be used to filter groups after the aggregation.</p></li>
<li><p><code>ORDER BY</code> can be combined with <code>GROUP BY</code> to sort the results by the aggregated values.</p></li>
</ul>
</div>
</div>
<p><br> <br> <br></p>
<!------- GROUP BY ---------------------------------------------------------->
</section>
</section>
<section id="window-function" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="window-function"><span class="header-section-number">7.2</span> Window Function</h2>
<p>Window functions <strong>perform calculations across a set of table rows related to the current row</strong>. Unlike aggregate functions, which return a single value after grouping rows, window functions return multiple rows with calculated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-12-2"><a href="#annotated-cell-12-2" aria-hidden="true" tabindex="-1"></a>  col_name1, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1">1</button><span id="annotated-cell-12-3" class="code-annotation-target"><a href="#annotated-cell-12-3" aria-hidden="true" tabindex="-1"></a>  window_function() <span class="kw">OVER</span> ([<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2] [<span class="kw">ORDER</span> <span class="kw">BY</span> col_name3]) <span class="kw">AS</span> alias_name</span>
<span id="annotated-cell-12-4"><a href="#annotated-cell-12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="3" data-code-annotation="1">Define the window function and how it should be grouped and sorted.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Key Concepts of Window Function
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>OVER()</code> Clause defines the window of rows the function operates on.</li>
<li><code>PARTITION BY</code> divides the result set into <strong>partitions</strong> (like a GROUP BY).</li>
<li><code>ORDER BY</code> defines the order of rows within each partition.</li>
</ul>
</div>
</div>
<section id="row_number" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</h3>
<p>This function will assign a unique row number within a partition.</p>
</section>
<section id="quick-illustration-of-window-function" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-window-function">Quick illustration of window function</h3>
<p>A Simple example of how window function works.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">row_number</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="jrskodjjrx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jrskodjjrx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jrskodjjrx thead, #jrskodjjrx tbody, #jrskodjjrx tfoot, #jrskodjjrx tr, #jrskodjjrx td, #jrskodjjrx th {
  border-style: none;
}

#jrskodjjrx p {
  margin: 0;
  padding: 0;
}

#jrskodjjrx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jrskodjjrx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jrskodjjrx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jrskodjjrx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jrskodjjrx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jrskodjjrx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrskodjjrx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jrskodjjrx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jrskodjjrx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jrskodjjrx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jrskodjjrx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jrskodjjrx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jrskodjjrx .gt_spanner_row {
  border-bottom-style: hidden;
}

#jrskodjjrx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jrskodjjrx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jrskodjjrx .gt_from_md > :first-child {
  margin-top: 0;
}

#jrskodjjrx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jrskodjjrx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jrskodjjrx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jrskodjjrx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jrskodjjrx .gt_row_group_first td {
  border-top-width: 2px;
}

#jrskodjjrx .gt_row_group_first th {
  border-top-width: 2px;
}

#jrskodjjrx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrskodjjrx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jrskodjjrx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jrskodjjrx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrskodjjrx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrskodjjrx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jrskodjjrx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jrskodjjrx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jrskodjjrx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jrskodjjrx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jrskodjjrx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrskodjjrx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jrskodjjrx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jrskodjjrx .gt_left {
  text-align: left;
}

#jrskodjjrx .gt_center {
  text-align: center;
}

#jrskodjjrx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jrskodjjrx .gt_font_normal {
  font-weight: normal;
}

#jrskodjjrx .gt_font_bold {
  font-weight: bold;
}

#jrskodjjrx .gt_font_italic {
  font-style: italic;
}

#jrskodjjrx .gt_super {
  font-size: 65%;
}

#jrskodjjrx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jrskodjjrx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jrskodjjrx .gt_indent_1 {
  text-indent: 5px;
}

#jrskodjjrx .gt_indent_2 {
  text-indent: 10px;
}

#jrskodjjrx .gt_indent_3 {
  text-indent: 15px;
}

#jrskodjjrx .gt_indent_4 {
  text-indent: 20px;
}

#jrskodjjrx .gt_indent_5 {
  text-indent: 25px;
}

#jrskodjjrx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jrskodjjrx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="row_number">row_number</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br></p>
<section id="unordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="unordered">Unordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-14-3"><a href="#annotated-cell-14-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-14-4"><a href="#annotated-cell-14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1">1</button><span id="annotated-cell-14-5" class="code-annotation-target"><a href="#annotated-cell-14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-14-6"><a href="#annotated-cell-14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id then get the row number for each partition.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="vgmstikaxi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vgmstikaxi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vgmstikaxi thead, #vgmstikaxi tbody, #vgmstikaxi tfoot, #vgmstikaxi tr, #vgmstikaxi td, #vgmstikaxi th {
  border-style: none;
}

#vgmstikaxi p {
  margin: 0;
  padding: 0;
}

#vgmstikaxi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vgmstikaxi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vgmstikaxi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vgmstikaxi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vgmstikaxi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vgmstikaxi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgmstikaxi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vgmstikaxi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vgmstikaxi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vgmstikaxi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vgmstikaxi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vgmstikaxi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vgmstikaxi .gt_spanner_row {
  border-bottom-style: hidden;
}

#vgmstikaxi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vgmstikaxi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vgmstikaxi .gt_from_md > :first-child {
  margin-top: 0;
}

#vgmstikaxi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vgmstikaxi .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vgmstikaxi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#vgmstikaxi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vgmstikaxi .gt_row_group_first td {
  border-top-width: 2px;
}

#vgmstikaxi .gt_row_group_first th {
  border-top-width: 2px;
}

#vgmstikaxi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgmstikaxi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vgmstikaxi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vgmstikaxi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgmstikaxi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgmstikaxi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vgmstikaxi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vgmstikaxi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vgmstikaxi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vgmstikaxi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vgmstikaxi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgmstikaxi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vgmstikaxi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vgmstikaxi .gt_left {
  text-align: left;
}

#vgmstikaxi .gt_center {
  text-align: center;
}

#vgmstikaxi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vgmstikaxi .gt_font_normal {
  font-weight: normal;
}

#vgmstikaxi .gt_font_bold {
  font-weight: bold;
}

#vgmstikaxi .gt_font_italic {
  font-style: italic;
}

#vgmstikaxi .gt_super {
  font-size: 65%;
}

#vgmstikaxi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vgmstikaxi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vgmstikaxi .gt_indent_1 {
  text-indent: 5px;
}

#vgmstikaxi .gt_indent_2 {
  text-indent: 10px;
}

#vgmstikaxi .gt_indent_3 {
  text-indent: 15px;
}

#vgmstikaxi .gt_indent_4 {
  text-indent: 20px;
}

#vgmstikaxi .gt_indent_5 {
  text-indent: 25px;
}

#vgmstikaxi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vgmstikaxi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="ordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ordered">Ordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-15"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-15-1"><a href="#annotated-cell-15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-15-2"><a href="#annotated-cell-15-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-15-3"><a href="#annotated-cell-15-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-15-4"><a href="#annotated-cell-15-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-15" data-target-annotation="1">1</button><span id="annotated-cell-15-5" class="code-annotation-target"><a href="#annotated-cell-15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-15-6"><a href="#annotated-cell-15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-15" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-15" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id, then order by the sales date. Then get the row number by the partition. In other words, the rows are numbered sequentially for each store_id based on sales_date.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="cxpbqbjqal" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cxpbqbjqal table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cxpbqbjqal thead, #cxpbqbjqal tbody, #cxpbqbjqal tfoot, #cxpbqbjqal tr, #cxpbqbjqal td, #cxpbqbjqal th {
  border-style: none;
}

#cxpbqbjqal p {
  margin: 0;
  padding: 0;
}

#cxpbqbjqal .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cxpbqbjqal .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cxpbqbjqal .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cxpbqbjqal .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cxpbqbjqal .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxpbqbjqal .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxpbqbjqal .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cxpbqbjqal .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cxpbqbjqal .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cxpbqbjqal .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cxpbqbjqal .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cxpbqbjqal .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cxpbqbjqal .gt_spanner_row {
  border-bottom-style: hidden;
}

#cxpbqbjqal .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cxpbqbjqal .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cxpbqbjqal .gt_from_md > :first-child {
  margin-top: 0;
}

#cxpbqbjqal .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cxpbqbjqal .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cxpbqbjqal .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#cxpbqbjqal .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cxpbqbjqal .gt_row_group_first td {
  border-top-width: 2px;
}

#cxpbqbjqal .gt_row_group_first th {
  border-top-width: 2px;
}

#cxpbqbjqal .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxpbqbjqal .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cxpbqbjqal .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cxpbqbjqal .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxpbqbjqal .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxpbqbjqal .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cxpbqbjqal .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cxpbqbjqal .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cxpbqbjqal .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cxpbqbjqal .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxpbqbjqal .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxpbqbjqal .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cxpbqbjqal .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cxpbqbjqal .gt_left {
  text-align: left;
}

#cxpbqbjqal .gt_center {
  text-align: center;
}

#cxpbqbjqal .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cxpbqbjqal .gt_font_normal {
  font-weight: normal;
}

#cxpbqbjqal .gt_font_bold {
  font-weight: bold;
}

#cxpbqbjqal .gt_font_italic {
  font-style: italic;
}

#cxpbqbjqal .gt_super {
  font-size: 65%;
}

#cxpbqbjqal .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cxpbqbjqal .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cxpbqbjqal .gt_indent_1 {
  text-indent: 5px;
}

#cxpbqbjqal .gt_indent_2 {
  text-indent: 10px;
}

#cxpbqbjqal .gt_indent_3 {
  text-indent: 15px;
}

#cxpbqbjqal .gt_indent_4 {
  text-indent: 20px;
}

#cxpbqbjqal .gt_indent_5 {
  text-indent: 25px;
}

#cxpbqbjqal .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cxpbqbjqal div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="aggregate-function-sum-as-a-window-function" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</h3>
<section id="quick-illustration-of-window-aggregate-functions" class="level4" data-number="7.2.2.1">
<h4 data-number="7.2.2.1" class="anchored" data-anchor-id="quick-illustration-of-window-aggregate-functions"><span class="header-section-number">7.2.2.1</span> Quick Illustration of window aggregate functions</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-16"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-16-1"><a href="#annotated-cell-16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="annotated-cell-16-2"><a href="#annotated-cell-16-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="annotated-cell-16-3"><a href="#annotated-cell-16-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="annotated-cell-16-4"><a href="#annotated-cell-16-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="1">1</button><span id="annotated-cell-16-5" class="code-annotation-target"><a href="#annotated-cell-16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span>) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-16-6"><a href="#annotated-cell-16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-16" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="5" data-code-annotation="1">Get the total amount of each partition.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="kezbploavp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kezbploavp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kezbploavp thead, #kezbploavp tbody, #kezbploavp tfoot, #kezbploavp tr, #kezbploavp td, #kezbploavp th {
  border-style: none;
}

#kezbploavp p {
  margin: 0;
  padding: 0;
}

#kezbploavp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kezbploavp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kezbploavp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kezbploavp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kezbploavp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kezbploavp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kezbploavp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kezbploavp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kezbploavp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kezbploavp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kezbploavp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kezbploavp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kezbploavp .gt_spanner_row {
  border-bottom-style: hidden;
}

#kezbploavp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kezbploavp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kezbploavp .gt_from_md > :first-child {
  margin-top: 0;
}

#kezbploavp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kezbploavp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kezbploavp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kezbploavp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kezbploavp .gt_row_group_first td {
  border-top-width: 2px;
}

#kezbploavp .gt_row_group_first th {
  border-top-width: 2px;
}

#kezbploavp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kezbploavp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kezbploavp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kezbploavp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kezbploavp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kezbploavp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kezbploavp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kezbploavp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kezbploavp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kezbploavp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kezbploavp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kezbploavp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kezbploavp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kezbploavp .gt_left {
  text-align: left;
}

#kezbploavp .gt_center {
  text-align: center;
}

#kezbploavp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kezbploavp .gt_font_normal {
  font-weight: normal;
}

#kezbploavp .gt_font_bold {
  font-weight: bold;
}

#kezbploavp .gt_font_italic {
  font-style: italic;
}

#kezbploavp .gt_super {
  font-size: 65%;
}

#kezbploavp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kezbploavp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kezbploavp .gt_indent_1 {
  text-indent: 5px;
}

#kezbploavp .gt_indent_2 {
  text-indent: 10px;
}

#kezbploavp .gt_indent_3 {
  text-indent: 15px;
}

#kezbploavp .gt_indent_4 {
  text-indent: 20px;
}

#kezbploavp .gt_indent_5 {
  text-indent: 25px;
}

#kezbploavp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kezbploavp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> running_total</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="diembfcfzm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#diembfcfzm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#diembfcfzm thead, #diembfcfzm tbody, #diembfcfzm tfoot, #diembfcfzm tr, #diembfcfzm td, #diembfcfzm th {
  border-style: none;
}

#diembfcfzm p {
  margin: 0;
  padding: 0;
}

#diembfcfzm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#diembfcfzm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#diembfcfzm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#diembfcfzm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#diembfcfzm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#diembfcfzm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#diembfcfzm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#diembfcfzm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#diembfcfzm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#diembfcfzm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#diembfcfzm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#diembfcfzm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#diembfcfzm .gt_spanner_row {
  border-bottom-style: hidden;
}

#diembfcfzm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#diembfcfzm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#diembfcfzm .gt_from_md > :first-child {
  margin-top: 0;
}

#diembfcfzm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#diembfcfzm .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#diembfcfzm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#diembfcfzm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#diembfcfzm .gt_row_group_first td {
  border-top-width: 2px;
}

#diembfcfzm .gt_row_group_first th {
  border-top-width: 2px;
}

#diembfcfzm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#diembfcfzm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#diembfcfzm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#diembfcfzm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#diembfcfzm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#diembfcfzm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#diembfcfzm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#diembfcfzm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#diembfcfzm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#diembfcfzm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#diembfcfzm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#diembfcfzm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#diembfcfzm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#diembfcfzm .gt_left {
  text-align: left;
}

#diembfcfzm .gt_center {
  text-align: center;
}

#diembfcfzm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#diembfcfzm .gt_font_normal {
  font-weight: normal;
}

#diembfcfzm .gt_font_bold {
  font-weight: bold;
}

#diembfcfzm .gt_font_italic {
  font-style: italic;
}

#diembfcfzm .gt_super {
  font-size: 65%;
}

#diembfcfzm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#diembfcfzm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#diembfcfzm .gt_indent_1 {
  text-indent: 5px;
}

#diembfcfzm .gt_indent_2 {
  text-indent: 10px;
}

#diembfcfzm .gt_indent_3 {
  text-indent: 15px;
}

#diembfcfzm .gt_indent_4 {
  text-indent: 20px;
}

#diembfcfzm .gt_indent_5 {
  text-indent: 25px;
}

#diembfcfzm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#diembfcfzm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="running_total">running_total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="running_total" class="gt_row gt_right">550</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">650</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="rank" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="rank"><span class="header-section-number">7.2.3</span> RANK</h3>
<p>Ranks the rows within a partition. Ties result in the same rank, but with gaps in the sequence.</p>
<section id="quick-illustration" class="level4" data-number="7.2.3.1">
<h4 data-number="7.2.3.1" class="anchored" data-anchor-id="quick-illustration"><span class="header-section-number">7.2.3.1</span> Quick Illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    product,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    amount</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fbwtovfycn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fbwtovfycn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fbwtovfycn thead, #fbwtovfycn tbody, #fbwtovfycn tfoot, #fbwtovfycn tr, #fbwtovfycn td, #fbwtovfycn th {
  border-style: none;
}

#fbwtovfycn p {
  margin: 0;
  padding: 0;
}

#fbwtovfycn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fbwtovfycn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fbwtovfycn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fbwtovfycn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fbwtovfycn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fbwtovfycn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fbwtovfycn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fbwtovfycn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fbwtovfycn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fbwtovfycn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fbwtovfycn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fbwtovfycn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fbwtovfycn .gt_spanner_row {
  border-bottom-style: hidden;
}

#fbwtovfycn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fbwtovfycn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fbwtovfycn .gt_from_md > :first-child {
  margin-top: 0;
}

#fbwtovfycn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fbwtovfycn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fbwtovfycn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fbwtovfycn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fbwtovfycn .gt_row_group_first td {
  border-top-width: 2px;
}

#fbwtovfycn .gt_row_group_first th {
  border-top-width: 2px;
}

#fbwtovfycn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbwtovfycn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fbwtovfycn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fbwtovfycn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fbwtovfycn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbwtovfycn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fbwtovfycn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fbwtovfycn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fbwtovfycn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fbwtovfycn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fbwtovfycn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbwtovfycn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fbwtovfycn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fbwtovfycn .gt_left {
  text-align: left;
}

#fbwtovfycn .gt_center {
  text-align: center;
}

#fbwtovfycn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fbwtovfycn .gt_font_normal {
  font-weight: normal;
}

#fbwtovfycn .gt_font_bold {
  font-weight: bold;
}

#fbwtovfycn .gt_font_italic {
  font-style: italic;
}

#fbwtovfycn .gt_super {
  font-size: 65%;
}

#fbwtovfycn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fbwtovfycn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fbwtovfycn .gt_indent_1 {
  text-indent: 5px;
}

#fbwtovfycn .gt_indent_2 {
  text-indent: 10px;
}

#fbwtovfycn .gt_indent_3 {
  text-indent: 15px;
}

#fbwtovfycn .gt_indent_4 {
  text-indent: 20px;
}

#fbwtovfycn .gt_indent_5 {
  text-indent: 25px;
}

#fbwtovfycn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fbwtovfycn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">4</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ybhnfpgukm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ybhnfpgukm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ybhnfpgukm thead, #ybhnfpgukm tbody, #ybhnfpgukm tfoot, #ybhnfpgukm tr, #ybhnfpgukm td, #ybhnfpgukm th {
  border-style: none;
}

#ybhnfpgukm p {
  margin: 0;
  padding: 0;
}

#ybhnfpgukm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ybhnfpgukm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ybhnfpgukm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ybhnfpgukm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ybhnfpgukm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ybhnfpgukm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ybhnfpgukm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ybhnfpgukm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ybhnfpgukm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ybhnfpgukm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ybhnfpgukm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ybhnfpgukm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ybhnfpgukm .gt_spanner_row {
  border-bottom-style: hidden;
}

#ybhnfpgukm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ybhnfpgukm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ybhnfpgukm .gt_from_md > :first-child {
  margin-top: 0;
}

#ybhnfpgukm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ybhnfpgukm .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ybhnfpgukm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#ybhnfpgukm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ybhnfpgukm .gt_row_group_first td {
  border-top-width: 2px;
}

#ybhnfpgukm .gt_row_group_first th {
  border-top-width: 2px;
}

#ybhnfpgukm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ybhnfpgukm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ybhnfpgukm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ybhnfpgukm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ybhnfpgukm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ybhnfpgukm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ybhnfpgukm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ybhnfpgukm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ybhnfpgukm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ybhnfpgukm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ybhnfpgukm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ybhnfpgukm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ybhnfpgukm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ybhnfpgukm .gt_left {
  text-align: left;
}

#ybhnfpgukm .gt_center {
  text-align: center;
}

#ybhnfpgukm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ybhnfpgukm .gt_font_normal {
  font-weight: normal;
}

#ybhnfpgukm .gt_font_bold {
  font-weight: bold;
}

#ybhnfpgukm .gt_font_italic {
  font-style: italic;
}

#ybhnfpgukm .gt_super {
  font-size: 65%;
}

#ybhnfpgukm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ybhnfpgukm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ybhnfpgukm .gt_indent_1 {
  text-indent: 5px;
}

#ybhnfpgukm .gt_indent_2 {
  text-indent: 10px;
}

#ybhnfpgukm .gt_indent_3 {
  text-indent: 15px;
}

#ybhnfpgukm .gt_indent_4 {
  text-indent: 20px;
}

#ybhnfpgukm .gt_indent_5 {
  text-indent: 25px;
}

#ybhnfpgukm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ybhnfpgukm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>If two rows have the same amount within the same store_id, they will get the same rank, and the next rank will be skipped.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="dense_rank" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</h3>
<p>Similar to <code>RANK()</code>, but without gaps in the ranking sequence.</p>
<section id="quick-illustration-1" class="level4" data-number="7.2.4.1">
<h4 data-number="7.2.4.1" class="anchored" data-anchor-id="quick-illustration-1"><span class="header-section-number">7.2.4.1</span> Quick Illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    product,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    amount</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="xscqyrfseq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xscqyrfseq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xscqyrfseq thead, #xscqyrfseq tbody, #xscqyrfseq tfoot, #xscqyrfseq tr, #xscqyrfseq td, #xscqyrfseq th {
  border-style: none;
}

#xscqyrfseq p {
  margin: 0;
  padding: 0;
}

#xscqyrfseq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xscqyrfseq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xscqyrfseq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xscqyrfseq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xscqyrfseq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xscqyrfseq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xscqyrfseq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xscqyrfseq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xscqyrfseq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xscqyrfseq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xscqyrfseq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xscqyrfseq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xscqyrfseq .gt_spanner_row {
  border-bottom-style: hidden;
}

#xscqyrfseq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xscqyrfseq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xscqyrfseq .gt_from_md > :first-child {
  margin-top: 0;
}

#xscqyrfseq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xscqyrfseq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xscqyrfseq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xscqyrfseq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xscqyrfseq .gt_row_group_first td {
  border-top-width: 2px;
}

#xscqyrfseq .gt_row_group_first th {
  border-top-width: 2px;
}

#xscqyrfseq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xscqyrfseq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xscqyrfseq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xscqyrfseq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xscqyrfseq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xscqyrfseq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xscqyrfseq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xscqyrfseq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xscqyrfseq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xscqyrfseq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xscqyrfseq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xscqyrfseq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xscqyrfseq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xscqyrfseq .gt_left {
  text-align: left;
}

#xscqyrfseq .gt_center {
  text-align: center;
}

#xscqyrfseq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xscqyrfseq .gt_font_normal {
  font-weight: normal;
}

#xscqyrfseq .gt_font_bold {
  font-weight: bold;
}

#xscqyrfseq .gt_font_italic {
  font-style: italic;
}

#xscqyrfseq .gt_super {
  font-size: 65%;
}

#xscqyrfseq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xscqyrfseq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xscqyrfseq .gt_indent_1 {
  text-indent: 5px;
}

#xscqyrfseq .gt_indent_2 {
  text-indent: 10px;
}

#xscqyrfseq .gt_indent_3 {
  text-indent: 15px;
}

#xscqyrfseq .gt_indent_4 {
  text-indent: 20px;
}

#xscqyrfseq .gt_indent_5 {
  text-indent: 25px;
}

#xscqyrfseq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xscqyrfseq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="dense_rank">dense_rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="bhxvnnivrf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bhxvnnivrf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bhxvnnivrf thead, #bhxvnnivrf tbody, #bhxvnnivrf tfoot, #bhxvnnivrf tr, #bhxvnnivrf td, #bhxvnnivrf th {
  border-style: none;
}

#bhxvnnivrf p {
  margin: 0;
  padding: 0;
}

#bhxvnnivrf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bhxvnnivrf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bhxvnnivrf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bhxvnnivrf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bhxvnnivrf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bhxvnnivrf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bhxvnnivrf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bhxvnnivrf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bhxvnnivrf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bhxvnnivrf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bhxvnnivrf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bhxvnnivrf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bhxvnnivrf .gt_spanner_row {
  border-bottom-style: hidden;
}

#bhxvnnivrf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bhxvnnivrf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bhxvnnivrf .gt_from_md > :first-child {
  margin-top: 0;
}

#bhxvnnivrf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bhxvnnivrf .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bhxvnnivrf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#bhxvnnivrf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bhxvnnivrf .gt_row_group_first td {
  border-top-width: 2px;
}

#bhxvnnivrf .gt_row_group_first th {
  border-top-width: 2px;
}

#bhxvnnivrf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bhxvnnivrf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bhxvnnivrf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bhxvnnivrf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bhxvnnivrf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bhxvnnivrf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bhxvnnivrf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bhxvnnivrf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bhxvnnivrf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bhxvnnivrf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bhxvnnivrf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bhxvnnivrf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bhxvnnivrf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bhxvnnivrf .gt_left {
  text-align: left;
}

#bhxvnnivrf .gt_center {
  text-align: center;
}

#bhxvnnivrf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bhxvnnivrf .gt_font_normal {
  font-weight: normal;
}

#bhxvnnivrf .gt_font_bold {
  font-weight: bold;
}

#bhxvnnivrf .gt_font_italic {
  font-style: italic;
}

#bhxvnnivrf .gt_super {
  font-size: 65%;
}

#bhxvnnivrf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bhxvnnivrf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bhxvnnivrf .gt_indent_1 {
  text-indent: 5px;
}

#bhxvnnivrf .gt_indent_2 {
  text-indent: 10px;
}

#bhxvnnivrf .gt_indent_3 {
  text-indent: 15px;
}

#bhxvnnivrf .gt_indent_4 {
  text-indent: 20px;
}

#bhxvnnivrf .gt_indent_5 {
  text-indent: 25px;
}

#bhxvnnivrf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bhxvnnivrf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This will rank rows without gaps, even if there are ties.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="ntile" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="ntile"><span class="header-section-number">7.2.5</span> NTILE</h3>
<p>Divides the result set into a specified number of buckets.</p>
<section id="quick-illustration-2" class="level4" data-number="7.2.5.1">
<h4 data-number="7.2.5.1" class="anchored" data-anchor-id="quick-illustration-2"><span class="header-section-number">7.2.5.1</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    product, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">3</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fphyllhmir" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fphyllhmir table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fphyllhmir thead, #fphyllhmir tbody, #fphyllhmir tfoot, #fphyllhmir tr, #fphyllhmir td, #fphyllhmir th {
  border-style: none;
}

#fphyllhmir p {
  margin: 0;
  padding: 0;
}

#fphyllhmir .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fphyllhmir .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fphyllhmir .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fphyllhmir .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fphyllhmir .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fphyllhmir .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fphyllhmir .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fphyllhmir .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fphyllhmir .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fphyllhmir .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fphyllhmir .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fphyllhmir .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fphyllhmir .gt_spanner_row {
  border-bottom-style: hidden;
}

#fphyllhmir .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fphyllhmir .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fphyllhmir .gt_from_md > :first-child {
  margin-top: 0;
}

#fphyllhmir .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fphyllhmir .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fphyllhmir .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fphyllhmir .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fphyllhmir .gt_row_group_first td {
  border-top-width: 2px;
}

#fphyllhmir .gt_row_group_first th {
  border-top-width: 2px;
}

#fphyllhmir .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fphyllhmir .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fphyllhmir .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fphyllhmir .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fphyllhmir .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fphyllhmir .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fphyllhmir .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fphyllhmir .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fphyllhmir .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fphyllhmir .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fphyllhmir .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fphyllhmir .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fphyllhmir .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fphyllhmir .gt_left {
  text-align: left;
}

#fphyllhmir .gt_center {
  text-align: center;
}

#fphyllhmir .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fphyllhmir .gt_font_normal {
  font-weight: normal;
}

#fphyllhmir .gt_font_bold {
  font-weight: bold;
}

#fphyllhmir .gt_font_italic {
  font-style: italic;
}

#fphyllhmir .gt_super {
  font-size: 65%;
}

#fphyllhmir .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fphyllhmir .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fphyllhmir .gt_indent_1 {
  text-indent: 5px;
}

#fphyllhmir .gt_indent_2 {
  text-indent: 10px;
}

#fphyllhmir .gt_indent_3 {
  text-indent: 15px;
}

#fphyllhmir .gt_indent_4 {
  text-indent: 20px;
}

#fphyllhmir .gt_indent_5 {
  text-indent: 25px;
}

#fphyllhmir .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fphyllhmir div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">20</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">30</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">30</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">70</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">80</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">120</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">120</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    sales_id, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">4</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fuidreoilw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fuidreoilw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fuidreoilw thead, #fuidreoilw tbody, #fuidreoilw tfoot, #fuidreoilw tr, #fuidreoilw td, #fuidreoilw th {
  border-style: none;
}

#fuidreoilw p {
  margin: 0;
  padding: 0;
}

#fuidreoilw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fuidreoilw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fuidreoilw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fuidreoilw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fuidreoilw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fuidreoilw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fuidreoilw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fuidreoilw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fuidreoilw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fuidreoilw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fuidreoilw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fuidreoilw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fuidreoilw .gt_spanner_row {
  border-bottom-style: hidden;
}

#fuidreoilw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fuidreoilw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fuidreoilw .gt_from_md > :first-child {
  margin-top: 0;
}

#fuidreoilw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fuidreoilw .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fuidreoilw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#fuidreoilw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fuidreoilw .gt_row_group_first td {
  border-top-width: 2px;
}

#fuidreoilw .gt_row_group_first th {
  border-top-width: 2px;
}

#fuidreoilw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fuidreoilw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fuidreoilw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fuidreoilw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fuidreoilw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fuidreoilw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fuidreoilw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fuidreoilw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fuidreoilw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fuidreoilw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fuidreoilw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fuidreoilw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fuidreoilw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fuidreoilw .gt_left {
  text-align: left;
}

#fuidreoilw .gt_center {
  text-align: center;
}

#fuidreoilw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fuidreoilw .gt_font_normal {
  font-weight: normal;
}

#fuidreoilw .gt_font_bold {
  font-weight: bold;
}

#fuidreoilw .gt_font_italic {
  font-style: italic;
}

#fuidreoilw .gt_super {
  font-size: 65%;
}

#fuidreoilw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fuidreoilw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fuidreoilw .gt_indent_1 {
  text-indent: 5px;
}

#fuidreoilw .gt_indent_2 {
  text-indent: 10px;
}

#fuidreoilw .gt_indent_3 {
  text-indent: 15px;
}

#fuidreoilw .gt_indent_4 {
  text-indent: 20px;
}

#fuidreoilw .gt_indent_5 {
  text-indent: 25px;
}

#fuidreoilw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fuidreoilw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">300</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This divides the result set into 2 buckets based on the Amount. Rows with the highest amounts go into the first bucket, and so on.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="lag" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="lag"><span class="header-section-number">7.2.6</span> LAG</h3>
<p><code>LAG()</code> is a function that allows users to access data from a previous row within the same result set. It is particularly useful for performing comparisons between the current row and its preceding rows.</p>
<section id="basic-syntax" class="level4" data-number="7.2.6.1">
<h4 data-number="7.2.6.1" class="anchored" data-anchor-id="basic-syntax"><span class="header-section-number">7.2.6.1</span> Basic syntax</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LAG</span>(expression [, offset [, default_value]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><p><strong>expression:</strong> This is the column or expression from which you want to retrieve the value from a previous row.</p></li>
<li><p><strong>offset:</strong> This optional parameter specifies how many rows back to look. The default value is 1 if not specified.</p></li>
<li><p><strong>default_value:</strong> This optional parameter defines what value to return if there is no previous row available (e.g., when looking back beyond the first row). If omitted, NULL will be returned.</p></li>
</ul>
</section>
<section id="quick-illustration-3" class="level4" data-number="7.2.6.2">
<h4 data-number="7.2.6.2" class="anchored" data-anchor-id="quick-illustration-3"><span class="header-section-number">7.2.6.2</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-25-1"><a href="#annotated-cell-25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-25-2"><a href="#annotated-cell-25-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>,</span>
<span id="annotated-cell-25-3"><a href="#annotated-cell-25-3" aria-hidden="true" tabindex="-1"></a>      product,</span>
<span id="annotated-cell-25-4"><a href="#annotated-cell-25-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="1">1</button><span id="annotated-cell-25-5" class="code-annotation-target"><a href="#annotated-cell-25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="annotated-cell-25-6"><a href="#annotated-cell-25-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="5" data-code-annotation="1">retrieve the value from the previous row in the amount column.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="qulzfyqusv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qulzfyqusv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qulzfyqusv thead, #qulzfyqusv tbody, #qulzfyqusv tfoot, #qulzfyqusv tr, #qulzfyqusv td, #qulzfyqusv th {
  border-style: none;
}

#qulzfyqusv p {
  margin: 0;
  padding: 0;
}

#qulzfyqusv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qulzfyqusv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qulzfyqusv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qulzfyqusv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qulzfyqusv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qulzfyqusv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qulzfyqusv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qulzfyqusv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qulzfyqusv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qulzfyqusv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qulzfyqusv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qulzfyqusv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qulzfyqusv .gt_spanner_row {
  border-bottom-style: hidden;
}

#qulzfyqusv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qulzfyqusv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qulzfyqusv .gt_from_md > :first-child {
  margin-top: 0;
}

#qulzfyqusv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qulzfyqusv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qulzfyqusv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qulzfyqusv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qulzfyqusv .gt_row_group_first td {
  border-top-width: 2px;
}

#qulzfyqusv .gt_row_group_first th {
  border-top-width: 2px;
}

#qulzfyqusv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qulzfyqusv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qulzfyqusv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qulzfyqusv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qulzfyqusv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qulzfyqusv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qulzfyqusv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qulzfyqusv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qulzfyqusv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qulzfyqusv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qulzfyqusv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qulzfyqusv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qulzfyqusv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qulzfyqusv .gt_left {
  text-align: left;
}

#qulzfyqusv .gt_center {
  text-align: center;
}

#qulzfyqusv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qulzfyqusv .gt_font_normal {
  font-weight: normal;
}

#qulzfyqusv .gt_font_bold {
  font-weight: bold;
}

#qulzfyqusv .gt_font_italic {
  font-style: italic;
}

#qulzfyqusv .gt_super {
  font-size: 65%;
}

#qulzfyqusv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qulzfyqusv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qulzfyqusv .gt_indent_1 {
  text-indent: 5px;
}

#qulzfyqusv .gt_indent_2 {
  text-indent: 10px;
}

#qulzfyqusv .gt_indent_3 {
  text-indent: 15px;
}

#qulzfyqusv .gt_indent_4 {
  text-indent: 20px;
}

#qulzfyqusv .gt_indent_5 {
  text-indent: 25px;
}

#qulzfyqusv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qulzfyqusv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">100</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #CD69C9; font-size: 20; font-weight: bolder;">0</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">120</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">100</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">20</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">120</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">80</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">20</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">70</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">80</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center">30</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">70</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong> Get the previous row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="gktgpoaonh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gktgpoaonh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gktgpoaonh thead, #gktgpoaonh tbody, #gktgpoaonh tfoot, #gktgpoaonh tr, #gktgpoaonh td, #gktgpoaonh th {
  border-style: none;
}

#gktgpoaonh p {
  margin: 0;
  padding: 0;
}

#gktgpoaonh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gktgpoaonh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gktgpoaonh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gktgpoaonh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gktgpoaonh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gktgpoaonh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gktgpoaonh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gktgpoaonh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gktgpoaonh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gktgpoaonh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gktgpoaonh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gktgpoaonh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gktgpoaonh .gt_spanner_row {
  border-bottom-style: hidden;
}

#gktgpoaonh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gktgpoaonh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gktgpoaonh .gt_from_md > :first-child {
  margin-top: 0;
}

#gktgpoaonh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gktgpoaonh .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gktgpoaonh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#gktgpoaonh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gktgpoaonh .gt_row_group_first td {
  border-top-width: 2px;
}

#gktgpoaonh .gt_row_group_first th {
  border-top-width: 2px;
}

#gktgpoaonh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgpoaonh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gktgpoaonh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gktgpoaonh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gktgpoaonh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgpoaonh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gktgpoaonh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gktgpoaonh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gktgpoaonh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gktgpoaonh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gktgpoaonh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgpoaonh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gktgpoaonh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gktgpoaonh .gt_left {
  text-align: left;
}

#gktgpoaonh .gt_center {
  text-align: center;
}

#gktgpoaonh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gktgpoaonh .gt_font_normal {
  font-weight: normal;
}

#gktgpoaonh .gt_font_bold {
  font-weight: bold;
}

#gktgpoaonh .gt_font_italic {
  font-style: italic;
}

#gktgpoaonh .gt_super {
  font-size: 65%;
}

#gktgpoaonh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gktgpoaonh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gktgpoaonh .gt_indent_1 {
  text-indent: 5px;
}

#gktgpoaonh .gt_indent_2 {
  text-indent: 10px;
}

#gktgpoaonh .gt_indent_3 {
  text-indent: 15px;
}

#gktgpoaonh .gt_indent_4 {
  text-indent: 20px;
}

#gktgpoaonh .gt_indent_5 {
  text-indent: 25px;
}

#gktgpoaonh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gktgpoaonh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="partition-by-store_id" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ejtsghitvo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ejtsghitvo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ejtsghitvo thead, #ejtsghitvo tbody, #ejtsghitvo tfoot, #ejtsghitvo tr, #ejtsghitvo td, #ejtsghitvo th {
  border-style: none;
}

#ejtsghitvo p {
  margin: 0;
  padding: 0;
}

#ejtsghitvo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ejtsghitvo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ejtsghitvo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ejtsghitvo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ejtsghitvo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ejtsghitvo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejtsghitvo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ejtsghitvo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ejtsghitvo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ejtsghitvo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ejtsghitvo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ejtsghitvo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ejtsghitvo .gt_spanner_row {
  border-bottom-style: hidden;
}

#ejtsghitvo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ejtsghitvo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ejtsghitvo .gt_from_md > :first-child {
  margin-top: 0;
}

#ejtsghitvo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ejtsghitvo .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ejtsghitvo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#ejtsghitvo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ejtsghitvo .gt_row_group_first td {
  border-top-width: 2px;
}

#ejtsghitvo .gt_row_group_first th {
  border-top-width: 2px;
}

#ejtsghitvo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtsghitvo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ejtsghitvo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ejtsghitvo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejtsghitvo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtsghitvo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ejtsghitvo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ejtsghitvo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ejtsghitvo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ejtsghitvo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ejtsghitvo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtsghitvo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ejtsghitvo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ejtsghitvo .gt_left {
  text-align: left;
}

#ejtsghitvo .gt_center {
  text-align: center;
}

#ejtsghitvo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ejtsghitvo .gt_font_normal {
  font-weight: normal;
}

#ejtsghitvo .gt_font_bold {
  font-weight: bold;
}

#ejtsghitvo .gt_font_italic {
  font-style: italic;
}

#ejtsghitvo .gt_super {
  font-size: 65%;
}

#ejtsghitvo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ejtsghitvo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ejtsghitvo .gt_indent_1 {
  text-indent: 5px;
}

#ejtsghitvo .gt_indent_2 {
  text-indent: 10px;
}

#ejtsghitvo .gt_indent_3 {
  text-indent: 15px;
}

#ejtsghitvo .gt_indent_4 {
  text-indent: 20px;
}

#ejtsghitvo .gt_indent_5 {
  text-indent: 25px;
}

#ejtsghitvo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ejtsghitvo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="lead" class="level3" data-number="7.2.7">
<h3 data-number="7.2.7" class="anchored" data-anchor-id="lead"><span class="header-section-number">7.2.7</span> LEAD</h3>
<p>The <code>LEAD()</code> function allows users to access data from subsequent rows in a result set. It is particularly useful for comparing values between the current row and one or more following rows.</p>
<section id="basic-syntax-1" class="level4" data-number="7.2.7.1">
<h4 data-number="7.2.7.1" class="anchored" data-anchor-id="basic-syntax-1"><span class="header-section-number">7.2.7.1</span> Basic syntax</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LEAD</span>(expression [, offset [, default_value]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><p><strong>expression:</strong> This is the column or expression whose value you want to retrieve from the following row.</p></li>
<li><p><strong>offset:</strong> This optional parameter specifies how many rows forward from the current row you want to look. If not specified, it defaults to 1.</p></li>
<li><p><strong>default_value:</strong> This optional parameter defines what value should be returned if there is no following row available (e.g., at the end of a dataset). By default, this is NULL.</p></li>
</ul>
</section>
<section id="quick-illustration-4" class="level4" data-number="7.2.7.2">
<h4 data-number="7.2.7.2" class="anchored" data-anchor-id="quick-illustration-4"><span class="header-section-number">7.2.7.2</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-29"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-29-1"><a href="#annotated-cell-29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-29-2"><a href="#annotated-cell-29-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>,</span>
<span id="annotated-cell-29-3"><a href="#annotated-cell-29-3" aria-hidden="true" tabindex="-1"></a>      product,</span>
<span id="annotated-cell-29-4"><a href="#annotated-cell-29-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="1">1</button><span id="annotated-cell-29-5" class="code-annotation-target"><a href="#annotated-cell-29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount) <span class="kw">AS</span> next_amount</span>
<span id="annotated-cell-29-6"><a href="#annotated-cell-29-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="5" data-code-annotation="1">retrieve the value from the next row in the amount column.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ydftfwkqgb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ydftfwkqgb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ydftfwkqgb thead, #ydftfwkqgb tbody, #ydftfwkqgb tfoot, #ydftfwkqgb tr, #ydftfwkqgb td, #ydftfwkqgb th {
  border-style: none;
}

#ydftfwkqgb p {
  margin: 0;
  padding: 0;
}

#ydftfwkqgb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ydftfwkqgb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ydftfwkqgb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ydftfwkqgb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ydftfwkqgb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ydftfwkqgb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydftfwkqgb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ydftfwkqgb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ydftfwkqgb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ydftfwkqgb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ydftfwkqgb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ydftfwkqgb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ydftfwkqgb .gt_spanner_row {
  border-bottom-style: hidden;
}

#ydftfwkqgb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ydftfwkqgb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ydftfwkqgb .gt_from_md > :first-child {
  margin-top: 0;
}

#ydftfwkqgb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ydftfwkqgb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ydftfwkqgb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ydftfwkqgb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ydftfwkqgb .gt_row_group_first td {
  border-top-width: 2px;
}

#ydftfwkqgb .gt_row_group_first th {
  border-top-width: 2px;
}

#ydftfwkqgb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydftfwkqgb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ydftfwkqgb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ydftfwkqgb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydftfwkqgb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydftfwkqgb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ydftfwkqgb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ydftfwkqgb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ydftfwkqgb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ydftfwkqgb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ydftfwkqgb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydftfwkqgb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ydftfwkqgb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ydftfwkqgb .gt_left {
  text-align: left;
}

#ydftfwkqgb .gt_center {
  text-align: center;
}

#ydftfwkqgb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ydftfwkqgb .gt_font_normal {
  font-weight: normal;
}

#ydftfwkqgb .gt_font_bold {
  font-weight: bold;
}

#ydftfwkqgb .gt_font_italic {
  font-style: italic;
}

#ydftfwkqgb .gt_super {
  font-size: 65%;
}

#ydftfwkqgb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ydftfwkqgb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ydftfwkqgb .gt_indent_1 {
  text-indent: 5px;
}

#ydftfwkqgb .gt_indent_2 {
  text-indent: 10px;
}

#ydftfwkqgb .gt_indent_3 {
  text-indent: 15px;
}

#ydftfwkqgb .gt_indent_4 {
  text-indent: 20px;
}

#ydftfwkqgb .gt_indent_5 {
  text-indent: 25px;
}

#ydftfwkqgb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ydftfwkqgb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="next_amount">next_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center">100</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">120</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">120</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">20</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">20</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">80</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">80</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">70</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">70</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">30</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">30</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #CD69C9; font-size: 20; font-weight: bolder;">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong> Get the next row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ovpyifkylj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ovpyifkylj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ovpyifkylj thead, #ovpyifkylj tbody, #ovpyifkylj tfoot, #ovpyifkylj tr, #ovpyifkylj td, #ovpyifkylj th {
  border-style: none;
}

#ovpyifkylj p {
  margin: 0;
  padding: 0;
}

#ovpyifkylj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ovpyifkylj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ovpyifkylj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ovpyifkylj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ovpyifkylj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ovpyifkylj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ovpyifkylj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ovpyifkylj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ovpyifkylj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ovpyifkylj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ovpyifkylj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ovpyifkylj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ovpyifkylj .gt_spanner_row {
  border-bottom-style: hidden;
}

#ovpyifkylj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ovpyifkylj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ovpyifkylj .gt_from_md > :first-child {
  margin-top: 0;
}

#ovpyifkylj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ovpyifkylj .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ovpyifkylj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#ovpyifkylj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ovpyifkylj .gt_row_group_first td {
  border-top-width: 2px;
}

#ovpyifkylj .gt_row_group_first th {
  border-top-width: 2px;
}

#ovpyifkylj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovpyifkylj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ovpyifkylj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ovpyifkylj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ovpyifkylj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovpyifkylj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ovpyifkylj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ovpyifkylj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ovpyifkylj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ovpyifkylj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ovpyifkylj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovpyifkylj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ovpyifkylj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovpyifkylj .gt_left {
  text-align: left;
}

#ovpyifkylj .gt_center {
  text-align: center;
}

#ovpyifkylj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ovpyifkylj .gt_font_normal {
  font-weight: normal;
}

#ovpyifkylj .gt_font_bold {
  font-weight: bold;
}

#ovpyifkylj .gt_font_italic {
  font-style: italic;
}

#ovpyifkylj .gt_super {
  font-size: 65%;
}

#ovpyifkylj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ovpyifkylj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ovpyifkylj .gt_indent_1 {
  text-indent: 5px;
}

#ovpyifkylj .gt_indent_2 {
  text-indent: 10px;
}

#ovpyifkylj .gt_indent_3 {
  text-indent: 15px;
}

#ovpyifkylj .gt_indent_4 {
  text-indent: 20px;
}

#ovpyifkylj .gt_indent_5 {
  text-indent: 25px;
}

#ovpyifkylj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ovpyifkylj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="partition-by-store_id-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id-1">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="nsmbmjlqyq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nsmbmjlqyq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nsmbmjlqyq thead, #nsmbmjlqyq tbody, #nsmbmjlqyq tfoot, #nsmbmjlqyq tr, #nsmbmjlqyq td, #nsmbmjlqyq th {
  border-style: none;
}

#nsmbmjlqyq p {
  margin: 0;
  padding: 0;
}

#nsmbmjlqyq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nsmbmjlqyq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nsmbmjlqyq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nsmbmjlqyq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nsmbmjlqyq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nsmbmjlqyq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nsmbmjlqyq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nsmbmjlqyq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nsmbmjlqyq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nsmbmjlqyq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nsmbmjlqyq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nsmbmjlqyq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nsmbmjlqyq .gt_spanner_row {
  border-bottom-style: hidden;
}

#nsmbmjlqyq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nsmbmjlqyq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nsmbmjlqyq .gt_from_md > :first-child {
  margin-top: 0;
}

#nsmbmjlqyq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nsmbmjlqyq .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nsmbmjlqyq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#nsmbmjlqyq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nsmbmjlqyq .gt_row_group_first td {
  border-top-width: 2px;
}

#nsmbmjlqyq .gt_row_group_first th {
  border-top-width: 2px;
}

#nsmbmjlqyq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nsmbmjlqyq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nsmbmjlqyq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nsmbmjlqyq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nsmbmjlqyq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nsmbmjlqyq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nsmbmjlqyq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nsmbmjlqyq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nsmbmjlqyq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nsmbmjlqyq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nsmbmjlqyq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nsmbmjlqyq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nsmbmjlqyq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nsmbmjlqyq .gt_left {
  text-align: left;
}

#nsmbmjlqyq .gt_center {
  text-align: center;
}

#nsmbmjlqyq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nsmbmjlqyq .gt_font_normal {
  font-weight: normal;
}

#nsmbmjlqyq .gt_font_bold {
  font-weight: bold;
}

#nsmbmjlqyq .gt_font_italic {
  font-style: italic;
}

#nsmbmjlqyq .gt_super {
  font-size: 65%;
}

#nsmbmjlqyq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nsmbmjlqyq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nsmbmjlqyq .gt_indent_1 {
  text-indent: 5px;
}

#nsmbmjlqyq .gt_indent_2 {
  text-indent: 10px;
}

#nsmbmjlqyq .gt_indent_3 {
  text-indent: 15px;
}

#nsmbmjlqyq .gt_indent_4 {
  text-indent: 20px;
}

#nsmbmjlqyq .gt_indent_5 {
  text-indent: 25px;
}

#nsmbmjlqyq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nsmbmjlqyq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="combining-multiple-window-functions" class="level3" data-number="7.2.8">
<h3 data-number="7.2.8" class="anchored" data-anchor-id="combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</h3>
<p>You can combine multiple window functions in a single query.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> row_num,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> total_amount,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>This query assigns a row number, calculates the total amount per store, and retrieves the previous amount for each sale.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>FRAME</code> Clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AVG</span>(sale) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2 <span class="kw">ORDER</span> <span class="kw">BY</span> col_name3 <span class="kw">ROWS</span> <span class="kw">BETWEEN</span> <span class="kw">CURRENT</span> <span class="kw">ROW</span> <span class="kw">AND</span> <span class="kw">UNBOUNDED</span> <span class="kw">PRECEDING</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><strong>ROWS:</strong> The frame type. values such as ROWS or RANGE</li>
<li><strong>CURRENT ROW:</strong> The frame boundary (Lower value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING</li>
<li><strong>UNBOUNDED PRECEDING:</strong> The frame Boundary (Higher value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING.</li>
</ul>
<p><br></p>
<p><strong>Rules:</strong> - You can only use the Frame clause with Order by clause.</p>
<ul>
<li>The lower value should be placed before the higher value.</li>
</ul>
</div>
</div>
</div>
<p><br> <br> <br></p>
<!------- Window Function -------------------------------------------------->
</section>
</section>
<section id="task" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="task"><span class="header-section-number">7.3</span> Task</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./sql_data_cleaning.html" class="pagination-link" aria-label="Data Cleaning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sql_join.html" class="pagination-link" aria-label="Joins">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>