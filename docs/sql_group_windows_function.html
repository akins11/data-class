<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Grouping Data – Data Analysis Tools</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sql_join.html" rel="next">
<link href="./sql_data_cleaning.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Analysis Tools</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sql_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_creating_database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Creating Database</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_statement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Query Statement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_text_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with Text</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_date_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with Date</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_group_windows_function.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_join.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_sub_queries_cte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subquery &amp; CTE</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Project</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_operators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_exploratory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">EDA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Project Concept</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./python_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./powerbi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power BI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./powerbi_data_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool_source.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Data Tool Referenece</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#group-by" id="toc-group-by" class="nav-link active" data-scroll-target="#group-by"><span class="header-section-number">7.1</span> GROUP BY</a>
  <ul class="collapse">
  <li><a href="#quick-illustration-of-group-by" id="toc-quick-illustration-of-group-by" class="nav-link" data-scroll-target="#quick-illustration-of-group-by">Quick illustration of GROUP BY:</a></li>
  <li><a href="#simple-group-by-with-count" id="toc-simple-group-by-with-count" class="nav-link" data-scroll-target="#simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></a></li>
  <li><a href="#group-by-with-multiple-columns" id="toc-group-by-with-multiple-columns" class="nav-link" data-scroll-target="#group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</a></li>
  <li><a href="#using-aggregate-functions" id="toc-using-aggregate-functions" class="nav-link" data-scroll-target="#using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</a></li>
  <li><a href="#having-clause-with-group-by" id="toc-having-clause-with-group-by" class="nav-link" data-scroll-target="#having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</a></li>
  <li><a href="#group-by-with-date" id="toc-group-by-with-date" class="nav-link" data-scroll-target="#group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></a></li>
  <li><a href="#group-by-with-expressions" id="toc-group-by-with-expressions" class="nav-link" data-scroll-target="#group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</a></li>
  <li><a href="#group-by-with-order-by" id="toc-group-by-with-order-by" class="nav-link" data-scroll-target="#group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></a></li>
  <li><a href="#grouping-with-a-conditional-aggregate" id="toc-grouping-with-a-conditional-aggregate" class="nav-link" data-scroll-target="#grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</a></li>
  </ul></li>
  <li><a href="#window-function" id="toc-window-function" class="nav-link" data-scroll-target="#window-function"><span class="header-section-number">7.2</span> Window Function</a>
  <ul class="collapse">
  <li><a href="#row_number" id="toc-row_number" class="nav-link" data-scroll-target="#row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</a></li>
  <li><a href="#quick-illustration-of-window-function" id="toc-quick-illustration-of-window-function" class="nav-link" data-scroll-target="#quick-illustration-of-window-function">Quick illustration of window function</a></li>
  <li><a href="#aggregate-function-sum-as-a-window-function" id="toc-aggregate-function-sum-as-a-window-function" class="nav-link" data-scroll-target="#aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</a></li>
  <li><a href="#rank" id="toc-rank" class="nav-link" data-scroll-target="#rank"><span class="header-section-number">7.2.3</span> RANK</a></li>
  <li><a href="#dense_rank" id="toc-dense_rank" class="nav-link" data-scroll-target="#dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</a></li>
  <li><a href="#ntile" id="toc-ntile" class="nav-link" data-scroll-target="#ntile"><span class="header-section-number">7.2.5</span> NTILE</a></li>
  <li><a href="#lag" id="toc-lag" class="nav-link" data-scroll-target="#lag"><span class="header-section-number">7.2.6</span> LAG</a></li>
  <li><a href="#lead" id="toc-lead" class="nav-link" data-scroll-target="#lead"><span class="header-section-number">7.2.7</span> LEAD</a></li>
  <li><a href="#combining-multiple-window-functions" id="toc-combining-multiple-window-functions" class="nav-link" data-scroll-target="#combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</a></li>
  </ul></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task"><span class="header-section-number">7.3</span> Task</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="group-by" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="group-by"><span class="header-section-number">7.1</span> GROUP BY</h2>
<p>The <code>GROUP BY</code> clause is used to arrange identical data into groups. It is often used with aggregate functions such as <code>COUNT()</code>, <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code>, and <code>MIN()</code> to perform operations on each group of data.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Basic Syntax</span></span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name1, aggregate_function(column_column2)</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-5" class="code-annotation-target"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> column_name1;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3" data-code-annotation="1">aggregate_function like <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code> etc.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="5" data-code-annotation="2">The name of the column to group the table by.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts of the <code>GROUP BY</code> clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>The <code>GROUP BY</code> clause groups rows that have the same values in specified columns into summary rows.</p></li>
<li><p>Functions such as <code>COUNT</code>, <code>SUM</code>, <code>AVG</code>, <code>MAX</code>, and <code>MIN</code> are commonly used with <code>GROUP BY</code> <strong>to perform calculations on each group</strong>.</p></li>
<li><p>The <code>HAVING</code> clause is used to filter groups based on conditions, similar to how <code>WHERE</code> filters rows.</p></li>
</ul>
</div>
</div>
</div>
<section id="example-table-sales" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-table-sales">Example Table: Sales</h4>
<div class="cell">
<div class="cell-output-display">
<div id="xjszwsxrpj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xjszwsxrpj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xjszwsxrpj thead, #xjszwsxrpj tbody, #xjszwsxrpj tfoot, #xjszwsxrpj tr, #xjszwsxrpj td, #xjszwsxrpj th {
  border-style: none;
}

#xjszwsxrpj p {
  margin: 0;
  padding: 0;
}

#xjszwsxrpj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xjszwsxrpj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xjszwsxrpj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xjszwsxrpj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xjszwsxrpj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xjszwsxrpj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xjszwsxrpj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xjszwsxrpj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xjszwsxrpj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xjszwsxrpj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xjszwsxrpj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xjszwsxrpj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xjszwsxrpj .gt_spanner_row {
  border-bottom-style: hidden;
}

#xjszwsxrpj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xjszwsxrpj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xjszwsxrpj .gt_from_md > :first-child {
  margin-top: 0;
}

#xjszwsxrpj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xjszwsxrpj .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xjszwsxrpj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#xjszwsxrpj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xjszwsxrpj .gt_row_group_first td {
  border-top-width: 2px;
}

#xjszwsxrpj .gt_row_group_first th {
  border-top-width: 2px;
}

#xjszwsxrpj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjszwsxrpj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xjszwsxrpj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xjszwsxrpj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xjszwsxrpj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjszwsxrpj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xjszwsxrpj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xjszwsxrpj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xjszwsxrpj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xjszwsxrpj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xjszwsxrpj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjszwsxrpj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xjszwsxrpj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xjszwsxrpj .gt_left {
  text-align: left;
}

#xjszwsxrpj .gt_center {
  text-align: center;
}

#xjszwsxrpj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xjszwsxrpj .gt_font_normal {
  font-weight: normal;
}

#xjszwsxrpj .gt_font_bold {
  font-weight: bold;
}

#xjszwsxrpj .gt_font_italic {
  font-style: italic;
}

#xjszwsxrpj .gt_super {
  font-size: 65%;
}

#xjszwsxrpj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xjszwsxrpj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xjszwsxrpj .gt_indent_1 {
  text-indent: 5px;
}

#xjszwsxrpj .gt_indent_2 {
  text-indent: 10px;
}

#xjszwsxrpj .gt_indent_3 {
  text-indent: 15px;
}

#xjszwsxrpj .gt_indent_4 {
  text-indent: 20px;
}

#xjszwsxrpj .gt_indent_5 {
  text-indent: 25px;
}

#xjszwsxrpj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xjszwsxrpj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="quick-illustration-of-group-by" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-group-by">Quick illustration of GROUP BY:</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To get the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-2" class="code-annotation-target"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="pcclnyczam" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pcclnyczam table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pcclnyczam thead, #pcclnyczam tbody, #pcclnyczam tfoot, #pcclnyczam tr, #pcclnyczam td, #pcclnyczam th {
  border-style: none;
}

#pcclnyczam p {
  margin: 0;
  padding: 0;
}

#pcclnyczam .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pcclnyczam .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pcclnyczam .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pcclnyczam .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pcclnyczam .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pcclnyczam .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pcclnyczam .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pcclnyczam .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pcclnyczam .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pcclnyczam .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pcclnyczam .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pcclnyczam .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pcclnyczam .gt_spanner_row {
  border-bottom-style: hidden;
}

#pcclnyczam .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pcclnyczam .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pcclnyczam .gt_from_md > :first-child {
  margin-top: 0;
}

#pcclnyczam .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pcclnyczam .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pcclnyczam .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pcclnyczam .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pcclnyczam .gt_row_group_first td {
  border-top-width: 2px;
}

#pcclnyczam .gt_row_group_first th {
  border-top-width: 2px;
}

#pcclnyczam .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcclnyczam .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pcclnyczam .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pcclnyczam .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pcclnyczam .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcclnyczam .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pcclnyczam .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pcclnyczam .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pcclnyczam .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pcclnyczam .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pcclnyczam .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcclnyczam .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pcclnyczam .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pcclnyczam .gt_left {
  text-align: left;
}

#pcclnyczam .gt_center {
  text-align: center;
}

#pcclnyczam .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pcclnyczam .gt_font_normal {
  font-weight: normal;
}

#pcclnyczam .gt_font_bold {
  font-weight: bold;
}

#pcclnyczam .gt_font_italic {
  font-style: italic;
}

#pcclnyczam .gt_super {
  font-size: 65%;
}

#pcclnyczam .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pcclnyczam .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pcclnyczam .gt_indent_1 {
  text-indent: 5px;
}

#pcclnyczam .gt_indent_2 {
  text-indent: 10px;
}

#pcclnyczam .gt_indent_3 {
  text-indent: 15px;
}

#pcclnyczam .gt_indent_4 {
  text-indent: 20px;
}

#pcclnyczam .gt_indent_5 {
  text-indent: 25px;
}

#pcclnyczam .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pcclnyczam div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Full Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="ratjiuwbjm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ratjiuwbjm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ratjiuwbjm thead, #ratjiuwbjm tbody, #ratjiuwbjm tfoot, #ratjiuwbjm tr, #ratjiuwbjm td, #ratjiuwbjm th {
  border-style: none;
}

#ratjiuwbjm p {
  margin: 0;
  padding: 0;
}

#ratjiuwbjm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ratjiuwbjm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ratjiuwbjm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ratjiuwbjm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ratjiuwbjm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ratjiuwbjm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ratjiuwbjm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ratjiuwbjm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ratjiuwbjm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ratjiuwbjm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ratjiuwbjm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ratjiuwbjm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ratjiuwbjm .gt_spanner_row {
  border-bottom-style: hidden;
}

#ratjiuwbjm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ratjiuwbjm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ratjiuwbjm .gt_from_md > :first-child {
  margin-top: 0;
}

#ratjiuwbjm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ratjiuwbjm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ratjiuwbjm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ratjiuwbjm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ratjiuwbjm .gt_row_group_first td {
  border-top-width: 2px;
}

#ratjiuwbjm .gt_row_group_first th {
  border-top-width: 2px;
}

#ratjiuwbjm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ratjiuwbjm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ratjiuwbjm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ratjiuwbjm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ratjiuwbjm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ratjiuwbjm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ratjiuwbjm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ratjiuwbjm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ratjiuwbjm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ratjiuwbjm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ratjiuwbjm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ratjiuwbjm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ratjiuwbjm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ratjiuwbjm .gt_left {
  text-align: left;
}

#ratjiuwbjm .gt_center {
  text-align: center;
}

#ratjiuwbjm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ratjiuwbjm .gt_font_normal {
  font-weight: normal;
}

#ratjiuwbjm .gt_font_bold {
  font-weight: bold;
}

#ratjiuwbjm .gt_font_italic {
  font-style: italic;
}

#ratjiuwbjm .gt_super {
  font-size: 65%;
}

#ratjiuwbjm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ratjiuwbjm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ratjiuwbjm .gt_indent_1 {
  text-indent: 5px;
}

#ratjiuwbjm .gt_indent_2 {
  text-indent: 10px;
}

#ratjiuwbjm .gt_indent_3 {
  text-indent: 15px;
}

#ratjiuwbjm .gt_indent_4 {
  text-indent: 20px;
}

#ratjiuwbjm .gt_indent_5 {
  text-indent: 25px;
}

#ratjiuwbjm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ratjiuwbjm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Grouped Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="simple-group-by-with-count" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To count the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-2" class="code-annotation-target"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="xcnspicivw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xcnspicivw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xcnspicivw thead, #xcnspicivw tbody, #xcnspicivw tfoot, #xcnspicivw tr, #xcnspicivw td, #xcnspicivw th {
  border-style: none;
}

#xcnspicivw p {
  margin: 0;
  padding: 0;
}

#xcnspicivw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xcnspicivw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xcnspicivw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xcnspicivw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xcnspicivw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xcnspicivw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xcnspicivw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xcnspicivw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xcnspicivw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xcnspicivw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xcnspicivw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xcnspicivw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xcnspicivw .gt_spanner_row {
  border-bottom-style: hidden;
}

#xcnspicivw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xcnspicivw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xcnspicivw .gt_from_md > :first-child {
  margin-top: 0;
}

#xcnspicivw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xcnspicivw .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xcnspicivw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#xcnspicivw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xcnspicivw .gt_row_group_first td {
  border-top-width: 2px;
}

#xcnspicivw .gt_row_group_first th {
  border-top-width: 2px;
}

#xcnspicivw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xcnspicivw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xcnspicivw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xcnspicivw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xcnspicivw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xcnspicivw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xcnspicivw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xcnspicivw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xcnspicivw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xcnspicivw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xcnspicivw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xcnspicivw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xcnspicivw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xcnspicivw .gt_left {
  text-align: left;
}

#xcnspicivw .gt_center {
  text-align: center;
}

#xcnspicivw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xcnspicivw .gt_font_normal {
  font-weight: normal;
}

#xcnspicivw .gt_font_bold {
  font-weight: bold;
}

#xcnspicivw .gt_font_italic {
  font-style: italic;
}

#xcnspicivw .gt_super {
  font-size: 65%;
}

#xcnspicivw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xcnspicivw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xcnspicivw .gt_indent_1 {
  text-indent: 5px;
}

#xcnspicivw .gt_indent_2 {
  text-indent: 10px;
}

#xcnspicivw .gt_indent_3 {
  text-indent: 15px;
}

#xcnspicivw .gt_indent_4 {
  text-indent: 20px;
}

#xcnspicivw .gt_indent_5 {
  text-indent: 25px;
}

#xcnspicivw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xcnspicivw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_number_of_sales" class="gt_row gt_center">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_number_of_sales" class="gt_row gt_center">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="group-by-with-multiple-columns" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</h3>
<p>Grouping by multiple columns can give more <em>granular summaries</em>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- count the number of sales per store and product:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, product_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id, product_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store and product id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ouzlmmuduu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ouzlmmuduu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ouzlmmuduu thead, #ouzlmmuduu tbody, #ouzlmmuduu tfoot, #ouzlmmuduu tr, #ouzlmmuduu td, #ouzlmmuduu th {
  border-style: none;
}

#ouzlmmuduu p {
  margin: 0;
  padding: 0;
}

#ouzlmmuduu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ouzlmmuduu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ouzlmmuduu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ouzlmmuduu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ouzlmmuduu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ouzlmmuduu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ouzlmmuduu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ouzlmmuduu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ouzlmmuduu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ouzlmmuduu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ouzlmmuduu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ouzlmmuduu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ouzlmmuduu .gt_spanner_row {
  border-bottom-style: hidden;
}

#ouzlmmuduu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ouzlmmuduu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ouzlmmuduu .gt_from_md > :first-child {
  margin-top: 0;
}

#ouzlmmuduu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ouzlmmuduu .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ouzlmmuduu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#ouzlmmuduu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ouzlmmuduu .gt_row_group_first td {
  border-top-width: 2px;
}

#ouzlmmuduu .gt_row_group_first th {
  border-top-width: 2px;
}

#ouzlmmuduu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ouzlmmuduu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ouzlmmuduu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ouzlmmuduu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ouzlmmuduu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ouzlmmuduu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ouzlmmuduu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ouzlmmuduu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ouzlmmuduu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ouzlmmuduu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ouzlmmuduu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ouzlmmuduu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ouzlmmuduu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ouzlmmuduu .gt_left {
  text-align: left;
}

#ouzlmmuduu .gt_center {
  text-align: center;
}

#ouzlmmuduu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ouzlmmuduu .gt_font_normal {
  font-weight: normal;
}

#ouzlmmuduu .gt_font_bold {
  font-weight: bold;
}

#ouzlmmuduu .gt_font_italic {
  font-style: italic;
}

#ouzlmmuduu .gt_super {
  font-size: 65%;
}

#ouzlmmuduu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ouzlmmuduu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ouzlmmuduu .gt_indent_1 {
  text-indent: 5px;
}

#ouzlmmuduu .gt_indent_2 {
  text-indent: 10px;
}

#ouzlmmuduu .gt_indent_3 {
  text-indent: 15px;
}

#ouzlmmuduu .gt_indent_4 {
  text-indent: 20px;
}

#ouzlmmuduu .gt_indent_5 {
  text-indent: 25px;
}

#ouzlmmuduu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ouzlmmuduu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="using-aggregate-functions" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Calculate the average amount of sales per store:</span></span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, </span>
<span id="annotated-cell-5-3"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(amount) <span class="kw">AS</span> <span class="fu">count</span>,</span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MIN</span>(amount) <span class="kw">AS</span>, lowest_amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1">1</button><span id="annotated-cell-5-5" class="code-annotation-target"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(amount) <span class="kw">AS</span> average_amount,</span>
<span id="annotated-cell-5-6"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MAX</span>(amount) <span class="kw">AS</span> highest_amount,</span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_anount</span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2">2</button><span id="annotated-cell-5-9" class="code-annotation-target"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="5" data-code-annotation="1">Get the average of all the amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="9" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="wbqdcsmldl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wbqdcsmldl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wbqdcsmldl thead, #wbqdcsmldl tbody, #wbqdcsmldl tfoot, #wbqdcsmldl tr, #wbqdcsmldl td, #wbqdcsmldl th {
  border-style: none;
}

#wbqdcsmldl p {
  margin: 0;
  padding: 0;
}

#wbqdcsmldl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wbqdcsmldl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wbqdcsmldl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wbqdcsmldl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wbqdcsmldl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wbqdcsmldl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wbqdcsmldl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wbqdcsmldl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wbqdcsmldl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wbqdcsmldl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wbqdcsmldl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wbqdcsmldl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wbqdcsmldl .gt_spanner_row {
  border-bottom-style: hidden;
}

#wbqdcsmldl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wbqdcsmldl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wbqdcsmldl .gt_from_md > :first-child {
  margin-top: 0;
}

#wbqdcsmldl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wbqdcsmldl .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wbqdcsmldl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#wbqdcsmldl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wbqdcsmldl .gt_row_group_first td {
  border-top-width: 2px;
}

#wbqdcsmldl .gt_row_group_first th {
  border-top-width: 2px;
}

#wbqdcsmldl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wbqdcsmldl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wbqdcsmldl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wbqdcsmldl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wbqdcsmldl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wbqdcsmldl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wbqdcsmldl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wbqdcsmldl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wbqdcsmldl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wbqdcsmldl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wbqdcsmldl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wbqdcsmldl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wbqdcsmldl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wbqdcsmldl .gt_left {
  text-align: left;
}

#wbqdcsmldl .gt_center {
  text-align: center;
}

#wbqdcsmldl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wbqdcsmldl .gt_font_normal {
  font-weight: normal;
}

#wbqdcsmldl .gt_font_bold {
  font-weight: bold;
}

#wbqdcsmldl .gt_font_italic {
  font-style: italic;
}

#wbqdcsmldl .gt_super {
  font-size: 65%;
}

#wbqdcsmldl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wbqdcsmldl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wbqdcsmldl .gt_indent_1 {
  text-indent: 5px;
}

#wbqdcsmldl .gt_indent_2 {
  text-indent: 10px;
}

#wbqdcsmldl .gt_indent_3 {
  text-indent: 15px;
}

#wbqdcsmldl .gt_indent_4 {
  text-indent: 20px;
}

#wbqdcsmldl .gt_indent_5 {
  text-indent: 25px;
}

#wbqdcsmldl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wbqdcsmldl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="count">count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lowest_amount">lowest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="average_amount">average_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="highest_amount">highest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="count" class="gt_row gt_right">4</td>
<td headers="lowest_amount" class="gt_row gt_right">100</td>
<td headers="average_amount" class="gt_row gt_right">225</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="count" class="gt_row gt_right">3</td>
<td headers="lowest_amount" class="gt_row gt_right">200</td>
<td headers="average_amount" class="gt_row gt_right">200</td>
<td headers="highest_amount" class="gt_row gt_right">200</td>
<td headers="total_amount" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="count" class="gt_row gt_right">5</td>
<td headers="lowest_amount" class="gt_row gt_right">150</td>
<td headers="average_amount" class="gt_row gt_right">250</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="having-clause-with-group-by" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</h3>
<p>The <code>HAVING</code> clause is used to filter groups <strong>after the aggregation</strong>.</p>
<section id="quick-illustration-of-using-having" class="level4" data-number="7.1.4.1">
<h4 data-number="7.1.4.1" class="anchored" data-anchor-id="quick-illustration-of-using-having"><span class="header-section-number">7.1.4.1</span> Quick Illustration of using HAVING</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-3" class="code-annotation-target"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span>
<span id="annotated-cell-6-4"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-6-7"><a href="#annotated-cell-6-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2">2</button><span id="annotated-cell-6-8" class="code-annotation-target"><a href="#annotated-cell-6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">600</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="3" data-code-annotation="1">Group the table using the <code>store_id</code></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="8" data-code-annotation="2">Filter only stores with <code>total_amount</code> greater than 600</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="hvrjxmkldg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hvrjxmkldg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hvrjxmkldg thead, #hvrjxmkldg tbody, #hvrjxmkldg tfoot, #hvrjxmkldg tr, #hvrjxmkldg td, #hvrjxmkldg th {
  border-style: none;
}

#hvrjxmkldg p {
  margin: 0;
  padding: 0;
}

#hvrjxmkldg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hvrjxmkldg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hvrjxmkldg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hvrjxmkldg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hvrjxmkldg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hvrjxmkldg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hvrjxmkldg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hvrjxmkldg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hvrjxmkldg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hvrjxmkldg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hvrjxmkldg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hvrjxmkldg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hvrjxmkldg .gt_spanner_row {
  border-bottom-style: hidden;
}

#hvrjxmkldg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hvrjxmkldg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hvrjxmkldg .gt_from_md > :first-child {
  margin-top: 0;
}

#hvrjxmkldg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hvrjxmkldg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hvrjxmkldg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hvrjxmkldg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hvrjxmkldg .gt_row_group_first td {
  border-top-width: 2px;
}

#hvrjxmkldg .gt_row_group_first th {
  border-top-width: 2px;
}

#hvrjxmkldg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hvrjxmkldg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hvrjxmkldg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hvrjxmkldg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hvrjxmkldg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hvrjxmkldg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hvrjxmkldg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hvrjxmkldg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hvrjxmkldg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hvrjxmkldg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hvrjxmkldg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hvrjxmkldg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hvrjxmkldg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hvrjxmkldg .gt_left {
  text-align: left;
}

#hvrjxmkldg .gt_center {
  text-align: center;
}

#hvrjxmkldg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hvrjxmkldg .gt_font_normal {
  font-weight: normal;
}

#hvrjxmkldg .gt_font_bold {
  font-weight: bold;
}

#hvrjxmkldg .gt_font_italic {
  font-style: italic;
}

#hvrjxmkldg .gt_super {
  font-size: 65%;
}

#hvrjxmkldg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hvrjxmkldg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hvrjxmkldg .gt_indent_1 {
  text-indent: 5px;
}

#hvrjxmkldg .gt_indent_2 {
  text-indent: 10px;
}

#hvrjxmkldg .gt_indent_3 {
  text-indent: 15px;
}

#hvrjxmkldg .gt_indent_4 {
  text-indent: 20px;
}

#hvrjxmkldg .gt_indent_5 {
  text-indent: 25px;
}

#hvrjxmkldg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hvrjxmkldg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Grouped Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="apfzhwrzyo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#apfzhwrzyo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#apfzhwrzyo thead, #apfzhwrzyo tbody, #apfzhwrzyo tfoot, #apfzhwrzyo tr, #apfzhwrzyo td, #apfzhwrzyo th {
  border-style: none;
}

#apfzhwrzyo p {
  margin: 0;
  padding: 0;
}

#apfzhwrzyo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#apfzhwrzyo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#apfzhwrzyo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#apfzhwrzyo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#apfzhwrzyo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#apfzhwrzyo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apfzhwrzyo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#apfzhwrzyo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#apfzhwrzyo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#apfzhwrzyo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#apfzhwrzyo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#apfzhwrzyo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#apfzhwrzyo .gt_spanner_row {
  border-bottom-style: hidden;
}

#apfzhwrzyo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#apfzhwrzyo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#apfzhwrzyo .gt_from_md > :first-child {
  margin-top: 0;
}

#apfzhwrzyo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#apfzhwrzyo .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#apfzhwrzyo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#apfzhwrzyo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#apfzhwrzyo .gt_row_group_first td {
  border-top-width: 2px;
}

#apfzhwrzyo .gt_row_group_first th {
  border-top-width: 2px;
}

#apfzhwrzyo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#apfzhwrzyo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#apfzhwrzyo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#apfzhwrzyo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apfzhwrzyo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#apfzhwrzyo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#apfzhwrzyo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#apfzhwrzyo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#apfzhwrzyo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#apfzhwrzyo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#apfzhwrzyo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#apfzhwrzyo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#apfzhwrzyo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#apfzhwrzyo .gt_left {
  text-align: left;
}

#apfzhwrzyo .gt_center {
  text-align: center;
}

#apfzhwrzyo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#apfzhwrzyo .gt_font_normal {
  font-weight: normal;
}

#apfzhwrzyo .gt_font_bold {
  font-weight: bold;
}

#apfzhwrzyo .gt_font_italic {
  font-style: italic;
}

#apfzhwrzyo .gt_super {
  font-size: 65%;
}

#apfzhwrzyo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#apfzhwrzyo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#apfzhwrzyo .gt_indent_1 {
  text-indent: 5px;
}

#apfzhwrzyo .gt_indent_2 {
  text-indent: 10px;
}

#apfzhwrzyo .gt_indent_3 {
  text-indent: 15px;
}

#apfzhwrzyo .gt_indent_4 {
  text-indent: 20px;
}

#apfzhwrzyo .gt_indent_5 {
  text-indent: 25px;
}

#apfzhwrzyo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#apfzhwrzyo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Filtered Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why HAVING when there is WHERE
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>HAVING</code> is used because <code>WHERE</code> can’t filter on aggregate functions (like <code>SUM</code>, <code>AVG</code>, <code>COUNT</code>) that are often used with grouped data.</p>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find stores with total sales greater than N300:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1">1</button><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-7-3"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3">3</button><span id="annotated-cell-7-5" class="code-annotation-target"><a href="#annotated-cell-7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">300</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="5" data-code-annotation="3">Filter all total_sales_amount greater than 300.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="kmfknyxlyo" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kmfknyxlyo table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kmfknyxlyo thead, #kmfknyxlyo tbody, #kmfknyxlyo tfoot, #kmfknyxlyo tr, #kmfknyxlyo td, #kmfknyxlyo th {
  border-style: none;
}

#kmfknyxlyo p {
  margin: 0;
  padding: 0;
}

#kmfknyxlyo .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kmfknyxlyo .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kmfknyxlyo .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kmfknyxlyo .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kmfknyxlyo .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmfknyxlyo .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmfknyxlyo .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kmfknyxlyo .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kmfknyxlyo .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kmfknyxlyo .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kmfknyxlyo .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kmfknyxlyo .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kmfknyxlyo .gt_spanner_row {
  border-bottom-style: hidden;
}

#kmfknyxlyo .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kmfknyxlyo .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kmfknyxlyo .gt_from_md > :first-child {
  margin-top: 0;
}

#kmfknyxlyo .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kmfknyxlyo .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kmfknyxlyo .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#kmfknyxlyo .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kmfknyxlyo .gt_row_group_first td {
  border-top-width: 2px;
}

#kmfknyxlyo .gt_row_group_first th {
  border-top-width: 2px;
}

#kmfknyxlyo .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmfknyxlyo .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kmfknyxlyo .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kmfknyxlyo .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmfknyxlyo .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmfknyxlyo .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kmfknyxlyo .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kmfknyxlyo .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kmfknyxlyo .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kmfknyxlyo .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmfknyxlyo .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmfknyxlyo .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kmfknyxlyo .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kmfknyxlyo .gt_left {
  text-align: left;
}

#kmfknyxlyo .gt_center {
  text-align: center;
}

#kmfknyxlyo .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kmfknyxlyo .gt_font_normal {
  font-weight: normal;
}

#kmfknyxlyo .gt_font_bold {
  font-weight: bold;
}

#kmfknyxlyo .gt_font_italic {
  font-style: italic;
}

#kmfknyxlyo .gt_super {
  font-size: 65%;
}

#kmfknyxlyo .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kmfknyxlyo .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kmfknyxlyo .gt_indent_1 {
  text-indent: 5px;
}

#kmfknyxlyo .gt_indent_2 {
  text-indent: 10px;
}

#kmfknyxlyo .gt_indent_3 {
  text-indent: 15px;
}

#kmfknyxlyo .gt_indent_4 {
  text-indent: 20px;
}

#kmfknyxlyo .gt_indent_5 {
  text-indent: 25px;
}

#kmfknyxlyo .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kmfknyxlyo div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_left">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_left">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_left">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="group-by-with-date" class="level3" data-number="7.1.5">
<h3 data-number="7.1.5" class="anchored" data-anchor-id="group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></h3>
<p>You can also group by date or time intervals.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find the total sales per day:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_date, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> sales_date;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="2">Group all rows by each unique date (day).</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="eepnbmsujj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eepnbmsujj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eepnbmsujj thead, #eepnbmsujj tbody, #eepnbmsujj tfoot, #eepnbmsujj tr, #eepnbmsujj td, #eepnbmsujj th {
  border-style: none;
}

#eepnbmsujj p {
  margin: 0;
  padding: 0;
}

#eepnbmsujj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eepnbmsujj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eepnbmsujj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eepnbmsujj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eepnbmsujj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eepnbmsujj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eepnbmsujj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eepnbmsujj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eepnbmsujj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eepnbmsujj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eepnbmsujj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eepnbmsujj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eepnbmsujj .gt_spanner_row {
  border-bottom-style: hidden;
}

#eepnbmsujj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eepnbmsujj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eepnbmsujj .gt_from_md > :first-child {
  margin-top: 0;
}

#eepnbmsujj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eepnbmsujj .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eepnbmsujj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#eepnbmsujj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eepnbmsujj .gt_row_group_first td {
  border-top-width: 2px;
}

#eepnbmsujj .gt_row_group_first th {
  border-top-width: 2px;
}

#eepnbmsujj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eepnbmsujj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eepnbmsujj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eepnbmsujj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eepnbmsujj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eepnbmsujj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eepnbmsujj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eepnbmsujj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eepnbmsujj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eepnbmsujj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eepnbmsujj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eepnbmsujj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eepnbmsujj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eepnbmsujj .gt_left {
  text-align: left;
}

#eepnbmsujj .gt_center {
  text-align: center;
}

#eepnbmsujj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eepnbmsujj .gt_font_normal {
  font-weight: normal;
}

#eepnbmsujj .gt_font_bold {
  font-weight: bold;
}

#eepnbmsujj .gt_font_italic {
  font-style: italic;
}

#eepnbmsujj .gt_super {
  font-size: 65%;
}

#eepnbmsujj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eepnbmsujj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eepnbmsujj .gt_indent_1 {
  text-indent: 5px;
}

#eepnbmsujj .gt_indent_2 {
  text-indent: 10px;
}

#eepnbmsujj .gt_indent_3 {
  text-indent: 15px;
}

#eepnbmsujj .gt_indent_4 {
  text-indent: 20px;
}

#eepnbmsujj .gt_indent_5 {
  text-indent: 25px;
}

#eepnbmsujj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eepnbmsujj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="daily_sales" class="gt_row gt_center">250</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="daily_sales" class="gt_row gt_center">600</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="daily_sales" class="gt_row gt_center">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-expressions" class="level3" data-number="7.1.6">
<h3 data-number="7.1.6" class="anchored" data-anchor-id="group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</h3>
<p>You can also use expressions or functions in <code>GROUP BY</code></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Group by the year of the sales date:</span></span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-4" class="code-annotation-target"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date) <span class="kw">AS</span> sales_day,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2">2</button><span id="annotated-cell-9-5" class="code-annotation-target"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3">3</button><span id="annotated-cell-9-7" class="code-annotation-target"><a href="#annotated-cell-9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date);</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="4" data-code-annotation="1">Extract the day from the date.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="5" data-code-annotation="2">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="7" data-code-annotation="3">Group all rows by each unique day.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="roiyqbeslb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#roiyqbeslb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#roiyqbeslb thead, #roiyqbeslb tbody, #roiyqbeslb tfoot, #roiyqbeslb tr, #roiyqbeslb td, #roiyqbeslb th {
  border-style: none;
}

#roiyqbeslb p {
  margin: 0;
  padding: 0;
}

#roiyqbeslb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#roiyqbeslb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#roiyqbeslb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#roiyqbeslb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#roiyqbeslb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#roiyqbeslb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#roiyqbeslb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#roiyqbeslb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#roiyqbeslb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#roiyqbeslb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#roiyqbeslb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#roiyqbeslb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#roiyqbeslb .gt_spanner_row {
  border-bottom-style: hidden;
}

#roiyqbeslb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#roiyqbeslb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#roiyqbeslb .gt_from_md > :first-child {
  margin-top: 0;
}

#roiyqbeslb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#roiyqbeslb .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#roiyqbeslb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#roiyqbeslb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#roiyqbeslb .gt_row_group_first td {
  border-top-width: 2px;
}

#roiyqbeslb .gt_row_group_first th {
  border-top-width: 2px;
}

#roiyqbeslb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#roiyqbeslb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#roiyqbeslb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#roiyqbeslb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#roiyqbeslb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#roiyqbeslb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#roiyqbeslb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#roiyqbeslb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#roiyqbeslb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#roiyqbeslb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#roiyqbeslb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#roiyqbeslb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#roiyqbeslb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#roiyqbeslb .gt_left {
  text-align: left;
}

#roiyqbeslb .gt_center {
  text-align: center;
}

#roiyqbeslb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#roiyqbeslb .gt_font_normal {
  font-weight: normal;
}

#roiyqbeslb .gt_font_bold {
  font-weight: bold;
}

#roiyqbeslb .gt_font_italic {
  font-style: italic;
}

#roiyqbeslb .gt_super {
  font-size: 65%;
}

#roiyqbeslb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#roiyqbeslb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#roiyqbeslb .gt_indent_1 {
  text-indent: 5px;
}

#roiyqbeslb .gt_indent_2 {
  text-indent: 10px;
}

#roiyqbeslb .gt_indent_3 {
  text-indent: 15px;
}

#roiyqbeslb .gt_indent_4 {
  text-indent: 20px;
}

#roiyqbeslb .gt_indent_5 {
  text-indent: 25px;
}

#roiyqbeslb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#roiyqbeslb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="sales_day">sales_day</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">1</td>
<td headers="daily_sales" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">2</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">3</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">4</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">5</td>
<td headers="daily_sales" class="gt_row gt_right">600</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">6</td>
<td headers="daily_sales" class="gt_row gt_right">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-order-by" class="level3" data-number="7.1.7">
<h3 data-number="7.1.7" class="anchored" data-anchor-id="group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></h3>
<p>You can order the results of a <code>GROUP BY</code> query by the aggregated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-10-2"><a href="#annotated-cell-10-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-3" class="code-annotation-target"><a href="#annotated-cell-10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-5" class="code-annotation-target"><a href="#annotated-cell-10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="3">3</button><span id="annotated-cell-10-6" class="code-annotation-target"><a href="#annotated-cell-10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_sales_amount <span class="kw">DESC</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="3" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="5" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="6" data-code-annotation="3">Sort the aggregated output by the total sales amount in descending order.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="pasdowhhlg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pasdowhhlg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pasdowhhlg thead, #pasdowhhlg tbody, #pasdowhhlg tfoot, #pasdowhhlg tr, #pasdowhhlg td, #pasdowhhlg th {
  border-style: none;
}

#pasdowhhlg p {
  margin: 0;
  padding: 0;
}

#pasdowhhlg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pasdowhhlg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pasdowhhlg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pasdowhhlg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pasdowhhlg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pasdowhhlg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pasdowhhlg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pasdowhhlg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pasdowhhlg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pasdowhhlg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pasdowhhlg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pasdowhhlg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pasdowhhlg .gt_spanner_row {
  border-bottom-style: hidden;
}

#pasdowhhlg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pasdowhhlg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pasdowhhlg .gt_from_md > :first-child {
  margin-top: 0;
}

#pasdowhhlg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pasdowhhlg .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pasdowhhlg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#pasdowhhlg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pasdowhhlg .gt_row_group_first td {
  border-top-width: 2px;
}

#pasdowhhlg .gt_row_group_first th {
  border-top-width: 2px;
}

#pasdowhhlg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pasdowhhlg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pasdowhhlg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pasdowhhlg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pasdowhhlg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pasdowhhlg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pasdowhhlg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pasdowhhlg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pasdowhhlg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pasdowhhlg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pasdowhhlg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pasdowhhlg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pasdowhhlg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pasdowhhlg .gt_left {
  text-align: left;
}

#pasdowhhlg .gt_center {
  text-align: center;
}

#pasdowhhlg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pasdowhhlg .gt_font_normal {
  font-weight: normal;
}

#pasdowhhlg .gt_font_bold {
  font-weight: bold;
}

#pasdowhhlg .gt_font_italic {
  font-style: italic;
}

#pasdowhhlg .gt_super {
  font-size: 65%;
}

#pasdowhhlg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pasdowhhlg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pasdowhhlg .gt_indent_1 {
  text-indent: 5px;
}

#pasdowhhlg .gt_indent_2 {
  text-indent: 10px;
}

#pasdowhhlg .gt_indent_3 {
  text-indent: 15px;
}

#pasdowhhlg .gt_indent_4 {
  text-indent: 20px;
}

#pasdowhhlg .gt_indent_5 {
  text-indent: 25px;
}

#pasdowhhlg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pasdowhhlg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_center">1250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_center">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_center">600</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="grouping-with-a-conditional-aggregate" class="level3" data-number="7.1.8">
<h3 data-number="7.1.8" class="anchored" data-anchor-id="grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</h3>
<p>To calculate the number of sales and the total amount for each store, but only for sales over $100:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-11"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-11-1"><a href="#annotated-cell-11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="1">1</button><span id="annotated-cell-11-2" class="code-annotation-target"><a href="#annotated-cell-11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_sales_count,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="2">2</button><span id="annotated-cell-11-3" class="code-annotation-target"><a href="#annotated-cell-11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> amount <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_total_amount</span>
<span id="annotated-cell-11-4"><a href="#annotated-cell-11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-11-5"><a href="#annotated-cell-11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-11" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="2" data-code-annotation="1">If sales amount is greater than 100 count it.</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="3" data-code-annotation="2">If sales amount is greater than 100 then add sales amount else add zero.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tzgkehpsvk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tzgkehpsvk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tzgkehpsvk thead, #tzgkehpsvk tbody, #tzgkehpsvk tfoot, #tzgkehpsvk tr, #tzgkehpsvk td, #tzgkehpsvk th {
  border-style: none;
}

#tzgkehpsvk p {
  margin: 0;
  padding: 0;
}

#tzgkehpsvk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tzgkehpsvk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tzgkehpsvk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tzgkehpsvk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tzgkehpsvk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tzgkehpsvk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tzgkehpsvk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tzgkehpsvk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tzgkehpsvk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tzgkehpsvk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tzgkehpsvk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tzgkehpsvk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tzgkehpsvk .gt_spanner_row {
  border-bottom-style: hidden;
}

#tzgkehpsvk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tzgkehpsvk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tzgkehpsvk .gt_from_md > :first-child {
  margin-top: 0;
}

#tzgkehpsvk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tzgkehpsvk .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tzgkehpsvk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#tzgkehpsvk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tzgkehpsvk .gt_row_group_first td {
  border-top-width: 2px;
}

#tzgkehpsvk .gt_row_group_first th {
  border-top-width: 2px;
}

#tzgkehpsvk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tzgkehpsvk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tzgkehpsvk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tzgkehpsvk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tzgkehpsvk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tzgkehpsvk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tzgkehpsvk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tzgkehpsvk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tzgkehpsvk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tzgkehpsvk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tzgkehpsvk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tzgkehpsvk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tzgkehpsvk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tzgkehpsvk .gt_left {
  text-align: left;
}

#tzgkehpsvk .gt_center {
  text-align: center;
}

#tzgkehpsvk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tzgkehpsvk .gt_font_normal {
  font-weight: normal;
}

#tzgkehpsvk .gt_font_bold {
  font-weight: bold;
}

#tzgkehpsvk .gt_font_italic {
  font-style: italic;
}

#tzgkehpsvk .gt_super {
  font-size: 65%;
}

#tzgkehpsvk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tzgkehpsvk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tzgkehpsvk .gt_indent_1 {
  text-indent: 5px;
}

#tzgkehpsvk .gt_indent_2 {
  text-indent: 10px;
}

#tzgkehpsvk .gt_indent_3 {
  text-indent: 15px;
}

#tzgkehpsvk .gt_indent_4 {
  text-indent: 20px;
}

#tzgkehpsvk .gt_indent_5 {
  text-indent: 25px;
}

#tzgkehpsvk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tzgkehpsvk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_sales_count">high_value_sales_count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_total_amount">high_value_total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">800</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="high_value_sales_count" class="gt_row gt_center">5</td>
<td headers="high_value_total_amount" class="gt_row gt_center">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group by Summary
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>It is often used with aggregate functions <strong>to perform calculations on each group.</strong></p></li>
<li><p><code>HAVING</code> clause can be used to filter groups after the aggregation.</p></li>
<li><p><code>ORDER BY</code> can be combined with <code>GROUP BY</code> to sort the results by the aggregated values.</p></li>
</ul>
</div>
</div>
<p><br> <br> <br></p>
<!------- GROUP BY ---------------------------------------------------------->
</section>
</section>
<section id="window-function" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="window-function"><span class="header-section-number">7.2</span> Window Function</h2>
<p>Window functions <strong>perform calculations across a set of table rows related to the current row</strong>. Unlike aggregate functions, which return a single value after grouping rows, window functions return multiple rows with calculated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-12-2"><a href="#annotated-cell-12-2" aria-hidden="true" tabindex="-1"></a>  col_name1, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1">1</button><span id="annotated-cell-12-3" class="code-annotation-target"><a href="#annotated-cell-12-3" aria-hidden="true" tabindex="-1"></a>  window_function() <span class="kw">OVER</span> ([<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2] [<span class="kw">ORDER</span> <span class="kw">BY</span> col_name3]) <span class="kw">AS</span> alias_name</span>
<span id="annotated-cell-12-4"><a href="#annotated-cell-12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="3" data-code-annotation="1">Define the window function and how it should be grouped and sorted.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Key Concepts of Window Function
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>OVER()</code> Clause defines the window of rows the function operates on.</li>
<li><code>PARTITION BY</code> divides the result set into <strong>partitions</strong> (like a GROUP BY).</li>
<li><code>ORDER BY</code> defines the order of rows within each partition.</li>
</ul>
</div>
</div>
<section id="row_number" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</h3>
<p>This function will assign a unique row number within a partition.</p>
</section>
<section id="quick-illustration-of-window-function" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-window-function">Quick illustration of window function</h3>
<p>A Simple example of how window function works.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">row_number</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="vqscrzbaop" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vqscrzbaop table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vqscrzbaop thead, #vqscrzbaop tbody, #vqscrzbaop tfoot, #vqscrzbaop tr, #vqscrzbaop td, #vqscrzbaop th {
  border-style: none;
}

#vqscrzbaop p {
  margin: 0;
  padding: 0;
}

#vqscrzbaop .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vqscrzbaop .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vqscrzbaop .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vqscrzbaop .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vqscrzbaop .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vqscrzbaop .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vqscrzbaop .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vqscrzbaop .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vqscrzbaop .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vqscrzbaop .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vqscrzbaop .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vqscrzbaop .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vqscrzbaop .gt_spanner_row {
  border-bottom-style: hidden;
}

#vqscrzbaop .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vqscrzbaop .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vqscrzbaop .gt_from_md > :first-child {
  margin-top: 0;
}

#vqscrzbaop .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vqscrzbaop .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vqscrzbaop .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vqscrzbaop .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vqscrzbaop .gt_row_group_first td {
  border-top-width: 2px;
}

#vqscrzbaop .gt_row_group_first th {
  border-top-width: 2px;
}

#vqscrzbaop .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vqscrzbaop .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vqscrzbaop .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vqscrzbaop .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vqscrzbaop .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vqscrzbaop .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vqscrzbaop .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vqscrzbaop .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vqscrzbaop .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vqscrzbaop .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vqscrzbaop .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vqscrzbaop .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vqscrzbaop .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vqscrzbaop .gt_left {
  text-align: left;
}

#vqscrzbaop .gt_center {
  text-align: center;
}

#vqscrzbaop .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vqscrzbaop .gt_font_normal {
  font-weight: normal;
}

#vqscrzbaop .gt_font_bold {
  font-weight: bold;
}

#vqscrzbaop .gt_font_italic {
  font-style: italic;
}

#vqscrzbaop .gt_super {
  font-size: 65%;
}

#vqscrzbaop .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vqscrzbaop .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vqscrzbaop .gt_indent_1 {
  text-indent: 5px;
}

#vqscrzbaop .gt_indent_2 {
  text-indent: 10px;
}

#vqscrzbaop .gt_indent_3 {
  text-indent: 15px;
}

#vqscrzbaop .gt_indent_4 {
  text-indent: 20px;
}

#vqscrzbaop .gt_indent_5 {
  text-indent: 25px;
}

#vqscrzbaop .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vqscrzbaop div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="row_number">row_number</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br></p>
<section id="unordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="unordered">Unordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-14-3"><a href="#annotated-cell-14-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-14-4"><a href="#annotated-cell-14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1">1</button><span id="annotated-cell-14-5" class="code-annotation-target"><a href="#annotated-cell-14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-14-6"><a href="#annotated-cell-14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id then get the row number for each partition.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="pjmbhyiahn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pjmbhyiahn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pjmbhyiahn thead, #pjmbhyiahn tbody, #pjmbhyiahn tfoot, #pjmbhyiahn tr, #pjmbhyiahn td, #pjmbhyiahn th {
  border-style: none;
}

#pjmbhyiahn p {
  margin: 0;
  padding: 0;
}

#pjmbhyiahn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pjmbhyiahn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pjmbhyiahn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pjmbhyiahn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pjmbhyiahn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pjmbhyiahn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pjmbhyiahn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pjmbhyiahn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pjmbhyiahn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pjmbhyiahn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pjmbhyiahn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pjmbhyiahn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pjmbhyiahn .gt_spanner_row {
  border-bottom-style: hidden;
}

#pjmbhyiahn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pjmbhyiahn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pjmbhyiahn .gt_from_md > :first-child {
  margin-top: 0;
}

#pjmbhyiahn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pjmbhyiahn .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pjmbhyiahn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#pjmbhyiahn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pjmbhyiahn .gt_row_group_first td {
  border-top-width: 2px;
}

#pjmbhyiahn .gt_row_group_first th {
  border-top-width: 2px;
}

#pjmbhyiahn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjmbhyiahn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pjmbhyiahn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pjmbhyiahn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pjmbhyiahn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjmbhyiahn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pjmbhyiahn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pjmbhyiahn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pjmbhyiahn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pjmbhyiahn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pjmbhyiahn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjmbhyiahn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pjmbhyiahn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjmbhyiahn .gt_left {
  text-align: left;
}

#pjmbhyiahn .gt_center {
  text-align: center;
}

#pjmbhyiahn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pjmbhyiahn .gt_font_normal {
  font-weight: normal;
}

#pjmbhyiahn .gt_font_bold {
  font-weight: bold;
}

#pjmbhyiahn .gt_font_italic {
  font-style: italic;
}

#pjmbhyiahn .gt_super {
  font-size: 65%;
}

#pjmbhyiahn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pjmbhyiahn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pjmbhyiahn .gt_indent_1 {
  text-indent: 5px;
}

#pjmbhyiahn .gt_indent_2 {
  text-indent: 10px;
}

#pjmbhyiahn .gt_indent_3 {
  text-indent: 15px;
}

#pjmbhyiahn .gt_indent_4 {
  text-indent: 20px;
}

#pjmbhyiahn .gt_indent_5 {
  text-indent: 25px;
}

#pjmbhyiahn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pjmbhyiahn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="ordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ordered">Ordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-15"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-15-1"><a href="#annotated-cell-15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-15-2"><a href="#annotated-cell-15-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-15-3"><a href="#annotated-cell-15-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-15-4"><a href="#annotated-cell-15-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-15" data-target-annotation="1">1</button><span id="annotated-cell-15-5" class="code-annotation-target"><a href="#annotated-cell-15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-15-6"><a href="#annotated-cell-15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-15" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-15" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id, then order by the sales date. Then get the row number by the partition. In other words, the rows are numbered sequentially for each store_id based on sales_date.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="twdnoudpje" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#twdnoudpje table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#twdnoudpje thead, #twdnoudpje tbody, #twdnoudpje tfoot, #twdnoudpje tr, #twdnoudpje td, #twdnoudpje th {
  border-style: none;
}

#twdnoudpje p {
  margin: 0;
  padding: 0;
}

#twdnoudpje .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#twdnoudpje .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#twdnoudpje .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#twdnoudpje .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#twdnoudpje .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twdnoudpje .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twdnoudpje .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twdnoudpje .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#twdnoudpje .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#twdnoudpje .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#twdnoudpje .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#twdnoudpje .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#twdnoudpje .gt_spanner_row {
  border-bottom-style: hidden;
}

#twdnoudpje .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#twdnoudpje .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#twdnoudpje .gt_from_md > :first-child {
  margin-top: 0;
}

#twdnoudpje .gt_from_md > :last-child {
  margin-bottom: 0;
}

#twdnoudpje .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#twdnoudpje .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#twdnoudpje .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#twdnoudpje .gt_row_group_first td {
  border-top-width: 2px;
}

#twdnoudpje .gt_row_group_first th {
  border-top-width: 2px;
}

#twdnoudpje .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#twdnoudpje .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#twdnoudpje .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#twdnoudpje .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twdnoudpje .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#twdnoudpje .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#twdnoudpje .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#twdnoudpje .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#twdnoudpje .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twdnoudpje .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twdnoudpje .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#twdnoudpje .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twdnoudpje .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#twdnoudpje .gt_left {
  text-align: left;
}

#twdnoudpje .gt_center {
  text-align: center;
}

#twdnoudpje .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#twdnoudpje .gt_font_normal {
  font-weight: normal;
}

#twdnoudpje .gt_font_bold {
  font-weight: bold;
}

#twdnoudpje .gt_font_italic {
  font-style: italic;
}

#twdnoudpje .gt_super {
  font-size: 65%;
}

#twdnoudpje .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#twdnoudpje .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#twdnoudpje .gt_indent_1 {
  text-indent: 5px;
}

#twdnoudpje .gt_indent_2 {
  text-indent: 10px;
}

#twdnoudpje .gt_indent_3 {
  text-indent: 15px;
}

#twdnoudpje .gt_indent_4 {
  text-indent: 20px;
}

#twdnoudpje .gt_indent_5 {
  text-indent: 25px;
}

#twdnoudpje .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#twdnoudpje div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="aggregate-function-sum-as-a-window-function" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</h3>
<section id="quick-illustration-of-window-aggregate-functions" class="level4" data-number="7.2.2.1">
<h4 data-number="7.2.2.1" class="anchored" data-anchor-id="quick-illustration-of-window-aggregate-functions"><span class="header-section-number">7.2.2.1</span> Quick Illustration of window aggregate functions</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-16"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-16-1"><a href="#annotated-cell-16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="annotated-cell-16-2"><a href="#annotated-cell-16-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="annotated-cell-16-3"><a href="#annotated-cell-16-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="annotated-cell-16-4"><a href="#annotated-cell-16-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="1">1</button><span id="annotated-cell-16-5" class="code-annotation-target"><a href="#annotated-cell-16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span>) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-16-6"><a href="#annotated-cell-16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-16" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="5" data-code-annotation="1">Get the total amount of each partition.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ltzihjshsk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ltzihjshsk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ltzihjshsk thead, #ltzihjshsk tbody, #ltzihjshsk tfoot, #ltzihjshsk tr, #ltzihjshsk td, #ltzihjshsk th {
  border-style: none;
}

#ltzihjshsk p {
  margin: 0;
  padding: 0;
}

#ltzihjshsk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ltzihjshsk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ltzihjshsk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ltzihjshsk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ltzihjshsk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ltzihjshsk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltzihjshsk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ltzihjshsk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ltzihjshsk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ltzihjshsk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ltzihjshsk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ltzihjshsk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ltzihjshsk .gt_spanner_row {
  border-bottom-style: hidden;
}

#ltzihjshsk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ltzihjshsk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ltzihjshsk .gt_from_md > :first-child {
  margin-top: 0;
}

#ltzihjshsk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ltzihjshsk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ltzihjshsk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ltzihjshsk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ltzihjshsk .gt_row_group_first td {
  border-top-width: 2px;
}

#ltzihjshsk .gt_row_group_first th {
  border-top-width: 2px;
}

#ltzihjshsk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltzihjshsk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ltzihjshsk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ltzihjshsk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltzihjshsk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltzihjshsk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ltzihjshsk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ltzihjshsk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ltzihjshsk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ltzihjshsk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ltzihjshsk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltzihjshsk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ltzihjshsk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ltzihjshsk .gt_left {
  text-align: left;
}

#ltzihjshsk .gt_center {
  text-align: center;
}

#ltzihjshsk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ltzihjshsk .gt_font_normal {
  font-weight: normal;
}

#ltzihjshsk .gt_font_bold {
  font-weight: bold;
}

#ltzihjshsk .gt_font_italic {
  font-style: italic;
}

#ltzihjshsk .gt_super {
  font-size: 65%;
}

#ltzihjshsk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ltzihjshsk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ltzihjshsk .gt_indent_1 {
  text-indent: 5px;
}

#ltzihjshsk .gt_indent_2 {
  text-indent: 10px;
}

#ltzihjshsk .gt_indent_3 {
  text-indent: 15px;
}

#ltzihjshsk .gt_indent_4 {
  text-indent: 20px;
}

#ltzihjshsk .gt_indent_5 {
  text-indent: 25px;
}

#ltzihjshsk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ltzihjshsk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> running_total</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="esxicizqkm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#esxicizqkm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#esxicizqkm thead, #esxicizqkm tbody, #esxicizqkm tfoot, #esxicizqkm tr, #esxicizqkm td, #esxicizqkm th {
  border-style: none;
}

#esxicizqkm p {
  margin: 0;
  padding: 0;
}

#esxicizqkm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#esxicizqkm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#esxicizqkm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#esxicizqkm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#esxicizqkm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#esxicizqkm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#esxicizqkm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#esxicizqkm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#esxicizqkm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#esxicizqkm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#esxicizqkm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#esxicizqkm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#esxicizqkm .gt_spanner_row {
  border-bottom-style: hidden;
}

#esxicizqkm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#esxicizqkm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#esxicizqkm .gt_from_md > :first-child {
  margin-top: 0;
}

#esxicizqkm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#esxicizqkm .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#esxicizqkm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#esxicizqkm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#esxicizqkm .gt_row_group_first td {
  border-top-width: 2px;
}

#esxicizqkm .gt_row_group_first th {
  border-top-width: 2px;
}

#esxicizqkm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#esxicizqkm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#esxicizqkm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#esxicizqkm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#esxicizqkm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#esxicizqkm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#esxicizqkm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#esxicizqkm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#esxicizqkm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#esxicizqkm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#esxicizqkm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#esxicizqkm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#esxicizqkm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#esxicizqkm .gt_left {
  text-align: left;
}

#esxicizqkm .gt_center {
  text-align: center;
}

#esxicizqkm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#esxicizqkm .gt_font_normal {
  font-weight: normal;
}

#esxicizqkm .gt_font_bold {
  font-weight: bold;
}

#esxicizqkm .gt_font_italic {
  font-style: italic;
}

#esxicizqkm .gt_super {
  font-size: 65%;
}

#esxicizqkm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#esxicizqkm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#esxicizqkm .gt_indent_1 {
  text-indent: 5px;
}

#esxicizqkm .gt_indent_2 {
  text-indent: 10px;
}

#esxicizqkm .gt_indent_3 {
  text-indent: 15px;
}

#esxicizqkm .gt_indent_4 {
  text-indent: 20px;
}

#esxicizqkm .gt_indent_5 {
  text-indent: 25px;
}

#esxicizqkm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#esxicizqkm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="running_total">running_total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="running_total" class="gt_row gt_right">550</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">650</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="rank" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="rank"><span class="header-section-number">7.2.3</span> RANK</h3>
<p>Ranks the rows within a partition. Ties result in the same rank, but with gaps in the sequence.</p>
<section id="quick-illustration" class="level4" data-number="7.2.3.1">
<h4 data-number="7.2.3.1" class="anchored" data-anchor-id="quick-illustration"><span class="header-section-number">7.2.3.1</span> Quick Illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    product,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    amount</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="twcfwgijbr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#twcfwgijbr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#twcfwgijbr thead, #twcfwgijbr tbody, #twcfwgijbr tfoot, #twcfwgijbr tr, #twcfwgijbr td, #twcfwgijbr th {
  border-style: none;
}

#twcfwgijbr p {
  margin: 0;
  padding: 0;
}

#twcfwgijbr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#twcfwgijbr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#twcfwgijbr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#twcfwgijbr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#twcfwgijbr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twcfwgijbr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twcfwgijbr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twcfwgijbr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#twcfwgijbr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#twcfwgijbr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#twcfwgijbr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#twcfwgijbr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#twcfwgijbr .gt_spanner_row {
  border-bottom-style: hidden;
}

#twcfwgijbr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#twcfwgijbr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#twcfwgijbr .gt_from_md > :first-child {
  margin-top: 0;
}

#twcfwgijbr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#twcfwgijbr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#twcfwgijbr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#twcfwgijbr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#twcfwgijbr .gt_row_group_first td {
  border-top-width: 2px;
}

#twcfwgijbr .gt_row_group_first th {
  border-top-width: 2px;
}

#twcfwgijbr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#twcfwgijbr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#twcfwgijbr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#twcfwgijbr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twcfwgijbr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#twcfwgijbr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#twcfwgijbr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#twcfwgijbr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#twcfwgijbr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twcfwgijbr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twcfwgijbr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#twcfwgijbr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twcfwgijbr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#twcfwgijbr .gt_left {
  text-align: left;
}

#twcfwgijbr .gt_center {
  text-align: center;
}

#twcfwgijbr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#twcfwgijbr .gt_font_normal {
  font-weight: normal;
}

#twcfwgijbr .gt_font_bold {
  font-weight: bold;
}

#twcfwgijbr .gt_font_italic {
  font-style: italic;
}

#twcfwgijbr .gt_super {
  font-size: 65%;
}

#twcfwgijbr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#twcfwgijbr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#twcfwgijbr .gt_indent_1 {
  text-indent: 5px;
}

#twcfwgijbr .gt_indent_2 {
  text-indent: 10px;
}

#twcfwgijbr .gt_indent_3 {
  text-indent: 15px;
}

#twcfwgijbr .gt_indent_4 {
  text-indent: 20px;
}

#twcfwgijbr .gt_indent_5 {
  text-indent: 25px;
}

#twcfwgijbr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#twcfwgijbr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">4</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fgusxeqewh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fgusxeqewh table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fgusxeqewh thead, #fgusxeqewh tbody, #fgusxeqewh tfoot, #fgusxeqewh tr, #fgusxeqewh td, #fgusxeqewh th {
  border-style: none;
}

#fgusxeqewh p {
  margin: 0;
  padding: 0;
}

#fgusxeqewh .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fgusxeqewh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fgusxeqewh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fgusxeqewh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fgusxeqewh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fgusxeqewh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fgusxeqewh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fgusxeqewh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fgusxeqewh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fgusxeqewh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fgusxeqewh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fgusxeqewh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fgusxeqewh .gt_spanner_row {
  border-bottom-style: hidden;
}

#fgusxeqewh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fgusxeqewh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fgusxeqewh .gt_from_md > :first-child {
  margin-top: 0;
}

#fgusxeqewh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fgusxeqewh .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fgusxeqewh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#fgusxeqewh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fgusxeqewh .gt_row_group_first td {
  border-top-width: 2px;
}

#fgusxeqewh .gt_row_group_first th {
  border-top-width: 2px;
}

#fgusxeqewh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fgusxeqewh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fgusxeqewh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fgusxeqewh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fgusxeqewh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fgusxeqewh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fgusxeqewh .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fgusxeqewh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fgusxeqewh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fgusxeqewh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fgusxeqewh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fgusxeqewh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fgusxeqewh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fgusxeqewh .gt_left {
  text-align: left;
}

#fgusxeqewh .gt_center {
  text-align: center;
}

#fgusxeqewh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fgusxeqewh .gt_font_normal {
  font-weight: normal;
}

#fgusxeqewh .gt_font_bold {
  font-weight: bold;
}

#fgusxeqewh .gt_font_italic {
  font-style: italic;
}

#fgusxeqewh .gt_super {
  font-size: 65%;
}

#fgusxeqewh .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fgusxeqewh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fgusxeqewh .gt_indent_1 {
  text-indent: 5px;
}

#fgusxeqewh .gt_indent_2 {
  text-indent: 10px;
}

#fgusxeqewh .gt_indent_3 {
  text-indent: 15px;
}

#fgusxeqewh .gt_indent_4 {
  text-indent: 20px;
}

#fgusxeqewh .gt_indent_5 {
  text-indent: 25px;
}

#fgusxeqewh .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fgusxeqewh div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>If two rows have the same amount within the same store_id, they will get the same rank, and the next rank will be skipped.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="dense_rank" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</h3>
<p>Similar to <code>RANK()</code>, but without gaps in the ranking sequence.</p>
<section id="quick-illustration-1" class="level4" data-number="7.2.4.1">
<h4 data-number="7.2.4.1" class="anchored" data-anchor-id="quick-illustration-1"><span class="header-section-number">7.2.4.1</span> Quick Illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    product,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    amount</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="njcwsptcxf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#njcwsptcxf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#njcwsptcxf thead, #njcwsptcxf tbody, #njcwsptcxf tfoot, #njcwsptcxf tr, #njcwsptcxf td, #njcwsptcxf th {
  border-style: none;
}

#njcwsptcxf p {
  margin: 0;
  padding: 0;
}

#njcwsptcxf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#njcwsptcxf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#njcwsptcxf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#njcwsptcxf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#njcwsptcxf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#njcwsptcxf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#njcwsptcxf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#njcwsptcxf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#njcwsptcxf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#njcwsptcxf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#njcwsptcxf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#njcwsptcxf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#njcwsptcxf .gt_spanner_row {
  border-bottom-style: hidden;
}

#njcwsptcxf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#njcwsptcxf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#njcwsptcxf .gt_from_md > :first-child {
  margin-top: 0;
}

#njcwsptcxf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#njcwsptcxf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#njcwsptcxf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#njcwsptcxf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#njcwsptcxf .gt_row_group_first td {
  border-top-width: 2px;
}

#njcwsptcxf .gt_row_group_first th {
  border-top-width: 2px;
}

#njcwsptcxf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#njcwsptcxf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#njcwsptcxf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#njcwsptcxf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#njcwsptcxf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#njcwsptcxf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#njcwsptcxf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#njcwsptcxf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#njcwsptcxf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#njcwsptcxf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#njcwsptcxf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#njcwsptcxf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#njcwsptcxf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#njcwsptcxf .gt_left {
  text-align: left;
}

#njcwsptcxf .gt_center {
  text-align: center;
}

#njcwsptcxf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#njcwsptcxf .gt_font_normal {
  font-weight: normal;
}

#njcwsptcxf .gt_font_bold {
  font-weight: bold;
}

#njcwsptcxf .gt_font_italic {
  font-style: italic;
}

#njcwsptcxf .gt_super {
  font-size: 65%;
}

#njcwsptcxf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#njcwsptcxf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#njcwsptcxf .gt_indent_1 {
  text-indent: 5px;
}

#njcwsptcxf .gt_indent_2 {
  text-indent: 10px;
}

#njcwsptcxf .gt_indent_3 {
  text-indent: 15px;
}

#njcwsptcxf .gt_indent_4 {
  text-indent: 20px;
}

#njcwsptcxf .gt_indent_5 {
  text-indent: 25px;
}

#njcwsptcxf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#njcwsptcxf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="dense_rank">dense_rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="oljwwxdoyc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oljwwxdoyc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oljwwxdoyc thead, #oljwwxdoyc tbody, #oljwwxdoyc tfoot, #oljwwxdoyc tr, #oljwwxdoyc td, #oljwwxdoyc th {
  border-style: none;
}

#oljwwxdoyc p {
  margin: 0;
  padding: 0;
}

#oljwwxdoyc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oljwwxdoyc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oljwwxdoyc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oljwwxdoyc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oljwwxdoyc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oljwwxdoyc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oljwwxdoyc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oljwwxdoyc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oljwwxdoyc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oljwwxdoyc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oljwwxdoyc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oljwwxdoyc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oljwwxdoyc .gt_spanner_row {
  border-bottom-style: hidden;
}

#oljwwxdoyc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oljwwxdoyc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oljwwxdoyc .gt_from_md > :first-child {
  margin-top: 0;
}

#oljwwxdoyc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oljwwxdoyc .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oljwwxdoyc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#oljwwxdoyc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oljwwxdoyc .gt_row_group_first td {
  border-top-width: 2px;
}

#oljwwxdoyc .gt_row_group_first th {
  border-top-width: 2px;
}

#oljwwxdoyc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oljwwxdoyc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oljwwxdoyc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oljwwxdoyc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oljwwxdoyc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oljwwxdoyc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oljwwxdoyc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oljwwxdoyc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oljwwxdoyc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oljwwxdoyc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oljwwxdoyc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oljwwxdoyc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oljwwxdoyc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oljwwxdoyc .gt_left {
  text-align: left;
}

#oljwwxdoyc .gt_center {
  text-align: center;
}

#oljwwxdoyc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oljwwxdoyc .gt_font_normal {
  font-weight: normal;
}

#oljwwxdoyc .gt_font_bold {
  font-weight: bold;
}

#oljwwxdoyc .gt_font_italic {
  font-style: italic;
}

#oljwwxdoyc .gt_super {
  font-size: 65%;
}

#oljwwxdoyc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oljwwxdoyc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oljwwxdoyc .gt_indent_1 {
  text-indent: 5px;
}

#oljwwxdoyc .gt_indent_2 {
  text-indent: 10px;
}

#oljwwxdoyc .gt_indent_3 {
  text-indent: 15px;
}

#oljwwxdoyc .gt_indent_4 {
  text-indent: 20px;
}

#oljwwxdoyc .gt_indent_5 {
  text-indent: 25px;
}

#oljwwxdoyc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oljwwxdoyc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This will rank rows without gaps, even if there are ties.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="ntile" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="ntile"><span class="header-section-number">7.2.5</span> NTILE</h3>
<p>Divides the result set into a specified number of buckets.</p>
<section id="quick-illustration-2" class="level4" data-number="7.2.5.1">
<h4 data-number="7.2.5.1" class="anchored" data-anchor-id="quick-illustration-2"><span class="header-section-number">7.2.5.1</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    product, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">3</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="jqzhcirema" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jqzhcirema table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jqzhcirema thead, #jqzhcirema tbody, #jqzhcirema tfoot, #jqzhcirema tr, #jqzhcirema td, #jqzhcirema th {
  border-style: none;
}

#jqzhcirema p {
  margin: 0;
  padding: 0;
}

#jqzhcirema .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jqzhcirema .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jqzhcirema .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jqzhcirema .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jqzhcirema .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqzhcirema .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqzhcirema .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jqzhcirema .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jqzhcirema .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jqzhcirema .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jqzhcirema .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jqzhcirema .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jqzhcirema .gt_spanner_row {
  border-bottom-style: hidden;
}

#jqzhcirema .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jqzhcirema .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jqzhcirema .gt_from_md > :first-child {
  margin-top: 0;
}

#jqzhcirema .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jqzhcirema .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jqzhcirema .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jqzhcirema .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jqzhcirema .gt_row_group_first td {
  border-top-width: 2px;
}

#jqzhcirema .gt_row_group_first th {
  border-top-width: 2px;
}

#jqzhcirema .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqzhcirema .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jqzhcirema .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jqzhcirema .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqzhcirema .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqzhcirema .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jqzhcirema .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jqzhcirema .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jqzhcirema .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jqzhcirema .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqzhcirema .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqzhcirema .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jqzhcirema .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jqzhcirema .gt_left {
  text-align: left;
}

#jqzhcirema .gt_center {
  text-align: center;
}

#jqzhcirema .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jqzhcirema .gt_font_normal {
  font-weight: normal;
}

#jqzhcirema .gt_font_bold {
  font-weight: bold;
}

#jqzhcirema .gt_font_italic {
  font-style: italic;
}

#jqzhcirema .gt_super {
  font-size: 65%;
}

#jqzhcirema .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jqzhcirema .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jqzhcirema .gt_indent_1 {
  text-indent: 5px;
}

#jqzhcirema .gt_indent_2 {
  text-indent: 10px;
}

#jqzhcirema .gt_indent_3 {
  text-indent: 15px;
}

#jqzhcirema .gt_indent_4 {
  text-indent: 20px;
}

#jqzhcirema .gt_indent_5 {
  text-indent: 25px;
}

#jqzhcirema .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#jqzhcirema div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">20</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">30</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">30</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">70</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">80</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">120</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">120</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    sales_id, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">4</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="xrxmdmqpmw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xrxmdmqpmw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xrxmdmqpmw thead, #xrxmdmqpmw tbody, #xrxmdmqpmw tfoot, #xrxmdmqpmw tr, #xrxmdmqpmw td, #xrxmdmqpmw th {
  border-style: none;
}

#xrxmdmqpmw p {
  margin: 0;
  padding: 0;
}

#xrxmdmqpmw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xrxmdmqpmw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xrxmdmqpmw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xrxmdmqpmw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xrxmdmqpmw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xrxmdmqpmw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xrxmdmqpmw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xrxmdmqpmw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xrxmdmqpmw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xrxmdmqpmw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xrxmdmqpmw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xrxmdmqpmw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xrxmdmqpmw .gt_spanner_row {
  border-bottom-style: hidden;
}

#xrxmdmqpmw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xrxmdmqpmw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xrxmdmqpmw .gt_from_md > :first-child {
  margin-top: 0;
}

#xrxmdmqpmw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xrxmdmqpmw .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xrxmdmqpmw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#xrxmdmqpmw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xrxmdmqpmw .gt_row_group_first td {
  border-top-width: 2px;
}

#xrxmdmqpmw .gt_row_group_first th {
  border-top-width: 2px;
}

#xrxmdmqpmw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xrxmdmqpmw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xrxmdmqpmw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xrxmdmqpmw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xrxmdmqpmw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xrxmdmqpmw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xrxmdmqpmw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xrxmdmqpmw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xrxmdmqpmw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xrxmdmqpmw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xrxmdmqpmw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xrxmdmqpmw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xrxmdmqpmw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xrxmdmqpmw .gt_left {
  text-align: left;
}

#xrxmdmqpmw .gt_center {
  text-align: center;
}

#xrxmdmqpmw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xrxmdmqpmw .gt_font_normal {
  font-weight: normal;
}

#xrxmdmqpmw .gt_font_bold {
  font-weight: bold;
}

#xrxmdmqpmw .gt_font_italic {
  font-style: italic;
}

#xrxmdmqpmw .gt_super {
  font-size: 65%;
}

#xrxmdmqpmw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xrxmdmqpmw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xrxmdmqpmw .gt_indent_1 {
  text-indent: 5px;
}

#xrxmdmqpmw .gt_indent_2 {
  text-indent: 10px;
}

#xrxmdmqpmw .gt_indent_3 {
  text-indent: 15px;
}

#xrxmdmqpmw .gt_indent_4 {
  text-indent: 20px;
}

#xrxmdmqpmw .gt_indent_5 {
  text-indent: 25px;
}

#xrxmdmqpmw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xrxmdmqpmw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">300</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This divides the result set into 2 buckets based on the Amount. Rows with the highest amounts go into the first bucket, and so on.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="lag" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="lag"><span class="header-section-number">7.2.6</span> LAG</h3>
<p><code>LAG()</code> is a function that allows users to access data from a previous row within the same result set. It is particularly useful for performing comparisons between the current row and its preceding rows.</p>
<section id="basic-syntax" class="level4" data-number="7.2.6.1">
<h4 data-number="7.2.6.1" class="anchored" data-anchor-id="basic-syntax"><span class="header-section-number">7.2.6.1</span> Basic syntax</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LAG</span>(expression [, offset [, default_value]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><p><strong>expression:</strong> This is the column or expression from which you want to retrieve the value from a previous row.</p></li>
<li><p><strong>offset:</strong> This optional parameter specifies how many rows back to look. The default value is 1 if not specified.</p></li>
<li><p><strong>default_value:</strong> This optional parameter defines what value to return if there is no previous row available (e.g., when looking back beyond the first row). If omitted, NULL will be returned.</p></li>
</ul>
</section>
<section id="quick-illustration-3" class="level4" data-number="7.2.6.2">
<h4 data-number="7.2.6.2" class="anchored" data-anchor-id="quick-illustration-3"><span class="header-section-number">7.2.6.2</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-25-1"><a href="#annotated-cell-25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-25-2"><a href="#annotated-cell-25-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>,</span>
<span id="annotated-cell-25-3"><a href="#annotated-cell-25-3" aria-hidden="true" tabindex="-1"></a>      product,</span>
<span id="annotated-cell-25-4"><a href="#annotated-cell-25-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="1">1</button><span id="annotated-cell-25-5" class="code-annotation-target"><a href="#annotated-cell-25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="annotated-cell-25-6"><a href="#annotated-cell-25-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="5" data-code-annotation="1">retrieve the value from the previous row in the amount column.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="cqrwqdertm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cqrwqdertm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cqrwqdertm thead, #cqrwqdertm tbody, #cqrwqdertm tfoot, #cqrwqdertm tr, #cqrwqdertm td, #cqrwqdertm th {
  border-style: none;
}

#cqrwqdertm p {
  margin: 0;
  padding: 0;
}

#cqrwqdertm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cqrwqdertm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cqrwqdertm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cqrwqdertm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cqrwqdertm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cqrwqdertm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqrwqdertm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cqrwqdertm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cqrwqdertm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cqrwqdertm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cqrwqdertm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cqrwqdertm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cqrwqdertm .gt_spanner_row {
  border-bottom-style: hidden;
}

#cqrwqdertm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cqrwqdertm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cqrwqdertm .gt_from_md > :first-child {
  margin-top: 0;
}

#cqrwqdertm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cqrwqdertm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cqrwqdertm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cqrwqdertm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cqrwqdertm .gt_row_group_first td {
  border-top-width: 2px;
}

#cqrwqdertm .gt_row_group_first th {
  border-top-width: 2px;
}

#cqrwqdertm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqrwqdertm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cqrwqdertm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cqrwqdertm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqrwqdertm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqrwqdertm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cqrwqdertm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cqrwqdertm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cqrwqdertm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cqrwqdertm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cqrwqdertm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqrwqdertm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cqrwqdertm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cqrwqdertm .gt_left {
  text-align: left;
}

#cqrwqdertm .gt_center {
  text-align: center;
}

#cqrwqdertm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cqrwqdertm .gt_font_normal {
  font-weight: normal;
}

#cqrwqdertm .gt_font_bold {
  font-weight: bold;
}

#cqrwqdertm .gt_font_italic {
  font-style: italic;
}

#cqrwqdertm .gt_super {
  font-size: 65%;
}

#cqrwqdertm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cqrwqdertm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cqrwqdertm .gt_indent_1 {
  text-indent: 5px;
}

#cqrwqdertm .gt_indent_2 {
  text-indent: 10px;
}

#cqrwqdertm .gt_indent_3 {
  text-indent: 15px;
}

#cqrwqdertm .gt_indent_4 {
  text-indent: 20px;
}

#cqrwqdertm .gt_indent_5 {
  text-indent: 25px;
}

#cqrwqdertm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cqrwqdertm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">100</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #CD69C9; font-size: 20; font-weight: bolder;">0</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">120</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">100</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">20</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">120</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">80</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">20</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">70</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">80</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center">30</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">70</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong> Get the previous row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="pkdzjtherx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pkdzjtherx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pkdzjtherx thead, #pkdzjtherx tbody, #pkdzjtherx tfoot, #pkdzjtherx tr, #pkdzjtherx td, #pkdzjtherx th {
  border-style: none;
}

#pkdzjtherx p {
  margin: 0;
  padding: 0;
}

#pkdzjtherx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pkdzjtherx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pkdzjtherx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pkdzjtherx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pkdzjtherx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pkdzjtherx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pkdzjtherx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pkdzjtherx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pkdzjtherx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pkdzjtherx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pkdzjtherx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pkdzjtherx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pkdzjtherx .gt_spanner_row {
  border-bottom-style: hidden;
}

#pkdzjtherx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pkdzjtherx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pkdzjtherx .gt_from_md > :first-child {
  margin-top: 0;
}

#pkdzjtherx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pkdzjtherx .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pkdzjtherx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#pkdzjtherx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pkdzjtherx .gt_row_group_first td {
  border-top-width: 2px;
}

#pkdzjtherx .gt_row_group_first th {
  border-top-width: 2px;
}

#pkdzjtherx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkdzjtherx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pkdzjtherx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pkdzjtherx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pkdzjtherx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkdzjtherx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pkdzjtherx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pkdzjtherx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pkdzjtherx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pkdzjtherx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pkdzjtherx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkdzjtherx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pkdzjtherx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pkdzjtherx .gt_left {
  text-align: left;
}

#pkdzjtherx .gt_center {
  text-align: center;
}

#pkdzjtherx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pkdzjtherx .gt_font_normal {
  font-weight: normal;
}

#pkdzjtherx .gt_font_bold {
  font-weight: bold;
}

#pkdzjtherx .gt_font_italic {
  font-style: italic;
}

#pkdzjtherx .gt_super {
  font-size: 65%;
}

#pkdzjtherx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pkdzjtherx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pkdzjtherx .gt_indent_1 {
  text-indent: 5px;
}

#pkdzjtherx .gt_indent_2 {
  text-indent: 10px;
}

#pkdzjtherx .gt_indent_3 {
  text-indent: 15px;
}

#pkdzjtherx .gt_indent_4 {
  text-indent: 20px;
}

#pkdzjtherx .gt_indent_5 {
  text-indent: 25px;
}

#pkdzjtherx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pkdzjtherx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="partition-by-store_id" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="nnjtkrkqpx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nnjtkrkqpx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nnjtkrkqpx thead, #nnjtkrkqpx tbody, #nnjtkrkqpx tfoot, #nnjtkrkqpx tr, #nnjtkrkqpx td, #nnjtkrkqpx th {
  border-style: none;
}

#nnjtkrkqpx p {
  margin: 0;
  padding: 0;
}

#nnjtkrkqpx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nnjtkrkqpx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nnjtkrkqpx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nnjtkrkqpx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nnjtkrkqpx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nnjtkrkqpx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nnjtkrkqpx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nnjtkrkqpx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nnjtkrkqpx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nnjtkrkqpx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nnjtkrkqpx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nnjtkrkqpx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nnjtkrkqpx .gt_spanner_row {
  border-bottom-style: hidden;
}

#nnjtkrkqpx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nnjtkrkqpx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nnjtkrkqpx .gt_from_md > :first-child {
  margin-top: 0;
}

#nnjtkrkqpx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nnjtkrkqpx .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nnjtkrkqpx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#nnjtkrkqpx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nnjtkrkqpx .gt_row_group_first td {
  border-top-width: 2px;
}

#nnjtkrkqpx .gt_row_group_first th {
  border-top-width: 2px;
}

#nnjtkrkqpx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nnjtkrkqpx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nnjtkrkqpx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nnjtkrkqpx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nnjtkrkqpx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nnjtkrkqpx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nnjtkrkqpx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nnjtkrkqpx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nnjtkrkqpx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nnjtkrkqpx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nnjtkrkqpx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nnjtkrkqpx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nnjtkrkqpx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nnjtkrkqpx .gt_left {
  text-align: left;
}

#nnjtkrkqpx .gt_center {
  text-align: center;
}

#nnjtkrkqpx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nnjtkrkqpx .gt_font_normal {
  font-weight: normal;
}

#nnjtkrkqpx .gt_font_bold {
  font-weight: bold;
}

#nnjtkrkqpx .gt_font_italic {
  font-style: italic;
}

#nnjtkrkqpx .gt_super {
  font-size: 65%;
}

#nnjtkrkqpx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nnjtkrkqpx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nnjtkrkqpx .gt_indent_1 {
  text-indent: 5px;
}

#nnjtkrkqpx .gt_indent_2 {
  text-indent: 10px;
}

#nnjtkrkqpx .gt_indent_3 {
  text-indent: 15px;
}

#nnjtkrkqpx .gt_indent_4 {
  text-indent: 20px;
}

#nnjtkrkqpx .gt_indent_5 {
  text-indent: 25px;
}

#nnjtkrkqpx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nnjtkrkqpx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="lead" class="level3" data-number="7.2.7">
<h3 data-number="7.2.7" class="anchored" data-anchor-id="lead"><span class="header-section-number">7.2.7</span> LEAD</h3>
<p>The <code>LEAD()</code> function allows users to access data from subsequent rows in a result set. It is particularly useful for comparing values between the current row and one or more following rows.</p>
<section id="basic-syntax-1" class="level4" data-number="7.2.7.1">
<h4 data-number="7.2.7.1" class="anchored" data-anchor-id="basic-syntax-1"><span class="header-section-number">7.2.7.1</span> Basic syntax</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LEAD</span>(expression [, offset [, default_value]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><p><strong>expression:</strong> This is the column or expression whose value you want to retrieve from the following row.</p></li>
<li><p><strong>offset:</strong> This optional parameter specifies how many rows forward from the current row you want to look. If not specified, it defaults to 1.</p></li>
<li><p><strong>default_value:</strong> This optional parameter defines what value should be returned if there is no following row available (e.g., at the end of a dataset). By default, this is NULL.</p></li>
</ul>
</section>
<section id="quick-illustration-4" class="level4" data-number="7.2.7.2">
<h4 data-number="7.2.7.2" class="anchored" data-anchor-id="quick-illustration-4"><span class="header-section-number">7.2.7.2</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-29"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-29-1"><a href="#annotated-cell-29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-29-2"><a href="#annotated-cell-29-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>,</span>
<span id="annotated-cell-29-3"><a href="#annotated-cell-29-3" aria-hidden="true" tabindex="-1"></a>      product,</span>
<span id="annotated-cell-29-4"><a href="#annotated-cell-29-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="1">1</button><span id="annotated-cell-29-5" class="code-annotation-target"><a href="#annotated-cell-29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount) <span class="kw">AS</span> next_amount</span>
<span id="annotated-cell-29-6"><a href="#annotated-cell-29-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="5" data-code-annotation="1">retrieve the value from the next row in the amount column.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="mhihdvpctm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mhihdvpctm table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mhihdvpctm thead, #mhihdvpctm tbody, #mhihdvpctm tfoot, #mhihdvpctm tr, #mhihdvpctm td, #mhihdvpctm th {
  border-style: none;
}

#mhihdvpctm p {
  margin: 0;
  padding: 0;
}

#mhihdvpctm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mhihdvpctm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mhihdvpctm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mhihdvpctm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mhihdvpctm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhihdvpctm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhihdvpctm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mhihdvpctm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mhihdvpctm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mhihdvpctm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mhihdvpctm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mhihdvpctm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mhihdvpctm .gt_spanner_row {
  border-bottom-style: hidden;
}

#mhihdvpctm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mhihdvpctm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mhihdvpctm .gt_from_md > :first-child {
  margin-top: 0;
}

#mhihdvpctm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mhihdvpctm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mhihdvpctm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mhihdvpctm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mhihdvpctm .gt_row_group_first td {
  border-top-width: 2px;
}

#mhihdvpctm .gt_row_group_first th {
  border-top-width: 2px;
}

#mhihdvpctm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhihdvpctm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mhihdvpctm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mhihdvpctm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhihdvpctm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhihdvpctm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mhihdvpctm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mhihdvpctm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mhihdvpctm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mhihdvpctm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhihdvpctm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhihdvpctm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mhihdvpctm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mhihdvpctm .gt_left {
  text-align: left;
}

#mhihdvpctm .gt_center {
  text-align: center;
}

#mhihdvpctm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mhihdvpctm .gt_font_normal {
  font-weight: normal;
}

#mhihdvpctm .gt_font_bold {
  font-weight: bold;
}

#mhihdvpctm .gt_font_italic {
  font-style: italic;
}

#mhihdvpctm .gt_super {
  font-size: 65%;
}

#mhihdvpctm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mhihdvpctm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mhihdvpctm .gt_indent_1 {
  text-indent: 5px;
}

#mhihdvpctm .gt_indent_2 {
  text-indent: 10px;
}

#mhihdvpctm .gt_indent_3 {
  text-indent: 15px;
}

#mhihdvpctm .gt_indent_4 {
  text-indent: 20px;
}

#mhihdvpctm .gt_indent_5 {
  text-indent: 25px;
}

#mhihdvpctm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mhihdvpctm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="next_amount">next_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center">100</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">120</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">120</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">20</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">20</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">80</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">80</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">70</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">70</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">30</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">30</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #CD69C9; font-size: 20; font-weight: bolder;">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong> Get the next row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="tdxnvgsugx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tdxnvgsugx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tdxnvgsugx thead, #tdxnvgsugx tbody, #tdxnvgsugx tfoot, #tdxnvgsugx tr, #tdxnvgsugx td, #tdxnvgsugx th {
  border-style: none;
}

#tdxnvgsugx p {
  margin: 0;
  padding: 0;
}

#tdxnvgsugx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tdxnvgsugx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tdxnvgsugx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tdxnvgsugx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tdxnvgsugx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdxnvgsugx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdxnvgsugx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdxnvgsugx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tdxnvgsugx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tdxnvgsugx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tdxnvgsugx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tdxnvgsugx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tdxnvgsugx .gt_spanner_row {
  border-bottom-style: hidden;
}

#tdxnvgsugx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tdxnvgsugx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tdxnvgsugx .gt_from_md > :first-child {
  margin-top: 0;
}

#tdxnvgsugx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tdxnvgsugx .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tdxnvgsugx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#tdxnvgsugx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tdxnvgsugx .gt_row_group_first td {
  border-top-width: 2px;
}

#tdxnvgsugx .gt_row_group_first th {
  border-top-width: 2px;
}

#tdxnvgsugx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdxnvgsugx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tdxnvgsugx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tdxnvgsugx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdxnvgsugx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdxnvgsugx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tdxnvgsugx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tdxnvgsugx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tdxnvgsugx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdxnvgsugx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdxnvgsugx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdxnvgsugx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdxnvgsugx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdxnvgsugx .gt_left {
  text-align: left;
}

#tdxnvgsugx .gt_center {
  text-align: center;
}

#tdxnvgsugx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tdxnvgsugx .gt_font_normal {
  font-weight: normal;
}

#tdxnvgsugx .gt_font_bold {
  font-weight: bold;
}

#tdxnvgsugx .gt_font_italic {
  font-style: italic;
}

#tdxnvgsugx .gt_super {
  font-size: 65%;
}

#tdxnvgsugx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tdxnvgsugx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tdxnvgsugx .gt_indent_1 {
  text-indent: 5px;
}

#tdxnvgsugx .gt_indent_2 {
  text-indent: 10px;
}

#tdxnvgsugx .gt_indent_3 {
  text-indent: 15px;
}

#tdxnvgsugx .gt_indent_4 {
  text-indent: 20px;
}

#tdxnvgsugx .gt_indent_5 {
  text-indent: 25px;
}

#tdxnvgsugx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tdxnvgsugx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="partition-by-store_id-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id-1">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fmpbzrmtfd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fmpbzrmtfd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fmpbzrmtfd thead, #fmpbzrmtfd tbody, #fmpbzrmtfd tfoot, #fmpbzrmtfd tr, #fmpbzrmtfd td, #fmpbzrmtfd th {
  border-style: none;
}

#fmpbzrmtfd p {
  margin: 0;
  padding: 0;
}

#fmpbzrmtfd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fmpbzrmtfd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fmpbzrmtfd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fmpbzrmtfd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fmpbzrmtfd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fmpbzrmtfd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmpbzrmtfd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fmpbzrmtfd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fmpbzrmtfd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fmpbzrmtfd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fmpbzrmtfd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fmpbzrmtfd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fmpbzrmtfd .gt_spanner_row {
  border-bottom-style: hidden;
}

#fmpbzrmtfd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fmpbzrmtfd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fmpbzrmtfd .gt_from_md > :first-child {
  margin-top: 0;
}

#fmpbzrmtfd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fmpbzrmtfd .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fmpbzrmtfd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#fmpbzrmtfd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fmpbzrmtfd .gt_row_group_first td {
  border-top-width: 2px;
}

#fmpbzrmtfd .gt_row_group_first th {
  border-top-width: 2px;
}

#fmpbzrmtfd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmpbzrmtfd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fmpbzrmtfd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fmpbzrmtfd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmpbzrmtfd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmpbzrmtfd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fmpbzrmtfd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fmpbzrmtfd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fmpbzrmtfd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fmpbzrmtfd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fmpbzrmtfd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmpbzrmtfd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fmpbzrmtfd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fmpbzrmtfd .gt_left {
  text-align: left;
}

#fmpbzrmtfd .gt_center {
  text-align: center;
}

#fmpbzrmtfd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fmpbzrmtfd .gt_font_normal {
  font-weight: normal;
}

#fmpbzrmtfd .gt_font_bold {
  font-weight: bold;
}

#fmpbzrmtfd .gt_font_italic {
  font-style: italic;
}

#fmpbzrmtfd .gt_super {
  font-size: 65%;
}

#fmpbzrmtfd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fmpbzrmtfd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fmpbzrmtfd .gt_indent_1 {
  text-indent: 5px;
}

#fmpbzrmtfd .gt_indent_2 {
  text-indent: 10px;
}

#fmpbzrmtfd .gt_indent_3 {
  text-indent: 15px;
}

#fmpbzrmtfd .gt_indent_4 {
  text-indent: 20px;
}

#fmpbzrmtfd .gt_indent_5 {
  text-indent: 25px;
}

#fmpbzrmtfd .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fmpbzrmtfd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="combining-multiple-window-functions" class="level3" data-number="7.2.8">
<h3 data-number="7.2.8" class="anchored" data-anchor-id="combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</h3>
<p>You can combine multiple window functions in a single query.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> row_num,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> total_amount,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>This query assigns a row number, calculates the total amount per store, and retrieves the previous amount for each sale.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>FRAME</code> Clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AVG</span>(sale) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2 <span class="kw">ORDER</span> <span class="kw">BY</span> col_name3 <span class="kw">ROWS</span> <span class="kw">BETWEEN</span> <span class="kw">CURRENT</span> <span class="kw">ROW</span> <span class="kw">AND</span> <span class="kw">UNBOUNDED</span> <span class="kw">PRECEDING</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><strong>ROWS:</strong> The frame type. values such as ROWS or RANGE</li>
<li><strong>CURRENT ROW:</strong> The frame boundary (Lower value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING</li>
<li><strong>UNBOUNDED PRECEDING:</strong> The frame Boundary (Higher value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING.</li>
</ul>
<p><br></p>
<p><strong>Rules:</strong> - You can only use the Frame clause with Order by clause.</p>
<ul>
<li>The lower value should be placed before the higher value.</li>
</ul>
</div>
</div>
</div>
<p><br> <br> <br></p>
<!------- Window Function -------------------------------------------------->
</section>
</section>
<section id="task" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="task"><span class="header-section-number">7.3</span> Task</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./sql_data_cleaning.html" class="pagination-link" aria-label="Data Cleaning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sql_join.html" class="pagination-link" aria-label="Joins">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>