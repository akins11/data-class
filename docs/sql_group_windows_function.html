<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Grouping Data – Data Analysis Tools</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sql_join.html" rel="next">
<link href="./sql_data_cleaning.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Analysis Tools</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sql_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_creating_database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Creating Database</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_statement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Query Statement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_text_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with Text</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_date_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with Date</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_group_windows_function.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_join.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_sub_queries_cte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subquery &amp; CTE</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Project</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./python_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./powerbi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power BI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./powerbi_data_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool_source.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data Tool Referenece</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#group-by" id="toc-group-by" class="nav-link active" data-scroll-target="#group-by"><span class="header-section-number">7.1</span> GROUP BY</a>
  <ul class="collapse">
  <li><a href="#quick-illustration-of-group-by" id="toc-quick-illustration-of-group-by" class="nav-link" data-scroll-target="#quick-illustration-of-group-by">Quick illustration of GROUP BY:</a></li>
  <li><a href="#simple-group-by-with-count" id="toc-simple-group-by-with-count" class="nav-link" data-scroll-target="#simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></a></li>
  <li><a href="#group-by-with-multiple-columns" id="toc-group-by-with-multiple-columns" class="nav-link" data-scroll-target="#group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</a></li>
  <li><a href="#using-aggregate-functions" id="toc-using-aggregate-functions" class="nav-link" data-scroll-target="#using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</a></li>
  <li><a href="#having-clause-with-group-by" id="toc-having-clause-with-group-by" class="nav-link" data-scroll-target="#having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</a></li>
  <li><a href="#group-by-with-date" id="toc-group-by-with-date" class="nav-link" data-scroll-target="#group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></a></li>
  <li><a href="#group-by-with-expressions" id="toc-group-by-with-expressions" class="nav-link" data-scroll-target="#group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</a></li>
  <li><a href="#group-by-with-order-by" id="toc-group-by-with-order-by" class="nav-link" data-scroll-target="#group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></a></li>
  <li><a href="#grouping-with-a-conditional-aggregate" id="toc-grouping-with-a-conditional-aggregate" class="nav-link" data-scroll-target="#grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</a></li>
  </ul></li>
  <li><a href="#window-function" id="toc-window-function" class="nav-link" data-scroll-target="#window-function"><span class="header-section-number">7.2</span> Window Function</a>
  <ul class="collapse">
  <li><a href="#row_number" id="toc-row_number" class="nav-link" data-scroll-target="#row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</a></li>
  <li><a href="#quick-illustration-of-window-function" id="toc-quick-illustration-of-window-function" class="nav-link" data-scroll-target="#quick-illustration-of-window-function">Quick illustration of window function</a></li>
  <li><a href="#aggregate-function-sum-as-a-window-function" id="toc-aggregate-function-sum-as-a-window-function" class="nav-link" data-scroll-target="#aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</a></li>
  <li><a href="#rank" id="toc-rank" class="nav-link" data-scroll-target="#rank"><span class="header-section-number">7.2.3</span> RANK</a></li>
  <li><a href="#dense_rank" id="toc-dense_rank" class="nav-link" data-scroll-target="#dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</a></li>
  <li><a href="#ntile" id="toc-ntile" class="nav-link" data-scroll-target="#ntile"><span class="header-section-number">7.2.5</span> NTILE</a></li>
  <li><a href="#lag" id="toc-lag" class="nav-link" data-scroll-target="#lag"><span class="header-section-number">7.2.6</span> LAG</a></li>
  <li><a href="#lead" id="toc-lead" class="nav-link" data-scroll-target="#lead"><span class="header-section-number">7.2.7</span> LEAD</a></li>
  <li><a href="#combining-multiple-window-functions" id="toc-combining-multiple-window-functions" class="nav-link" data-scroll-target="#combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</a></li>
  </ul></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task"><span class="header-section-number">7.3</span> Task</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="group-by" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="group-by"><span class="header-section-number">7.1</span> GROUP BY</h2>
<p>The <code>GROUP BY</code> clause is used to arrange identical data into groups. It is often used with aggregate functions such as <code>COUNT()</code>, <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code>, and <code>MIN()</code> to perform operations on each group of data.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Basic Syntax</span></span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name1, aggregate_function(column_column2)</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-5" class="code-annotation-target"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> column_name1;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3" data-code-annotation="1">aggregate_function like <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code> etc.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="5" data-code-annotation="2">The name of the column to group the table by.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts of the <code>GROUP BY</code> clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>The <code>GROUP BY</code> clause groups rows that have the same values in specified columns into summary rows.</p></li>
<li><p>Functions such as <code>COUNT</code>, <code>SUM</code>, <code>AVG</code>, <code>MAX</code>, and <code>MIN</code> are commonly used with <code>GROUP BY</code> <strong>to perform calculations on each group</strong>.</p></li>
<li><p>The <code>HAVING</code> clause is used to filter groups based on conditions, similar to how <code>WHERE</code> filters rows.</p></li>
</ul>
</div>
</div>
</div>
<section id="example-table-sales" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-table-sales">Example Table: Sales</h4>
<div class="cell">
<div class="cell-output-display">
<div id="arrkpcaees" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#arrkpcaees table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#arrkpcaees thead, #arrkpcaees tbody, #arrkpcaees tfoot, #arrkpcaees tr, #arrkpcaees td, #arrkpcaees th {
  border-style: none;
}

#arrkpcaees p {
  margin: 0;
  padding: 0;
}

#arrkpcaees .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#arrkpcaees .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#arrkpcaees .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#arrkpcaees .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#arrkpcaees .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#arrkpcaees .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#arrkpcaees .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#arrkpcaees .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#arrkpcaees .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#arrkpcaees .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#arrkpcaees .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#arrkpcaees .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#arrkpcaees .gt_spanner_row {
  border-bottom-style: hidden;
}

#arrkpcaees .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#arrkpcaees .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#arrkpcaees .gt_from_md > :first-child {
  margin-top: 0;
}

#arrkpcaees .gt_from_md > :last-child {
  margin-bottom: 0;
}

#arrkpcaees .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#arrkpcaees .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#arrkpcaees .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#arrkpcaees .gt_row_group_first td {
  border-top-width: 2px;
}

#arrkpcaees .gt_row_group_first th {
  border-top-width: 2px;
}

#arrkpcaees .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#arrkpcaees .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#arrkpcaees .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#arrkpcaees .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#arrkpcaees .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#arrkpcaees .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#arrkpcaees .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#arrkpcaees .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#arrkpcaees .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#arrkpcaees .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#arrkpcaees .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#arrkpcaees .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#arrkpcaees .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#arrkpcaees .gt_left {
  text-align: left;
}

#arrkpcaees .gt_center {
  text-align: center;
}

#arrkpcaees .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#arrkpcaees .gt_font_normal {
  font-weight: normal;
}

#arrkpcaees .gt_font_bold {
  font-weight: bold;
}

#arrkpcaees .gt_font_italic {
  font-style: italic;
}

#arrkpcaees .gt_super {
  font-size: 65%;
}

#arrkpcaees .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#arrkpcaees .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#arrkpcaees .gt_indent_1 {
  text-indent: 5px;
}

#arrkpcaees .gt_indent_2 {
  text-indent: 10px;
}

#arrkpcaees .gt_indent_3 {
  text-indent: 15px;
}

#arrkpcaees .gt_indent_4 {
  text-indent: 20px;
}

#arrkpcaees .gt_indent_5 {
  text-indent: 25px;
}

#arrkpcaees .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#arrkpcaees div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="quick-illustration-of-group-by" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-group-by">Quick illustration of GROUP BY:</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To count the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-2" class="code-annotation-target"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="haigwwxeuq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#haigwwxeuq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#haigwwxeuq thead, #haigwwxeuq tbody, #haigwwxeuq tfoot, #haigwwxeuq tr, #haigwwxeuq td, #haigwwxeuq th {
  border-style: none;
}

#haigwwxeuq p {
  margin: 0;
  padding: 0;
}

#haigwwxeuq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#haigwwxeuq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#haigwwxeuq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#haigwwxeuq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#haigwwxeuq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#haigwwxeuq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#haigwwxeuq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#haigwwxeuq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#haigwwxeuq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#haigwwxeuq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#haigwwxeuq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#haigwwxeuq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#haigwwxeuq .gt_spanner_row {
  border-bottom-style: hidden;
}

#haigwwxeuq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#haigwwxeuq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#haigwwxeuq .gt_from_md > :first-child {
  margin-top: 0;
}

#haigwwxeuq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#haigwwxeuq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#haigwwxeuq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#haigwwxeuq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#haigwwxeuq .gt_row_group_first td {
  border-top-width: 2px;
}

#haigwwxeuq .gt_row_group_first th {
  border-top-width: 2px;
}

#haigwwxeuq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#haigwwxeuq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#haigwwxeuq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#haigwwxeuq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#haigwwxeuq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#haigwwxeuq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#haigwwxeuq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#haigwwxeuq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#haigwwxeuq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#haigwwxeuq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#haigwwxeuq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#haigwwxeuq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#haigwwxeuq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#haigwwxeuq .gt_left {
  text-align: left;
}

#haigwwxeuq .gt_center {
  text-align: center;
}

#haigwwxeuq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#haigwwxeuq .gt_font_normal {
  font-weight: normal;
}

#haigwwxeuq .gt_font_bold {
  font-weight: bold;
}

#haigwwxeuq .gt_font_italic {
  font-style: italic;
}

#haigwwxeuq .gt_super {
  font-size: 65%;
}

#haigwwxeuq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#haigwwxeuq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#haigwwxeuq .gt_indent_1 {
  text-indent: 5px;
}

#haigwwxeuq .gt_indent_2 {
  text-indent: 10px;
}

#haigwwxeuq .gt_indent_3 {
  text-indent: 15px;
}

#haigwwxeuq .gt_indent_4 {
  text-indent: 20px;
}

#haigwwxeuq .gt_indent_5 {
  text-indent: 25px;
}

#haigwwxeuq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#haigwwxeuq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="ceybjwuvfq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ceybjwuvfq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ceybjwuvfq thead, #ceybjwuvfq tbody, #ceybjwuvfq tfoot, #ceybjwuvfq tr, #ceybjwuvfq td, #ceybjwuvfq th {
  border-style: none;
}

#ceybjwuvfq p {
  margin: 0;
  padding: 0;
}

#ceybjwuvfq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ceybjwuvfq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ceybjwuvfq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ceybjwuvfq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ceybjwuvfq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ceybjwuvfq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ceybjwuvfq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ceybjwuvfq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ceybjwuvfq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ceybjwuvfq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ceybjwuvfq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ceybjwuvfq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ceybjwuvfq .gt_spanner_row {
  border-bottom-style: hidden;
}

#ceybjwuvfq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ceybjwuvfq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ceybjwuvfq .gt_from_md > :first-child {
  margin-top: 0;
}

#ceybjwuvfq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ceybjwuvfq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ceybjwuvfq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ceybjwuvfq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ceybjwuvfq .gt_row_group_first td {
  border-top-width: 2px;
}

#ceybjwuvfq .gt_row_group_first th {
  border-top-width: 2px;
}

#ceybjwuvfq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceybjwuvfq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ceybjwuvfq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ceybjwuvfq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ceybjwuvfq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceybjwuvfq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ceybjwuvfq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ceybjwuvfq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ceybjwuvfq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ceybjwuvfq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ceybjwuvfq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceybjwuvfq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ceybjwuvfq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ceybjwuvfq .gt_left {
  text-align: left;
}

#ceybjwuvfq .gt_center {
  text-align: center;
}

#ceybjwuvfq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ceybjwuvfq .gt_font_normal {
  font-weight: normal;
}

#ceybjwuvfq .gt_font_bold {
  font-weight: bold;
}

#ceybjwuvfq .gt_font_italic {
  font-style: italic;
}

#ceybjwuvfq .gt_super {
  font-size: 65%;
}

#ceybjwuvfq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ceybjwuvfq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ceybjwuvfq .gt_indent_1 {
  text-indent: 5px;
}

#ceybjwuvfq .gt_indent_2 {
  text-indent: 10px;
}

#ceybjwuvfq .gt_indent_3 {
  text-indent: 15px;
}

#ceybjwuvfq .gt_indent_4 {
  text-indent: 20px;
}

#ceybjwuvfq .gt_indent_5 {
  text-indent: 25px;
}

#ceybjwuvfq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ceybjwuvfq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="simple-group-by-with-count" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To count the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-2" class="code-annotation-target"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="baaxzddyzf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#baaxzddyzf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#baaxzddyzf thead, #baaxzddyzf tbody, #baaxzddyzf tfoot, #baaxzddyzf tr, #baaxzddyzf td, #baaxzddyzf th {
  border-style: none;
}

#baaxzddyzf p {
  margin: 0;
  padding: 0;
}

#baaxzddyzf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#baaxzddyzf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#baaxzddyzf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#baaxzddyzf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#baaxzddyzf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#baaxzddyzf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#baaxzddyzf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#baaxzddyzf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#baaxzddyzf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#baaxzddyzf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#baaxzddyzf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#baaxzddyzf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#baaxzddyzf .gt_spanner_row {
  border-bottom-style: hidden;
}

#baaxzddyzf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#baaxzddyzf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#baaxzddyzf .gt_from_md > :first-child {
  margin-top: 0;
}

#baaxzddyzf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#baaxzddyzf .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#baaxzddyzf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#baaxzddyzf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#baaxzddyzf .gt_row_group_first td {
  border-top-width: 2px;
}

#baaxzddyzf .gt_row_group_first th {
  border-top-width: 2px;
}

#baaxzddyzf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#baaxzddyzf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#baaxzddyzf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#baaxzddyzf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#baaxzddyzf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#baaxzddyzf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#baaxzddyzf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#baaxzddyzf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#baaxzddyzf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#baaxzddyzf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#baaxzddyzf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#baaxzddyzf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#baaxzddyzf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#baaxzddyzf .gt_left {
  text-align: left;
}

#baaxzddyzf .gt_center {
  text-align: center;
}

#baaxzddyzf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#baaxzddyzf .gt_font_normal {
  font-weight: normal;
}

#baaxzddyzf .gt_font_bold {
  font-weight: bold;
}

#baaxzddyzf .gt_font_italic {
  font-style: italic;
}

#baaxzddyzf .gt_super {
  font-size: 65%;
}

#baaxzddyzf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#baaxzddyzf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#baaxzddyzf .gt_indent_1 {
  text-indent: 5px;
}

#baaxzddyzf .gt_indent_2 {
  text-indent: 10px;
}

#baaxzddyzf .gt_indent_3 {
  text-indent: 15px;
}

#baaxzddyzf .gt_indent_4 {
  text-indent: 20px;
}

#baaxzddyzf .gt_indent_5 {
  text-indent: 25px;
}

#baaxzddyzf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#baaxzddyzf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_number_of_sales" class="gt_row gt_center">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_number_of_sales" class="gt_row gt_center">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="group-by-with-multiple-columns" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</h3>
<p>Grouping by multiple columns can give more <em>granular summaries</em>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- count the number of sales per store and product:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, product_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id, product_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store and product id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="peuvzgkjix" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#peuvzgkjix table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#peuvzgkjix thead, #peuvzgkjix tbody, #peuvzgkjix tfoot, #peuvzgkjix tr, #peuvzgkjix td, #peuvzgkjix th {
  border-style: none;
}

#peuvzgkjix p {
  margin: 0;
  padding: 0;
}

#peuvzgkjix .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#peuvzgkjix .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#peuvzgkjix .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#peuvzgkjix .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#peuvzgkjix .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#peuvzgkjix .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#peuvzgkjix .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#peuvzgkjix .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#peuvzgkjix .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#peuvzgkjix .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#peuvzgkjix .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#peuvzgkjix .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#peuvzgkjix .gt_spanner_row {
  border-bottom-style: hidden;
}

#peuvzgkjix .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#peuvzgkjix .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#peuvzgkjix .gt_from_md > :first-child {
  margin-top: 0;
}

#peuvzgkjix .gt_from_md > :last-child {
  margin-bottom: 0;
}

#peuvzgkjix .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#peuvzgkjix .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#peuvzgkjix .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#peuvzgkjix .gt_row_group_first td {
  border-top-width: 2px;
}

#peuvzgkjix .gt_row_group_first th {
  border-top-width: 2px;
}

#peuvzgkjix .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#peuvzgkjix .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#peuvzgkjix .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#peuvzgkjix .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#peuvzgkjix .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#peuvzgkjix .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#peuvzgkjix .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#peuvzgkjix .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#peuvzgkjix .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#peuvzgkjix .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#peuvzgkjix .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#peuvzgkjix .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#peuvzgkjix .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#peuvzgkjix .gt_left {
  text-align: left;
}

#peuvzgkjix .gt_center {
  text-align: center;
}

#peuvzgkjix .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#peuvzgkjix .gt_font_normal {
  font-weight: normal;
}

#peuvzgkjix .gt_font_bold {
  font-weight: bold;
}

#peuvzgkjix .gt_font_italic {
  font-style: italic;
}

#peuvzgkjix .gt_super {
  font-size: 65%;
}

#peuvzgkjix .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#peuvzgkjix .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#peuvzgkjix .gt_indent_1 {
  text-indent: 5px;
}

#peuvzgkjix .gt_indent_2 {
  text-indent: 10px;
}

#peuvzgkjix .gt_indent_3 {
  text-indent: 15px;
}

#peuvzgkjix .gt_indent_4 {
  text-indent: 20px;
}

#peuvzgkjix .gt_indent_5 {
  text-indent: 25px;
}

#peuvzgkjix .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#peuvzgkjix div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="using-aggregate-functions" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Calculate the average amount of sales per store:</span></span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, </span>
<span id="annotated-cell-5-3"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(amount) <span class="kw">AS</span> <span class="fu">count</span>,</span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MIN</span>(amount) <span class="kw">AS</span>, lowest_amount,</span>
<span id="annotated-cell-5-5"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(amount) <span class="kw">AS</span> average_amount, </span>
<span id="annotated-cell-5-6"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MAX</span>(amount) <span class="kw">AS</span> highest_amount,</span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_anount</span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2">2</button><span id="annotated-cell-5-9" class="code-annotation-target"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="9" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="wfgaqvfebe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wfgaqvfebe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wfgaqvfebe thead, #wfgaqvfebe tbody, #wfgaqvfebe tfoot, #wfgaqvfebe tr, #wfgaqvfebe td, #wfgaqvfebe th {
  border-style: none;
}

#wfgaqvfebe p {
  margin: 0;
  padding: 0;
}

#wfgaqvfebe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wfgaqvfebe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wfgaqvfebe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wfgaqvfebe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wfgaqvfebe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wfgaqvfebe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wfgaqvfebe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wfgaqvfebe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wfgaqvfebe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wfgaqvfebe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wfgaqvfebe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wfgaqvfebe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wfgaqvfebe .gt_spanner_row {
  border-bottom-style: hidden;
}

#wfgaqvfebe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wfgaqvfebe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wfgaqvfebe .gt_from_md > :first-child {
  margin-top: 0;
}

#wfgaqvfebe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wfgaqvfebe .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wfgaqvfebe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#wfgaqvfebe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wfgaqvfebe .gt_row_group_first td {
  border-top-width: 2px;
}

#wfgaqvfebe .gt_row_group_first th {
  border-top-width: 2px;
}

#wfgaqvfebe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wfgaqvfebe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wfgaqvfebe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wfgaqvfebe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wfgaqvfebe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wfgaqvfebe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wfgaqvfebe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wfgaqvfebe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wfgaqvfebe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wfgaqvfebe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wfgaqvfebe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wfgaqvfebe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wfgaqvfebe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wfgaqvfebe .gt_left {
  text-align: left;
}

#wfgaqvfebe .gt_center {
  text-align: center;
}

#wfgaqvfebe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wfgaqvfebe .gt_font_normal {
  font-weight: normal;
}

#wfgaqvfebe .gt_font_bold {
  font-weight: bold;
}

#wfgaqvfebe .gt_font_italic {
  font-style: italic;
}

#wfgaqvfebe .gt_super {
  font-size: 65%;
}

#wfgaqvfebe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wfgaqvfebe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wfgaqvfebe .gt_indent_1 {
  text-indent: 5px;
}

#wfgaqvfebe .gt_indent_2 {
  text-indent: 10px;
}

#wfgaqvfebe .gt_indent_3 {
  text-indent: 15px;
}

#wfgaqvfebe .gt_indent_4 {
  text-indent: 20px;
}

#wfgaqvfebe .gt_indent_5 {
  text-indent: 25px;
}

#wfgaqvfebe .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wfgaqvfebe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="count">count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lowest_amount">lowest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="average_amount">average_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="highest_amount">highest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="count" class="gt_row gt_right">4</td>
<td headers="lowest_amount" class="gt_row gt_right">100</td>
<td headers="average_amount" class="gt_row gt_right">225</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="count" class="gt_row gt_right">3</td>
<td headers="lowest_amount" class="gt_row gt_right">200</td>
<td headers="average_amount" class="gt_row gt_right">200</td>
<td headers="highest_amount" class="gt_row gt_right">200</td>
<td headers="total_amount" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="count" class="gt_row gt_right">5</td>
<td headers="lowest_amount" class="gt_row gt_right">150</td>
<td headers="average_amount" class="gt_row gt_right">250</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="having-clause-with-group-by" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</h3>
<p>The <code>HAVING</code> clause is used to filter groups <strong>after the aggregation</strong>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find stores with total sales greater than N300:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-2" class="code-annotation-target"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-6-3"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2">2</button><span id="annotated-cell-6-4" class="code-annotation-target"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="3">3</button><span id="annotated-cell-6-5" class="code-annotation-target"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">300</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="5" data-code-annotation="3">Filter all total_sales_amount greater than 300.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="mtrxgpmmgg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mtrxgpmmgg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mtrxgpmmgg thead, #mtrxgpmmgg tbody, #mtrxgpmmgg tfoot, #mtrxgpmmgg tr, #mtrxgpmmgg td, #mtrxgpmmgg th {
  border-style: none;
}

#mtrxgpmmgg p {
  margin: 0;
  padding: 0;
}

#mtrxgpmmgg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mtrxgpmmgg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mtrxgpmmgg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mtrxgpmmgg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mtrxgpmmgg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mtrxgpmmgg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mtrxgpmmgg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mtrxgpmmgg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mtrxgpmmgg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mtrxgpmmgg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mtrxgpmmgg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mtrxgpmmgg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mtrxgpmmgg .gt_spanner_row {
  border-bottom-style: hidden;
}

#mtrxgpmmgg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mtrxgpmmgg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mtrxgpmmgg .gt_from_md > :first-child {
  margin-top: 0;
}

#mtrxgpmmgg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mtrxgpmmgg .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mtrxgpmmgg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#mtrxgpmmgg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mtrxgpmmgg .gt_row_group_first td {
  border-top-width: 2px;
}

#mtrxgpmmgg .gt_row_group_first th {
  border-top-width: 2px;
}

#mtrxgpmmgg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mtrxgpmmgg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mtrxgpmmgg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mtrxgpmmgg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mtrxgpmmgg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mtrxgpmmgg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mtrxgpmmgg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mtrxgpmmgg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mtrxgpmmgg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mtrxgpmmgg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mtrxgpmmgg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mtrxgpmmgg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mtrxgpmmgg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mtrxgpmmgg .gt_left {
  text-align: left;
}

#mtrxgpmmgg .gt_center {
  text-align: center;
}

#mtrxgpmmgg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mtrxgpmmgg .gt_font_normal {
  font-weight: normal;
}

#mtrxgpmmgg .gt_font_bold {
  font-weight: bold;
}

#mtrxgpmmgg .gt_font_italic {
  font-style: italic;
}

#mtrxgpmmgg .gt_super {
  font-size: 65%;
}

#mtrxgpmmgg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mtrxgpmmgg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mtrxgpmmgg .gt_indent_1 {
  text-indent: 5px;
}

#mtrxgpmmgg .gt_indent_2 {
  text-indent: 10px;
}

#mtrxgpmmgg .gt_indent_3 {
  text-indent: 15px;
}

#mtrxgpmmgg .gt_indent_4 {
  text-indent: 20px;
}

#mtrxgpmmgg .gt_indent_5 {
  text-indent: 25px;
}

#mtrxgpmmgg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mtrxgpmmgg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_left">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_left">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_left">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="group-by-with-date" class="level3" data-number="7.1.5">
<h3 data-number="7.1.5" class="anchored" data-anchor-id="group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></h3>
<p>You can also group by date or time intervals.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find the total sales per day:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1">1</button><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_date, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-7-3"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> sales_date;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="2">Group all rows by each unique date (day).</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="nzrjqlkpef" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nzrjqlkpef table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nzrjqlkpef thead, #nzrjqlkpef tbody, #nzrjqlkpef tfoot, #nzrjqlkpef tr, #nzrjqlkpef td, #nzrjqlkpef th {
  border-style: none;
}

#nzrjqlkpef p {
  margin: 0;
  padding: 0;
}

#nzrjqlkpef .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nzrjqlkpef .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nzrjqlkpef .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nzrjqlkpef .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nzrjqlkpef .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nzrjqlkpef .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzrjqlkpef .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nzrjqlkpef .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nzrjqlkpef .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nzrjqlkpef .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nzrjqlkpef .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nzrjqlkpef .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nzrjqlkpef .gt_spanner_row {
  border-bottom-style: hidden;
}

#nzrjqlkpef .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nzrjqlkpef .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nzrjqlkpef .gt_from_md > :first-child {
  margin-top: 0;
}

#nzrjqlkpef .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nzrjqlkpef .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nzrjqlkpef .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#nzrjqlkpef .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nzrjqlkpef .gt_row_group_first td {
  border-top-width: 2px;
}

#nzrjqlkpef .gt_row_group_first th {
  border-top-width: 2px;
}

#nzrjqlkpef .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzrjqlkpef .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nzrjqlkpef .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nzrjqlkpef .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzrjqlkpef .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzrjqlkpef .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nzrjqlkpef .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nzrjqlkpef .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nzrjqlkpef .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nzrjqlkpef .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nzrjqlkpef .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzrjqlkpef .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nzrjqlkpef .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nzrjqlkpef .gt_left {
  text-align: left;
}

#nzrjqlkpef .gt_center {
  text-align: center;
}

#nzrjqlkpef .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nzrjqlkpef .gt_font_normal {
  font-weight: normal;
}

#nzrjqlkpef .gt_font_bold {
  font-weight: bold;
}

#nzrjqlkpef .gt_font_italic {
  font-style: italic;
}

#nzrjqlkpef .gt_super {
  font-size: 65%;
}

#nzrjqlkpef .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nzrjqlkpef .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nzrjqlkpef .gt_indent_1 {
  text-indent: 5px;
}

#nzrjqlkpef .gt_indent_2 {
  text-indent: 10px;
}

#nzrjqlkpef .gt_indent_3 {
  text-indent: 15px;
}

#nzrjqlkpef .gt_indent_4 {
  text-indent: 20px;
}

#nzrjqlkpef .gt_indent_5 {
  text-indent: 25px;
}

#nzrjqlkpef .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nzrjqlkpef div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="daily_sales" class="gt_row gt_center">250</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="daily_sales" class="gt_row gt_center">600</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="daily_sales" class="gt_row gt_center">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-expressions" class="level3" data-number="7.1.6">
<h3 data-number="7.1.6" class="anchored" data-anchor-id="group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</h3>
<p>You can also use expressions or functions in <code>GROUP BY</code></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Group by the year of the sales date:</span></span>
<span id="annotated-cell-8-2"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date) <span class="kw">AS</span> sales_day,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-5" class="code-annotation-target"><a href="#annotated-cell-8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-8-6"><a href="#annotated-cell-8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="3">3</button><span id="annotated-cell-8-7" class="code-annotation-target"><a href="#annotated-cell-8-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date);</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="1">Extract the day from the date.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="5" data-code-annotation="2">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="7" data-code-annotation="3">Group all rows by each unique day.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ainjuzldpj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ainjuzldpj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ainjuzldpj thead, #ainjuzldpj tbody, #ainjuzldpj tfoot, #ainjuzldpj tr, #ainjuzldpj td, #ainjuzldpj th {
  border-style: none;
}

#ainjuzldpj p {
  margin: 0;
  padding: 0;
}

#ainjuzldpj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ainjuzldpj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ainjuzldpj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ainjuzldpj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ainjuzldpj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ainjuzldpj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ainjuzldpj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ainjuzldpj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ainjuzldpj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ainjuzldpj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ainjuzldpj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ainjuzldpj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ainjuzldpj .gt_spanner_row {
  border-bottom-style: hidden;
}

#ainjuzldpj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ainjuzldpj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ainjuzldpj .gt_from_md > :first-child {
  margin-top: 0;
}

#ainjuzldpj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ainjuzldpj .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ainjuzldpj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#ainjuzldpj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ainjuzldpj .gt_row_group_first td {
  border-top-width: 2px;
}

#ainjuzldpj .gt_row_group_first th {
  border-top-width: 2px;
}

#ainjuzldpj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ainjuzldpj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ainjuzldpj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ainjuzldpj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ainjuzldpj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ainjuzldpj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ainjuzldpj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ainjuzldpj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ainjuzldpj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ainjuzldpj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ainjuzldpj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ainjuzldpj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ainjuzldpj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ainjuzldpj .gt_left {
  text-align: left;
}

#ainjuzldpj .gt_center {
  text-align: center;
}

#ainjuzldpj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ainjuzldpj .gt_font_normal {
  font-weight: normal;
}

#ainjuzldpj .gt_font_bold {
  font-weight: bold;
}

#ainjuzldpj .gt_font_italic {
  font-style: italic;
}

#ainjuzldpj .gt_super {
  font-size: 65%;
}

#ainjuzldpj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ainjuzldpj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ainjuzldpj .gt_indent_1 {
  text-indent: 5px;
}

#ainjuzldpj .gt_indent_2 {
  text-indent: 10px;
}

#ainjuzldpj .gt_indent_3 {
  text-indent: 15px;
}

#ainjuzldpj .gt_indent_4 {
  text-indent: 20px;
}

#ainjuzldpj .gt_indent_5 {
  text-indent: 25px;
}

#ainjuzldpj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ainjuzldpj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="sales_day">sales_day</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">1</td>
<td headers="daily_sales" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">2</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">3</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">4</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">5</td>
<td headers="daily_sales" class="gt_row gt_right">600</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">6</td>
<td headers="daily_sales" class="gt_row gt_right">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-order-by" class="level3" data-number="7.1.7">
<h3 data-number="7.1.7" class="anchored" data-anchor-id="group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></h3>
<p>You can order the results of a <code>GROUP BY</code> query by the aggregated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-3" class="code-annotation-target"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-9-4"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2">2</button><span id="annotated-cell-9-5" class="code-annotation-target"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3">3</button><span id="annotated-cell-9-6" class="code-annotation-target"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_sales_amount <span class="kw">DESC</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="3" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="5" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="6" data-code-annotation="3">Sort the aggregated output by the total sales amount in descending order.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="nncvzsjpjx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nncvzsjpjx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nncvzsjpjx thead, #nncvzsjpjx tbody, #nncvzsjpjx tfoot, #nncvzsjpjx tr, #nncvzsjpjx td, #nncvzsjpjx th {
  border-style: none;
}

#nncvzsjpjx p {
  margin: 0;
  padding: 0;
}

#nncvzsjpjx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nncvzsjpjx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nncvzsjpjx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nncvzsjpjx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nncvzsjpjx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nncvzsjpjx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nncvzsjpjx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nncvzsjpjx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nncvzsjpjx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nncvzsjpjx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nncvzsjpjx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nncvzsjpjx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nncvzsjpjx .gt_spanner_row {
  border-bottom-style: hidden;
}

#nncvzsjpjx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nncvzsjpjx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nncvzsjpjx .gt_from_md > :first-child {
  margin-top: 0;
}

#nncvzsjpjx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nncvzsjpjx .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nncvzsjpjx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#nncvzsjpjx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nncvzsjpjx .gt_row_group_first td {
  border-top-width: 2px;
}

#nncvzsjpjx .gt_row_group_first th {
  border-top-width: 2px;
}

#nncvzsjpjx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nncvzsjpjx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nncvzsjpjx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nncvzsjpjx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nncvzsjpjx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nncvzsjpjx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nncvzsjpjx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nncvzsjpjx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nncvzsjpjx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nncvzsjpjx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nncvzsjpjx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nncvzsjpjx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nncvzsjpjx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nncvzsjpjx .gt_left {
  text-align: left;
}

#nncvzsjpjx .gt_center {
  text-align: center;
}

#nncvzsjpjx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nncvzsjpjx .gt_font_normal {
  font-weight: normal;
}

#nncvzsjpjx .gt_font_bold {
  font-weight: bold;
}

#nncvzsjpjx .gt_font_italic {
  font-style: italic;
}

#nncvzsjpjx .gt_super {
  font-size: 65%;
}

#nncvzsjpjx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nncvzsjpjx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nncvzsjpjx .gt_indent_1 {
  text-indent: 5px;
}

#nncvzsjpjx .gt_indent_2 {
  text-indent: 10px;
}

#nncvzsjpjx .gt_indent_3 {
  text-indent: 15px;
}

#nncvzsjpjx .gt_indent_4 {
  text-indent: 20px;
}

#nncvzsjpjx .gt_indent_5 {
  text-indent: 25px;
}

#nncvzsjpjx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nncvzsjpjx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_center">1250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_center">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_center">600</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="grouping-with-a-conditional-aggregate" class="level3" data-number="7.1.8">
<h3 data-number="7.1.8" class="anchored" data-anchor-id="grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</h3>
<p>To calculate the number of sales and the total amount for each store, but only for sales over $100:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-2" class="code-annotation-target"><a href="#annotated-cell-10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_sales_count,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-3" class="code-annotation-target"><a href="#annotated-cell-10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> amount <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_total_amount</span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-10-5"><a href="#annotated-cell-10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="2" data-code-annotation="1">If sales amount is greater than 100 count it.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="3" data-code-annotation="2">If sales amount is greater than 100 then add sales amount else add zero.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="efjwydvmxg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#efjwydvmxg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#efjwydvmxg thead, #efjwydvmxg tbody, #efjwydvmxg tfoot, #efjwydvmxg tr, #efjwydvmxg td, #efjwydvmxg th {
  border-style: none;
}

#efjwydvmxg p {
  margin: 0;
  padding: 0;
}

#efjwydvmxg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#efjwydvmxg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#efjwydvmxg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#efjwydvmxg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#efjwydvmxg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#efjwydvmxg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#efjwydvmxg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#efjwydvmxg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#efjwydvmxg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#efjwydvmxg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#efjwydvmxg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#efjwydvmxg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#efjwydvmxg .gt_spanner_row {
  border-bottom-style: hidden;
}

#efjwydvmxg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#efjwydvmxg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#efjwydvmxg .gt_from_md > :first-child {
  margin-top: 0;
}

#efjwydvmxg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#efjwydvmxg .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#efjwydvmxg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#efjwydvmxg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#efjwydvmxg .gt_row_group_first td {
  border-top-width: 2px;
}

#efjwydvmxg .gt_row_group_first th {
  border-top-width: 2px;
}

#efjwydvmxg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#efjwydvmxg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#efjwydvmxg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#efjwydvmxg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#efjwydvmxg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#efjwydvmxg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#efjwydvmxg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#efjwydvmxg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#efjwydvmxg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#efjwydvmxg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#efjwydvmxg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#efjwydvmxg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#efjwydvmxg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#efjwydvmxg .gt_left {
  text-align: left;
}

#efjwydvmxg .gt_center {
  text-align: center;
}

#efjwydvmxg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#efjwydvmxg .gt_font_normal {
  font-weight: normal;
}

#efjwydvmxg .gt_font_bold {
  font-weight: bold;
}

#efjwydvmxg .gt_font_italic {
  font-style: italic;
}

#efjwydvmxg .gt_super {
  font-size: 65%;
}

#efjwydvmxg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#efjwydvmxg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#efjwydvmxg .gt_indent_1 {
  text-indent: 5px;
}

#efjwydvmxg .gt_indent_2 {
  text-indent: 10px;
}

#efjwydvmxg .gt_indent_3 {
  text-indent: 15px;
}

#efjwydvmxg .gt_indent_4 {
  text-indent: 20px;
}

#efjwydvmxg .gt_indent_5 {
  text-indent: 25px;
}

#efjwydvmxg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#efjwydvmxg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_sales_count">high_value_sales_count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_total_amount">high_value_total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">800</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="high_value_sales_count" class="gt_row gt_center">5</td>
<td headers="high_value_total_amount" class="gt_row gt_center">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group by Summary
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>It is often used with aggregate functions <strong>to perform calculations on each group.</strong></p></li>
<li><p><code>HAVING</code> clause can be used to filter groups after the aggregation.</p></li>
<li><p><code>ORDER BY</code> can be combined with <code>GROUP BY</code> to sort the results by the aggregated values.</p></li>
</ul>
</div>
</div>
<p><br> <br> <br></p>
<!------- GROUP BY ---------------------------------------------------------->
</section>
</section>
<section id="window-function" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="window-function"><span class="header-section-number">7.2</span> Window Function</h2>
<p>Window functions <strong>perform calculations across a set of table rows related to the current row</strong>. Unlike aggregate functions, which return a single value after grouping rows, window functions return multiple rows with calculated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-11"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-11-1"><a href="#annotated-cell-11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-11-2"><a href="#annotated-cell-11-2" aria-hidden="true" tabindex="-1"></a>  col_name1, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="1">1</button><span id="annotated-cell-11-3" class="code-annotation-target"><a href="#annotated-cell-11-3" aria-hidden="true" tabindex="-1"></a>  window_function() <span class="kw">OVER</span> ([<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2] [<span class="kw">ORDER</span> <span class="kw">BY</span> col_name3]) <span class="kw">AS</span> alias_name</span>
<span id="annotated-cell-11-4"><a href="#annotated-cell-11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-11" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="3" data-code-annotation="1">Define the window function and how it should be grouped and sorted.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Key Concepts of Window Function
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>OVER()</code> Clause defines the window of rows the function operates on.</li>
<li><code>PARTITION BY</code> divides the result set into <strong>partitions</strong> (like a GROUP BY).</li>
<li><code>ORDER BY</code> defines the order of rows within each partition.</li>
</ul>
</div>
</div>
<section id="row_number" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</h3>
<p>This function will assign a unique row number within a partition.</p>
</section>
<section id="quick-illustration-of-window-function" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-window-function">Quick illustration of window function</h3>
<p>A Simple example of how window function works.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">row_number</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="iwfzjxigvl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iwfzjxigvl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iwfzjxigvl thead, #iwfzjxigvl tbody, #iwfzjxigvl tfoot, #iwfzjxigvl tr, #iwfzjxigvl td, #iwfzjxigvl th {
  border-style: none;
}

#iwfzjxigvl p {
  margin: 0;
  padding: 0;
}

#iwfzjxigvl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iwfzjxigvl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iwfzjxigvl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iwfzjxigvl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iwfzjxigvl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iwfzjxigvl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwfzjxigvl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iwfzjxigvl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iwfzjxigvl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iwfzjxigvl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iwfzjxigvl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iwfzjxigvl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iwfzjxigvl .gt_spanner_row {
  border-bottom-style: hidden;
}

#iwfzjxigvl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iwfzjxigvl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iwfzjxigvl .gt_from_md > :first-child {
  margin-top: 0;
}

#iwfzjxigvl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iwfzjxigvl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iwfzjxigvl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#iwfzjxigvl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iwfzjxigvl .gt_row_group_first td {
  border-top-width: 2px;
}

#iwfzjxigvl .gt_row_group_first th {
  border-top-width: 2px;
}

#iwfzjxigvl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwfzjxigvl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iwfzjxigvl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iwfzjxigvl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwfzjxigvl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwfzjxigvl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iwfzjxigvl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iwfzjxigvl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iwfzjxigvl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iwfzjxigvl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iwfzjxigvl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwfzjxigvl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iwfzjxigvl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iwfzjxigvl .gt_left {
  text-align: left;
}

#iwfzjxigvl .gt_center {
  text-align: center;
}

#iwfzjxigvl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iwfzjxigvl .gt_font_normal {
  font-weight: normal;
}

#iwfzjxigvl .gt_font_bold {
  font-weight: bold;
}

#iwfzjxigvl .gt_font_italic {
  font-style: italic;
}

#iwfzjxigvl .gt_super {
  font-size: 65%;
}

#iwfzjxigvl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iwfzjxigvl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iwfzjxigvl .gt_indent_1 {
  text-indent: 5px;
}

#iwfzjxigvl .gt_indent_2 {
  text-indent: 10px;
}

#iwfzjxigvl .gt_indent_3 {
  text-indent: 15px;
}

#iwfzjxigvl .gt_indent_4 {
  text-indent: 20px;
}

#iwfzjxigvl .gt_indent_5 {
  text-indent: 25px;
}

#iwfzjxigvl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iwfzjxigvl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="row_number">row_number</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br></p>
<section id="unordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="unordered">Unordered</h4>
<div class="cell">
<div class="cell-output-display">
<div id="hcwhymnobq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hcwhymnobq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hcwhymnobq thead, #hcwhymnobq tbody, #hcwhymnobq tfoot, #hcwhymnobq tr, #hcwhymnobq td, #hcwhymnobq th {
  border-style: none;
}

#hcwhymnobq p {
  margin: 0;
  padding: 0;
}

#hcwhymnobq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hcwhymnobq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hcwhymnobq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hcwhymnobq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hcwhymnobq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hcwhymnobq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hcwhymnobq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hcwhymnobq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hcwhymnobq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hcwhymnobq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hcwhymnobq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hcwhymnobq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hcwhymnobq .gt_spanner_row {
  border-bottom-style: hidden;
}

#hcwhymnobq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hcwhymnobq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hcwhymnobq .gt_from_md > :first-child {
  margin-top: 0;
}

#hcwhymnobq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hcwhymnobq .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hcwhymnobq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#hcwhymnobq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hcwhymnobq .gt_row_group_first td {
  border-top-width: 2px;
}

#hcwhymnobq .gt_row_group_first th {
  border-top-width: 2px;
}

#hcwhymnobq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hcwhymnobq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hcwhymnobq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hcwhymnobq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hcwhymnobq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hcwhymnobq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hcwhymnobq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hcwhymnobq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hcwhymnobq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hcwhymnobq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hcwhymnobq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hcwhymnobq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hcwhymnobq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hcwhymnobq .gt_left {
  text-align: left;
}

#hcwhymnobq .gt_center {
  text-align: center;
}

#hcwhymnobq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hcwhymnobq .gt_font_normal {
  font-weight: normal;
}

#hcwhymnobq .gt_font_bold {
  font-weight: bold;
}

#hcwhymnobq .gt_font_italic {
  font-style: italic;
}

#hcwhymnobq .gt_super {
  font-size: 65%;
}

#hcwhymnobq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hcwhymnobq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hcwhymnobq .gt_indent_1 {
  text-indent: 5px;
}

#hcwhymnobq .gt_indent_2 {
  text-indent: 10px;
}

#hcwhymnobq .gt_indent_3 {
  text-indent: 15px;
}

#hcwhymnobq .gt_indent_4 {
  text-indent: 20px;
}

#hcwhymnobq .gt_indent_5 {
  text-indent: 25px;
}

#hcwhymnobq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hcwhymnobq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-13"><pre class="sourceCode sql code-annotation-code code-with-copy"><code class="sourceCode sql"><span id="annotated-cell-13-1"><a href="#annotated-cell-13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-13-2"><a href="#annotated-cell-13-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-13-3"><a href="#annotated-cell-13-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-13-4"><a href="#annotated-cell-13-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="annotated-cell-13-5"><a href="#annotated-cell-13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-13-6"><a href="#annotated-cell-13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="ordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ordered">Ordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-14-3"><a href="#annotated-cell-14-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-14-4"><a href="#annotated-cell-14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1">1</button><span id="annotated-cell-14-5" class="code-annotation-target"><a href="#annotated-cell-14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-14-6"><a href="#annotated-cell-14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id, then order by the sales date. Then get the row number by the partition. In other words, the rows are numbered sequentially for each store_id based on sales_date.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="dhrbeytpew" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dhrbeytpew table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dhrbeytpew thead, #dhrbeytpew tbody, #dhrbeytpew tfoot, #dhrbeytpew tr, #dhrbeytpew td, #dhrbeytpew th {
  border-style: none;
}

#dhrbeytpew p {
  margin: 0;
  padding: 0;
}

#dhrbeytpew .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dhrbeytpew .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dhrbeytpew .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dhrbeytpew .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dhrbeytpew .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dhrbeytpew .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dhrbeytpew .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dhrbeytpew .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dhrbeytpew .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dhrbeytpew .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dhrbeytpew .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dhrbeytpew .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dhrbeytpew .gt_spanner_row {
  border-bottom-style: hidden;
}

#dhrbeytpew .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dhrbeytpew .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dhrbeytpew .gt_from_md > :first-child {
  margin-top: 0;
}

#dhrbeytpew .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dhrbeytpew .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dhrbeytpew .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#dhrbeytpew .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dhrbeytpew .gt_row_group_first td {
  border-top-width: 2px;
}

#dhrbeytpew .gt_row_group_first th {
  border-top-width: 2px;
}

#dhrbeytpew .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dhrbeytpew .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dhrbeytpew .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dhrbeytpew .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dhrbeytpew .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dhrbeytpew .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dhrbeytpew .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dhrbeytpew .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dhrbeytpew .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dhrbeytpew .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dhrbeytpew .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dhrbeytpew .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dhrbeytpew .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dhrbeytpew .gt_left {
  text-align: left;
}

#dhrbeytpew .gt_center {
  text-align: center;
}

#dhrbeytpew .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dhrbeytpew .gt_font_normal {
  font-weight: normal;
}

#dhrbeytpew .gt_font_bold {
  font-weight: bold;
}

#dhrbeytpew .gt_font_italic {
  font-style: italic;
}

#dhrbeytpew .gt_super {
  font-size: 65%;
}

#dhrbeytpew .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dhrbeytpew .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dhrbeytpew .gt_indent_1 {
  text-indent: 5px;
}

#dhrbeytpew .gt_indent_2 {
  text-indent: 10px;
}

#dhrbeytpew .gt_indent_3 {
  text-indent: 15px;
}

#dhrbeytpew .gt_indent_4 {
  text-indent: 20px;
}

#dhrbeytpew .gt_indent_5 {
  text-indent: 25px;
}

#dhrbeytpew .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#dhrbeytpew div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="aggregate-function-sum-as-a-window-function" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> running_total</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="pbzsibzwls" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pbzsibzwls table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pbzsibzwls thead, #pbzsibzwls tbody, #pbzsibzwls tfoot, #pbzsibzwls tr, #pbzsibzwls td, #pbzsibzwls th {
  border-style: none;
}

#pbzsibzwls p {
  margin: 0;
  padding: 0;
}

#pbzsibzwls .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pbzsibzwls .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pbzsibzwls .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pbzsibzwls .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pbzsibzwls .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pbzsibzwls .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbzsibzwls .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pbzsibzwls .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pbzsibzwls .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pbzsibzwls .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pbzsibzwls .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pbzsibzwls .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pbzsibzwls .gt_spanner_row {
  border-bottom-style: hidden;
}

#pbzsibzwls .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pbzsibzwls .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pbzsibzwls .gt_from_md > :first-child {
  margin-top: 0;
}

#pbzsibzwls .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pbzsibzwls .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pbzsibzwls .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#pbzsibzwls .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pbzsibzwls .gt_row_group_first td {
  border-top-width: 2px;
}

#pbzsibzwls .gt_row_group_first th {
  border-top-width: 2px;
}

#pbzsibzwls .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbzsibzwls .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pbzsibzwls .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pbzsibzwls .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbzsibzwls .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbzsibzwls .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pbzsibzwls .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pbzsibzwls .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pbzsibzwls .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbzsibzwls .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pbzsibzwls .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbzsibzwls .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pbzsibzwls .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbzsibzwls .gt_left {
  text-align: left;
}

#pbzsibzwls .gt_center {
  text-align: center;
}

#pbzsibzwls .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pbzsibzwls .gt_font_normal {
  font-weight: normal;
}

#pbzsibzwls .gt_font_bold {
  font-weight: bold;
}

#pbzsibzwls .gt_font_italic {
  font-style: italic;
}

#pbzsibzwls .gt_super {
  font-size: 65%;
}

#pbzsibzwls .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pbzsibzwls .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pbzsibzwls .gt_indent_1 {
  text-indent: 5px;
}

#pbzsibzwls .gt_indent_2 {
  text-indent: 10px;
}

#pbzsibzwls .gt_indent_3 {
  text-indent: 15px;
}

#pbzsibzwls .gt_indent_4 {
  text-indent: 20px;
}

#pbzsibzwls .gt_indent_5 {
  text-indent: 25px;
}

#pbzsibzwls .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pbzsibzwls div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="running_total">running_total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="running_total" class="gt_row gt_right">550</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">650</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
<section id="rank" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="rank"><span class="header-section-number">7.2.3</span> RANK</h3>
<p>Ranks the rows within a partition. Ties result in the same rank, but with gaps in the sequence.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="kjhpafqxxe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kjhpafqxxe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kjhpafqxxe thead, #kjhpafqxxe tbody, #kjhpafqxxe tfoot, #kjhpafqxxe tr, #kjhpafqxxe td, #kjhpafqxxe th {
  border-style: none;
}

#kjhpafqxxe p {
  margin: 0;
  padding: 0;
}

#kjhpafqxxe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kjhpafqxxe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kjhpafqxxe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kjhpafqxxe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kjhpafqxxe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kjhpafqxxe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kjhpafqxxe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kjhpafqxxe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kjhpafqxxe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kjhpafqxxe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kjhpafqxxe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kjhpafqxxe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kjhpafqxxe .gt_spanner_row {
  border-bottom-style: hidden;
}

#kjhpafqxxe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kjhpafqxxe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kjhpafqxxe .gt_from_md > :first-child {
  margin-top: 0;
}

#kjhpafqxxe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kjhpafqxxe .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kjhpafqxxe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#kjhpafqxxe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kjhpafqxxe .gt_row_group_first td {
  border-top-width: 2px;
}

#kjhpafqxxe .gt_row_group_first th {
  border-top-width: 2px;
}

#kjhpafqxxe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kjhpafqxxe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kjhpafqxxe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kjhpafqxxe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kjhpafqxxe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kjhpafqxxe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kjhpafqxxe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kjhpafqxxe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kjhpafqxxe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kjhpafqxxe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kjhpafqxxe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kjhpafqxxe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kjhpafqxxe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kjhpafqxxe .gt_left {
  text-align: left;
}

#kjhpafqxxe .gt_center {
  text-align: center;
}

#kjhpafqxxe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kjhpafqxxe .gt_font_normal {
  font-weight: normal;
}

#kjhpafqxxe .gt_font_bold {
  font-weight: bold;
}

#kjhpafqxxe .gt_font_italic {
  font-style: italic;
}

#kjhpafqxxe .gt_super {
  font-size: 65%;
}

#kjhpafqxxe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kjhpafqxxe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kjhpafqxxe .gt_indent_1 {
  text-indent: 5px;
}

#kjhpafqxxe .gt_indent_2 {
  text-indent: 10px;
}

#kjhpafqxxe .gt_indent_3 {
  text-indent: 15px;
}

#kjhpafqxxe .gt_indent_4 {
  text-indent: 20px;
}

#kjhpafqxxe .gt_indent_5 {
  text-indent: 25px;
}

#kjhpafqxxe .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kjhpafqxxe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>If two rows have the same amount within the same store_id, they will get the same rank, and the next rank will be skipped.</p>
<p><br> <br> <br></p>
</section>
<section id="dense_rank" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</h3>
<p>Similar to RANK(), but without gaps in the ranking sequence.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="yattqnvgip" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yattqnvgip table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yattqnvgip thead, #yattqnvgip tbody, #yattqnvgip tfoot, #yattqnvgip tr, #yattqnvgip td, #yattqnvgip th {
  border-style: none;
}

#yattqnvgip p {
  margin: 0;
  padding: 0;
}

#yattqnvgip .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yattqnvgip .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yattqnvgip .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yattqnvgip .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yattqnvgip .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yattqnvgip .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yattqnvgip .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yattqnvgip .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yattqnvgip .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yattqnvgip .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yattqnvgip .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yattqnvgip .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yattqnvgip .gt_spanner_row {
  border-bottom-style: hidden;
}

#yattqnvgip .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yattqnvgip .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yattqnvgip .gt_from_md > :first-child {
  margin-top: 0;
}

#yattqnvgip .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yattqnvgip .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yattqnvgip .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#yattqnvgip .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yattqnvgip .gt_row_group_first td {
  border-top-width: 2px;
}

#yattqnvgip .gt_row_group_first th {
  border-top-width: 2px;
}

#yattqnvgip .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yattqnvgip .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yattqnvgip .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yattqnvgip .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yattqnvgip .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yattqnvgip .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yattqnvgip .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yattqnvgip .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yattqnvgip .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yattqnvgip .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yattqnvgip .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yattqnvgip .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yattqnvgip .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yattqnvgip .gt_left {
  text-align: left;
}

#yattqnvgip .gt_center {
  text-align: center;
}

#yattqnvgip .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yattqnvgip .gt_font_normal {
  font-weight: normal;
}

#yattqnvgip .gt_font_bold {
  font-weight: bold;
}

#yattqnvgip .gt_font_italic {
  font-style: italic;
}

#yattqnvgip .gt_super {
  font-size: 65%;
}

#yattqnvgip .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yattqnvgip .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yattqnvgip .gt_indent_1 {
  text-indent: 5px;
}

#yattqnvgip .gt_indent_2 {
  text-indent: 10px;
}

#yattqnvgip .gt_indent_3 {
  text-indent: 15px;
}

#yattqnvgip .gt_indent_4 {
  text-indent: 20px;
}

#yattqnvgip .gt_indent_5 {
  text-indent: 25px;
}

#yattqnvgip .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yattqnvgip div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This will rank rows without gaps, even if there are ties.</p>
<p><br> <br> <br></p>
</section>
<section id="ntile" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="ntile"><span class="header-section-number">7.2.5</span> NTILE</h3>
<p>Divides the result set into a specified number of buckets.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    sales_id, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">2</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="qsgnoffleq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qsgnoffleq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qsgnoffleq thead, #qsgnoffleq tbody, #qsgnoffleq tfoot, #qsgnoffleq tr, #qsgnoffleq td, #qsgnoffleq th {
  border-style: none;
}

#qsgnoffleq p {
  margin: 0;
  padding: 0;
}

#qsgnoffleq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qsgnoffleq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qsgnoffleq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qsgnoffleq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qsgnoffleq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qsgnoffleq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qsgnoffleq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qsgnoffleq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qsgnoffleq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qsgnoffleq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qsgnoffleq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qsgnoffleq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qsgnoffleq .gt_spanner_row {
  border-bottom-style: hidden;
}

#qsgnoffleq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qsgnoffleq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qsgnoffleq .gt_from_md > :first-child {
  margin-top: 0;
}

#qsgnoffleq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qsgnoffleq .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qsgnoffleq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#qsgnoffleq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qsgnoffleq .gt_row_group_first td {
  border-top-width: 2px;
}

#qsgnoffleq .gt_row_group_first th {
  border-top-width: 2px;
}

#qsgnoffleq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qsgnoffleq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qsgnoffleq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qsgnoffleq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qsgnoffleq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qsgnoffleq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qsgnoffleq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qsgnoffleq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qsgnoffleq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qsgnoffleq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qsgnoffleq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qsgnoffleq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qsgnoffleq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qsgnoffleq .gt_left {
  text-align: left;
}

#qsgnoffleq .gt_center {
  text-align: center;
}

#qsgnoffleq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qsgnoffleq .gt_font_normal {
  font-weight: normal;
}

#qsgnoffleq .gt_font_bold {
  font-weight: bold;
}

#qsgnoffleq .gt_font_italic {
  font-style: italic;
}

#qsgnoffleq .gt_super {
  font-size: 65%;
}

#qsgnoffleq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qsgnoffleq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qsgnoffleq .gt_indent_1 {
  text-indent: 5px;
}

#qsgnoffleq .gt_indent_2 {
  text-indent: 10px;
}

#qsgnoffleq .gt_indent_3 {
  text-indent: 15px;
}

#qsgnoffleq .gt_indent_4 {
  text-indent: 20px;
}

#qsgnoffleq .gt_indent_5 {
  text-indent: 25px;
}

#qsgnoffleq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qsgnoffleq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">300</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This divides the result set into 2 buckets based on the Amount. Rows with the highest amounts go into the first bucket, and so on.</p>
<p><br> <br> <br></p>
</section>
<section id="lag" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="lag"><span class="header-section-number">7.2.6</span> LAG</h3>
<p>LAG() Example: Get the previous row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="zlqrolilrb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zlqrolilrb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zlqrolilrb thead, #zlqrolilrb tbody, #zlqrolilrb tfoot, #zlqrolilrb tr, #zlqrolilrb td, #zlqrolilrb th {
  border-style: none;
}

#zlqrolilrb p {
  margin: 0;
  padding: 0;
}

#zlqrolilrb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zlqrolilrb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zlqrolilrb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zlqrolilrb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zlqrolilrb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zlqrolilrb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlqrolilrb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zlqrolilrb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zlqrolilrb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zlqrolilrb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zlqrolilrb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zlqrolilrb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zlqrolilrb .gt_spanner_row {
  border-bottom-style: hidden;
}

#zlqrolilrb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zlqrolilrb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zlqrolilrb .gt_from_md > :first-child {
  margin-top: 0;
}

#zlqrolilrb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zlqrolilrb .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zlqrolilrb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#zlqrolilrb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zlqrolilrb .gt_row_group_first td {
  border-top-width: 2px;
}

#zlqrolilrb .gt_row_group_first th {
  border-top-width: 2px;
}

#zlqrolilrb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlqrolilrb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zlqrolilrb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zlqrolilrb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlqrolilrb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlqrolilrb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zlqrolilrb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zlqrolilrb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zlqrolilrb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zlqrolilrb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zlqrolilrb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlqrolilrb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zlqrolilrb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zlqrolilrb .gt_left {
  text-align: left;
}

#zlqrolilrb .gt_center {
  text-align: center;
}

#zlqrolilrb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zlqrolilrb .gt_font_normal {
  font-weight: normal;
}

#zlqrolilrb .gt_font_bold {
  font-weight: bold;
}

#zlqrolilrb .gt_font_italic {
  font-style: italic;
}

#zlqrolilrb .gt_super {
  font-size: 65%;
}

#zlqrolilrb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zlqrolilrb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zlqrolilrb .gt_indent_1 {
  text-indent: 5px;
}

#zlqrolilrb .gt_indent_2 {
  text-indent: 10px;
}

#zlqrolilrb .gt_indent_3 {
  text-indent: 15px;
}

#zlqrolilrb .gt_indent_4 {
  text-indent: 20px;
}

#zlqrolilrb .gt_indent_5 {
  text-indent: 25px;
}

#zlqrolilrb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zlqrolilrb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<section id="partition-by-store_id" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="ubyvifrrwf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ubyvifrrwf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ubyvifrrwf thead, #ubyvifrrwf tbody, #ubyvifrrwf tfoot, #ubyvifrrwf tr, #ubyvifrrwf td, #ubyvifrrwf th {
  border-style: none;
}

#ubyvifrrwf p {
  margin: 0;
  padding: 0;
}

#ubyvifrrwf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ubyvifrrwf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ubyvifrrwf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ubyvifrrwf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ubyvifrrwf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ubyvifrrwf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubyvifrrwf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ubyvifrrwf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ubyvifrrwf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ubyvifrrwf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ubyvifrrwf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ubyvifrrwf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ubyvifrrwf .gt_spanner_row {
  border-bottom-style: hidden;
}

#ubyvifrrwf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ubyvifrrwf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ubyvifrrwf .gt_from_md > :first-child {
  margin-top: 0;
}

#ubyvifrrwf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ubyvifrrwf .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ubyvifrrwf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#ubyvifrrwf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ubyvifrrwf .gt_row_group_first td {
  border-top-width: 2px;
}

#ubyvifrrwf .gt_row_group_first th {
  border-top-width: 2px;
}

#ubyvifrrwf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubyvifrrwf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ubyvifrrwf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ubyvifrrwf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubyvifrrwf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubyvifrrwf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ubyvifrrwf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ubyvifrrwf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ubyvifrrwf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ubyvifrrwf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ubyvifrrwf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubyvifrrwf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ubyvifrrwf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ubyvifrrwf .gt_left {
  text-align: left;
}

#ubyvifrrwf .gt_center {
  text-align: center;
}

#ubyvifrrwf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ubyvifrrwf .gt_font_normal {
  font-weight: normal;
}

#ubyvifrrwf .gt_font_bold {
  font-weight: bold;
}

#ubyvifrrwf .gt_font_italic {
  font-style: italic;
}

#ubyvifrrwf .gt_super {
  font-size: 65%;
}

#ubyvifrrwf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ubyvifrrwf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ubyvifrrwf .gt_indent_1 {
  text-indent: 5px;
}

#ubyvifrrwf .gt_indent_2 {
  text-indent: 10px;
}

#ubyvifrrwf .gt_indent_3 {
  text-indent: 15px;
}

#ubyvifrrwf .gt_indent_4 {
  text-indent: 20px;
}

#ubyvifrrwf .gt_indent_5 {
  text-indent: 25px;
}

#ubyvifrrwf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ubyvifrrwf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="lead" class="level3" data-number="7.2.7">
<h3 data-number="7.2.7" class="anchored" data-anchor-id="lead"><span class="header-section-number">7.2.7</span> LEAD</h3>
<p>LEAD() Example: Get the next row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="hxngxpljvs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hxngxpljvs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hxngxpljvs thead, #hxngxpljvs tbody, #hxngxpljvs tfoot, #hxngxpljvs tr, #hxngxpljvs td, #hxngxpljvs th {
  border-style: none;
}

#hxngxpljvs p {
  margin: 0;
  padding: 0;
}

#hxngxpljvs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hxngxpljvs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hxngxpljvs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hxngxpljvs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hxngxpljvs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hxngxpljvs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hxngxpljvs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hxngxpljvs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hxngxpljvs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hxngxpljvs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hxngxpljvs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hxngxpljvs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hxngxpljvs .gt_spanner_row {
  border-bottom-style: hidden;
}

#hxngxpljvs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hxngxpljvs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hxngxpljvs .gt_from_md > :first-child {
  margin-top: 0;
}

#hxngxpljvs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hxngxpljvs .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hxngxpljvs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#hxngxpljvs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hxngxpljvs .gt_row_group_first td {
  border-top-width: 2px;
}

#hxngxpljvs .gt_row_group_first th {
  border-top-width: 2px;
}

#hxngxpljvs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hxngxpljvs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hxngxpljvs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hxngxpljvs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hxngxpljvs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hxngxpljvs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hxngxpljvs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hxngxpljvs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hxngxpljvs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hxngxpljvs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hxngxpljvs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hxngxpljvs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hxngxpljvs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hxngxpljvs .gt_left {
  text-align: left;
}

#hxngxpljvs .gt_center {
  text-align: center;
}

#hxngxpljvs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hxngxpljvs .gt_font_normal {
  font-weight: normal;
}

#hxngxpljvs .gt_font_bold {
  font-weight: bold;
}

#hxngxpljvs .gt_font_italic {
  font-style: italic;
}

#hxngxpljvs .gt_super {
  font-size: 65%;
}

#hxngxpljvs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hxngxpljvs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hxngxpljvs .gt_indent_1 {
  text-indent: 5px;
}

#hxngxpljvs .gt_indent_2 {
  text-indent: 10px;
}

#hxngxpljvs .gt_indent_3 {
  text-indent: 15px;
}

#hxngxpljvs .gt_indent_4 {
  text-indent: 20px;
}

#hxngxpljvs .gt_indent_5 {
  text-indent: 25px;
}

#hxngxpljvs .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hxngxpljvs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<section id="partition-by-store_id-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id-1">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="mkwwboxpox" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mkwwboxpox table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mkwwboxpox thead, #mkwwboxpox tbody, #mkwwboxpox tfoot, #mkwwboxpox tr, #mkwwboxpox td, #mkwwboxpox th {
  border-style: none;
}

#mkwwboxpox p {
  margin: 0;
  padding: 0;
}

#mkwwboxpox .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mkwwboxpox .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mkwwboxpox .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mkwwboxpox .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mkwwboxpox .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mkwwboxpox .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mkwwboxpox .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mkwwboxpox .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mkwwboxpox .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mkwwboxpox .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mkwwboxpox .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mkwwboxpox .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mkwwboxpox .gt_spanner_row {
  border-bottom-style: hidden;
}

#mkwwboxpox .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mkwwboxpox .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mkwwboxpox .gt_from_md > :first-child {
  margin-top: 0;
}

#mkwwboxpox .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mkwwboxpox .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mkwwboxpox .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#mkwwboxpox .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mkwwboxpox .gt_row_group_first td {
  border-top-width: 2px;
}

#mkwwboxpox .gt_row_group_first th {
  border-top-width: 2px;
}

#mkwwboxpox .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkwwboxpox .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mkwwboxpox .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mkwwboxpox .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mkwwboxpox .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkwwboxpox .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mkwwboxpox .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mkwwboxpox .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mkwwboxpox .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mkwwboxpox .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mkwwboxpox .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkwwboxpox .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mkwwboxpox .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mkwwboxpox .gt_left {
  text-align: left;
}

#mkwwboxpox .gt_center {
  text-align: center;
}

#mkwwboxpox .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mkwwboxpox .gt_font_normal {
  font-weight: normal;
}

#mkwwboxpox .gt_font_bold {
  font-weight: bold;
}

#mkwwboxpox .gt_font_italic {
  font-style: italic;
}

#mkwwboxpox .gt_super {
  font-size: 65%;
}

#mkwwboxpox .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mkwwboxpox .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mkwwboxpox .gt_indent_1 {
  text-indent: 5px;
}

#mkwwboxpox .gt_indent_2 {
  text-indent: 10px;
}

#mkwwboxpox .gt_indent_3 {
  text-indent: 15px;
}

#mkwwboxpox .gt_indent_4 {
  text-indent: 20px;
}

#mkwwboxpox .gt_indent_5 {
  text-indent: 25px;
}

#mkwwboxpox .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mkwwboxpox div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="combining-multiple-window-functions" class="level3" data-number="7.2.8">
<h3 data-number="7.2.8" class="anchored" data-anchor-id="combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</h3>
<p>You can combine multiple window functions in a single query.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> row_num,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> total_amount,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>This query assigns a row number, calculates the total amount per store, and retrieves the previous amount for each sale.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>FRAME</code> Clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AVG</span>(sale) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2 <span class="kw">ORDER</span> <span class="kw">BY</span> col_name3 <span class="kw">ROWS</span> <span class="kw">BETWEEN</span> <span class="kw">CURRENT</span> <span class="kw">ROW</span> <span class="kw">AND</span> <span class="kw">UNBOUNDED</span> <span class="kw">PRECEDING</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><strong>ROWS:</strong> The frame type. values such as ROWS or RANGE</li>
<li><strong>CURRENT ROW:</strong> The frame boundary (Lower value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING</li>
<li><strong>UNBOUNDED PRECEDING:</strong> The frame Boundary (Higher value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING.</li>
</ul>
<p><br></p>
<p><strong>Rules:</strong> - You can only use the Frame clause with Order by clause. - The lower value should be placed before the higher value.</p>
</div>
</div>
</div>
<p><br> <br> <br></p>
<!------- Window Function -------------------------------------------------->
</section>
</section>
<section id="task" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="task"><span class="header-section-number">7.3</span> Task</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./sql_data_cleaning.html" class="pagination-link" aria-label="Data Cleaning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sql_join.html" class="pagination-link" aria-label="Joins">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>