<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.55">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Grouping Data – Data Analysis Tools</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./sql_join.html" rel="next">
<link href="./sql_data_cleaning.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Analysis Tools</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sql_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_creating_database.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Creating Database</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_statement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Query Statement</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_text_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Working with Text</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_date_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Working with Date</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_group_windows_function.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_join.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_sub_queries_cte.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subquery &amp; CTE</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sql_project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Project</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./r_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Structure</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_operators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Operators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_tidyverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Tidyverse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_exploratory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">EDA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r_data_cleaning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./python_programming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_data_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./powerbi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Power BI</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./powerbi_data_import.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Processing…</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tool_source.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Data Tool Referenece</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#group-by" id="toc-group-by" class="nav-link active" data-scroll-target="#group-by"><span class="header-section-number">7.1</span> GROUP BY</a>
  <ul class="collapse">
  <li><a href="#quick-illustration-of-group-by" id="toc-quick-illustration-of-group-by" class="nav-link" data-scroll-target="#quick-illustration-of-group-by">Quick illustration of GROUP BY:</a></li>
  <li><a href="#simple-group-by-with-count" id="toc-simple-group-by-with-count" class="nav-link" data-scroll-target="#simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></a></li>
  <li><a href="#group-by-with-multiple-columns" id="toc-group-by-with-multiple-columns" class="nav-link" data-scroll-target="#group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</a></li>
  <li><a href="#using-aggregate-functions" id="toc-using-aggregate-functions" class="nav-link" data-scroll-target="#using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</a></li>
  <li><a href="#having-clause-with-group-by" id="toc-having-clause-with-group-by" class="nav-link" data-scroll-target="#having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</a></li>
  <li><a href="#group-by-with-date" id="toc-group-by-with-date" class="nav-link" data-scroll-target="#group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></a></li>
  <li><a href="#group-by-with-expressions" id="toc-group-by-with-expressions" class="nav-link" data-scroll-target="#group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</a></li>
  <li><a href="#group-by-with-order-by" id="toc-group-by-with-order-by" class="nav-link" data-scroll-target="#group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></a></li>
  <li><a href="#grouping-with-a-conditional-aggregate" id="toc-grouping-with-a-conditional-aggregate" class="nav-link" data-scroll-target="#grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</a></li>
  </ul></li>
  <li><a href="#window-function" id="toc-window-function" class="nav-link" data-scroll-target="#window-function"><span class="header-section-number">7.2</span> Window Function</a>
  <ul class="collapse">
  <li><a href="#row_number" id="toc-row_number" class="nav-link" data-scroll-target="#row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</a></li>
  <li><a href="#quick-illustration-of-window-function" id="toc-quick-illustration-of-window-function" class="nav-link" data-scroll-target="#quick-illustration-of-window-function">Quick illustration of window function</a></li>
  <li><a href="#aggregate-function-sum-as-a-window-function" id="toc-aggregate-function-sum-as-a-window-function" class="nav-link" data-scroll-target="#aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</a></li>
  <li><a href="#rank" id="toc-rank" class="nav-link" data-scroll-target="#rank"><span class="header-section-number">7.2.3</span> RANK</a></li>
  <li><a href="#dense_rank" id="toc-dense_rank" class="nav-link" data-scroll-target="#dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</a></li>
  <li><a href="#ntile" id="toc-ntile" class="nav-link" data-scroll-target="#ntile"><span class="header-section-number">7.2.5</span> NTILE</a></li>
  <li><a href="#lag" id="toc-lag" class="nav-link" data-scroll-target="#lag"><span class="header-section-number">7.2.6</span> LAG</a></li>
  <li><a href="#lead" id="toc-lead" class="nav-link" data-scroll-target="#lead"><span class="header-section-number">7.2.7</span> LEAD</a></li>
  <li><a href="#combining-multiple-window-functions" id="toc-combining-multiple-window-functions" class="nav-link" data-scroll-target="#combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</a></li>
  </ul></li>
  <li><a href="#task" id="toc-task" class="nav-link" data-scroll-target="#task"><span class="header-section-number">7.3</span> Task</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sql_programming.html">SQL</a></li><li class="breadcrumb-item"><a href="./sql_group_windows_function.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Grouping Data</span></h1>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="group-by" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="group-by"><span class="header-section-number">7.1</span> GROUP BY</h2>
<p>The <code>GROUP BY</code> clause is used to arrange identical data into groups. It is often used with aggregate functions such as <code>COUNT()</code>, <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code>, and <code>MIN()</code> to perform operations on each group of data.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Basic Syntax</span></span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> column_name1, aggregate_function(column_column2)</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-5" class="code-annotation-target"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> column_name1;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3" data-code-annotation="1">aggregate_function like <code>SUM()</code>, <code>AVG()</code>, <code>MAX()</code> etc.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="5" data-code-annotation="2">The name of the column to group the table by.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Key concepts of the <code>GROUP BY</code> clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p>The <code>GROUP BY</code> clause groups rows that have the same values in specified columns into summary rows.</p></li>
<li><p>Functions such as <code>COUNT</code>, <code>SUM</code>, <code>AVG</code>, <code>MAX</code>, and <code>MIN</code> are commonly used with <code>GROUP BY</code> <strong>to perform calculations on each group</strong>.</p></li>
<li><p>The <code>HAVING</code> clause is used to filter groups based on conditions, similar to how <code>WHERE</code> filters rows.</p></li>
</ul>
</div>
</div>
</div>
<section id="example-table-sales" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="example-table-sales">Example Table: Sales</h4>
<div class="cell">
<div class="cell-output-display">
<div id="yoebnvcgmz" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yoebnvcgmz table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yoebnvcgmz thead, #yoebnvcgmz tbody, #yoebnvcgmz tfoot, #yoebnvcgmz tr, #yoebnvcgmz td, #yoebnvcgmz th {
  border-style: none;
}

#yoebnvcgmz p {
  margin: 0;
  padding: 0;
}

#yoebnvcgmz .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yoebnvcgmz .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yoebnvcgmz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yoebnvcgmz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yoebnvcgmz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yoebnvcgmz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yoebnvcgmz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yoebnvcgmz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yoebnvcgmz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yoebnvcgmz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yoebnvcgmz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yoebnvcgmz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yoebnvcgmz .gt_spanner_row {
  border-bottom-style: hidden;
}

#yoebnvcgmz .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yoebnvcgmz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yoebnvcgmz .gt_from_md > :first-child {
  margin-top: 0;
}

#yoebnvcgmz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yoebnvcgmz .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yoebnvcgmz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#yoebnvcgmz .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yoebnvcgmz .gt_row_group_first td {
  border-top-width: 2px;
}

#yoebnvcgmz .gt_row_group_first th {
  border-top-width: 2px;
}

#yoebnvcgmz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yoebnvcgmz .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yoebnvcgmz .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yoebnvcgmz .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yoebnvcgmz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yoebnvcgmz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yoebnvcgmz .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yoebnvcgmz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yoebnvcgmz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yoebnvcgmz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yoebnvcgmz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yoebnvcgmz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yoebnvcgmz .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yoebnvcgmz .gt_left {
  text-align: left;
}

#yoebnvcgmz .gt_center {
  text-align: center;
}

#yoebnvcgmz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yoebnvcgmz .gt_font_normal {
  font-weight: normal;
}

#yoebnvcgmz .gt_font_bold {
  font-weight: bold;
}

#yoebnvcgmz .gt_font_italic {
  font-style: italic;
}

#yoebnvcgmz .gt_super {
  font-size: 65%;
}

#yoebnvcgmz .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yoebnvcgmz .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yoebnvcgmz .gt_indent_1 {
  text-indent: 5px;
}

#yoebnvcgmz .gt_indent_2 {
  text-indent: 10px;
}

#yoebnvcgmz .gt_indent_3 {
  text-indent: 15px;
}

#yoebnvcgmz .gt_indent_4 {
  text-indent: 20px;
}

#yoebnvcgmz .gt_indent_5 {
  text-indent: 25px;
}

#yoebnvcgmz .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yoebnvcgmz div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">201</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="product_id" class="gt_row gt_right">202</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="quick-illustration-of-group-by" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-group-by">Quick illustration of GROUP BY:</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-2-1"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To get the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-2" class="code-annotation-target"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-2-3"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="zytwkqmnrc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zytwkqmnrc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zytwkqmnrc thead, #zytwkqmnrc tbody, #zytwkqmnrc tfoot, #zytwkqmnrc tr, #zytwkqmnrc td, #zytwkqmnrc th {
  border-style: none;
}

#zytwkqmnrc p {
  margin: 0;
  padding: 0;
}

#zytwkqmnrc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zytwkqmnrc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zytwkqmnrc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zytwkqmnrc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zytwkqmnrc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zytwkqmnrc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zytwkqmnrc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zytwkqmnrc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zytwkqmnrc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zytwkqmnrc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zytwkqmnrc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zytwkqmnrc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zytwkqmnrc .gt_spanner_row {
  border-bottom-style: hidden;
}

#zytwkqmnrc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zytwkqmnrc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zytwkqmnrc .gt_from_md > :first-child {
  margin-top: 0;
}

#zytwkqmnrc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zytwkqmnrc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zytwkqmnrc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zytwkqmnrc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zytwkqmnrc .gt_row_group_first td {
  border-top-width: 2px;
}

#zytwkqmnrc .gt_row_group_first th {
  border-top-width: 2px;
}

#zytwkqmnrc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zytwkqmnrc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zytwkqmnrc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zytwkqmnrc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zytwkqmnrc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zytwkqmnrc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zytwkqmnrc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zytwkqmnrc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zytwkqmnrc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zytwkqmnrc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zytwkqmnrc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zytwkqmnrc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zytwkqmnrc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zytwkqmnrc .gt_left {
  text-align: left;
}

#zytwkqmnrc .gt_center {
  text-align: center;
}

#zytwkqmnrc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zytwkqmnrc .gt_font_normal {
  font-weight: normal;
}

#zytwkqmnrc .gt_font_bold {
  font-weight: bold;
}

#zytwkqmnrc .gt_font_italic {
  font-style: italic;
}

#zytwkqmnrc .gt_super {
  font-size: 65%;
}

#zytwkqmnrc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zytwkqmnrc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zytwkqmnrc .gt_indent_1 {
  text-indent: 5px;
}

#zytwkqmnrc .gt_indent_2 {
  text-indent: 10px;
}

#zytwkqmnrc .gt_indent_3 {
  text-indent: 15px;
}

#zytwkqmnrc .gt_indent_4 {
  text-indent: 20px;
}

#zytwkqmnrc .gt_indent_5 {
  text-indent: 25px;
}

#zytwkqmnrc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zytwkqmnrc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Full Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">101</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">102</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">103</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">350</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="oochkbsbib" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oochkbsbib table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oochkbsbib thead, #oochkbsbib tbody, #oochkbsbib tfoot, #oochkbsbib tr, #oochkbsbib td, #oochkbsbib th {
  border-style: none;
}

#oochkbsbib p {
  margin: 0;
  padding: 0;
}

#oochkbsbib .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oochkbsbib .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oochkbsbib .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oochkbsbib .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oochkbsbib .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oochkbsbib .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oochkbsbib .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oochkbsbib .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oochkbsbib .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oochkbsbib .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oochkbsbib .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oochkbsbib .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oochkbsbib .gt_spanner_row {
  border-bottom-style: hidden;
}

#oochkbsbib .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oochkbsbib .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oochkbsbib .gt_from_md > :first-child {
  margin-top: 0;
}

#oochkbsbib .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oochkbsbib .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oochkbsbib .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oochkbsbib .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oochkbsbib .gt_row_group_first td {
  border-top-width: 2px;
}

#oochkbsbib .gt_row_group_first th {
  border-top-width: 2px;
}

#oochkbsbib .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oochkbsbib .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oochkbsbib .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oochkbsbib .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oochkbsbib .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oochkbsbib .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oochkbsbib .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oochkbsbib .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oochkbsbib .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oochkbsbib .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oochkbsbib .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oochkbsbib .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oochkbsbib .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oochkbsbib .gt_left {
  text-align: left;
}

#oochkbsbib .gt_center {
  text-align: center;
}

#oochkbsbib .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oochkbsbib .gt_font_normal {
  font-weight: normal;
}

#oochkbsbib .gt_font_bold {
  font-weight: bold;
}

#oochkbsbib .gt_font_italic {
  font-style: italic;
}

#oochkbsbib .gt_super {
  font-size: 65%;
}

#oochkbsbib .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oochkbsbib .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oochkbsbib .gt_indent_1 {
  text-indent: 5px;
}

#oochkbsbib .gt_indent_2 {
  text-indent: 10px;
}

#oochkbsbib .gt_indent_3 {
  text-indent: 15px;
}

#oochkbsbib .gt_indent_4 {
  text-indent: 20px;
}

#oochkbsbib .gt_indent_5 {
  text-indent: 25px;
}

#oochkbsbib .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oochkbsbib div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Grouped Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
</section>
<section id="simple-group-by-with-count" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="simple-group-by-with-count"><span class="header-section-number">7.1.1</span> Simple GROUP BY with <code>COUNT()</code></h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-3-1"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- To count the number of sales per store</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-2" class="code-annotation-target"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-3-3"><a href="#annotated-cell-3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="2">2</button><span id="annotated-cell-3-4" class="code-annotation-target"><a href="#annotated-cell-3-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-3" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="zyyybxames" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#zyyybxames table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#zyyybxames thead, #zyyybxames tbody, #zyyybxames tfoot, #zyyybxames tr, #zyyybxames td, #zyyybxames th {
  border-style: none;
}

#zyyybxames p {
  margin: 0;
  padding: 0;
}

#zyyybxames .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zyyybxames .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#zyyybxames .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zyyybxames .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zyyybxames .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zyyybxames .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zyyybxames .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zyyybxames .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zyyybxames .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zyyybxames .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zyyybxames .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zyyybxames .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zyyybxames .gt_spanner_row {
  border-bottom-style: hidden;
}

#zyyybxames .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#zyyybxames .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zyyybxames .gt_from_md > :first-child {
  margin-top: 0;
}

#zyyybxames .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zyyybxames .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zyyybxames .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#zyyybxames .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zyyybxames .gt_row_group_first td {
  border-top-width: 2px;
}

#zyyybxames .gt_row_group_first th {
  border-top-width: 2px;
}

#zyyybxames .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zyyybxames .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zyyybxames .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zyyybxames .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zyyybxames .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zyyybxames .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zyyybxames .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#zyyybxames .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zyyybxames .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zyyybxames .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zyyybxames .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zyyybxames .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zyyybxames .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zyyybxames .gt_left {
  text-align: left;
}

#zyyybxames .gt_center {
  text-align: center;
}

#zyyybxames .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zyyybxames .gt_font_normal {
  font-weight: normal;
}

#zyyybxames .gt_font_bold {
  font-weight: bold;
}

#zyyybxames .gt_font_italic {
  font-style: italic;
}

#zyyybxames .gt_super {
  font-size: 65%;
}

#zyyybxames .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#zyyybxames .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zyyybxames .gt_indent_1 {
  text-indent: 5px;
}

#zyyybxames .gt_indent_2 {
  text-indent: 10px;
}

#zyyybxames .gt_indent_3 {
  text-indent: 15px;
}

#zyyybxames .gt_indent_4 {
  text-indent: 20px;
}

#zyyybxames .gt_indent_5 {
  text-indent: 25px;
}

#zyyybxames .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#zyyybxames div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_number_of_sales" class="gt_row gt_center">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_number_of_sales" class="gt_row gt_center">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="group-by-with-multiple-columns" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="group-by-with-multiple-columns"><span class="header-section-number">7.1.2</span> GROUP BY with multiple columns</h3>
<p>Grouping by multiple columns can give more <em>granular summaries</em>.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- count the number of sales per store and product:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-2" class="code-annotation-target"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, product_id, <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> total_number_of_sales</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id, product_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="2" data-code-annotation="1">Count the number of sales made in each group.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store and product id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="xtnxgyrbqt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xtnxgyrbqt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xtnxgyrbqt thead, #xtnxgyrbqt tbody, #xtnxgyrbqt tfoot, #xtnxgyrbqt tr, #xtnxgyrbqt td, #xtnxgyrbqt th {
  border-style: none;
}

#xtnxgyrbqt p {
  margin: 0;
  padding: 0;
}

#xtnxgyrbqt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xtnxgyrbqt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xtnxgyrbqt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xtnxgyrbqt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xtnxgyrbqt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xtnxgyrbqt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtnxgyrbqt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xtnxgyrbqt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xtnxgyrbqt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xtnxgyrbqt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xtnxgyrbqt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xtnxgyrbqt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xtnxgyrbqt .gt_spanner_row {
  border-bottom-style: hidden;
}

#xtnxgyrbqt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xtnxgyrbqt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xtnxgyrbqt .gt_from_md > :first-child {
  margin-top: 0;
}

#xtnxgyrbqt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xtnxgyrbqt .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xtnxgyrbqt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#xtnxgyrbqt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xtnxgyrbqt .gt_row_group_first td {
  border-top-width: 2px;
}

#xtnxgyrbqt .gt_row_group_first th {
  border-top-width: 2px;
}

#xtnxgyrbqt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtnxgyrbqt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xtnxgyrbqt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xtnxgyrbqt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtnxgyrbqt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtnxgyrbqt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xtnxgyrbqt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xtnxgyrbqt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xtnxgyrbqt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtnxgyrbqt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xtnxgyrbqt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtnxgyrbqt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xtnxgyrbqt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtnxgyrbqt .gt_left {
  text-align: left;
}

#xtnxgyrbqt .gt_center {
  text-align: center;
}

#xtnxgyrbqt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xtnxgyrbqt .gt_font_normal {
  font-weight: normal;
}

#xtnxgyrbqt .gt_font_bold {
  font-weight: bold;
}

#xtnxgyrbqt .gt_font_italic {
  font-style: italic;
}

#xtnxgyrbqt .gt_super {
  font-size: 65%;
}

#xtnxgyrbqt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xtnxgyrbqt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xtnxgyrbqt .gt_indent_1 {
  text-indent: 5px;
}

#xtnxgyrbqt .gt_indent_2 {
  text-indent: 10px;
}

#xtnxgyrbqt .gt_indent_3 {
  text-indent: 15px;
}

#xtnxgyrbqt .gt_indent_4 {
  text-indent: 20px;
}

#xtnxgyrbqt .gt_indent_5 {
  text-indent: 25px;
}

#xtnxgyrbqt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xtnxgyrbqt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="product_id">product_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_number_of_sales">total_number_of_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">201</td>
<td headers="total_number_of_sales" class="gt_row gt_center">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="product_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">202</td>
<td headers="total_number_of_sales" class="gt_row gt_center">2</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="using-aggregate-functions" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="using-aggregate-functions"><span class="header-section-number">7.1.3</span> Using aggregate functions</h3>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Calculate the average amount of sales per store:</span></span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, </span>
<span id="annotated-cell-5-3"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(amount) <span class="kw">AS</span> <span class="fu">count</span>,</span>
<span id="annotated-cell-5-4"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MIN</span>(amount) <span class="kw">AS</span>, lowest_amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1">1</button><span id="annotated-cell-5-5" class="code-annotation-target"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">AVG</span>(amount) <span class="kw">AS</span> average_amount,</span>
<span id="annotated-cell-5-6"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MAX</span>(amount) <span class="kw">AS</span> highest_amount,</span>
<span id="annotated-cell-5-7"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_anount</span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2">2</button><span id="annotated-cell-5-9" class="code-annotation-target"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="5" data-code-annotation="1">Get the average of all the amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="9" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="hzipfvorhs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hzipfvorhs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hzipfvorhs thead, #hzipfvorhs tbody, #hzipfvorhs tfoot, #hzipfvorhs tr, #hzipfvorhs td, #hzipfvorhs th {
  border-style: none;
}

#hzipfvorhs p {
  margin: 0;
  padding: 0;
}

#hzipfvorhs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hzipfvorhs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hzipfvorhs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hzipfvorhs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hzipfvorhs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hzipfvorhs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hzipfvorhs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hzipfvorhs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hzipfvorhs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hzipfvorhs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hzipfvorhs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hzipfvorhs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hzipfvorhs .gt_spanner_row {
  border-bottom-style: hidden;
}

#hzipfvorhs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hzipfvorhs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hzipfvorhs .gt_from_md > :first-child {
  margin-top: 0;
}

#hzipfvorhs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hzipfvorhs .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hzipfvorhs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#hzipfvorhs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hzipfvorhs .gt_row_group_first td {
  border-top-width: 2px;
}

#hzipfvorhs .gt_row_group_first th {
  border-top-width: 2px;
}

#hzipfvorhs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hzipfvorhs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hzipfvorhs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hzipfvorhs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hzipfvorhs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hzipfvorhs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hzipfvorhs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hzipfvorhs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hzipfvorhs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hzipfvorhs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hzipfvorhs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hzipfvorhs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hzipfvorhs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hzipfvorhs .gt_left {
  text-align: left;
}

#hzipfvorhs .gt_center {
  text-align: center;
}

#hzipfvorhs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hzipfvorhs .gt_font_normal {
  font-weight: normal;
}

#hzipfvorhs .gt_font_bold {
  font-weight: bold;
}

#hzipfvorhs .gt_font_italic {
  font-style: italic;
}

#hzipfvorhs .gt_super {
  font-size: 65%;
}

#hzipfvorhs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hzipfvorhs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hzipfvorhs .gt_indent_1 {
  text-indent: 5px;
}

#hzipfvorhs .gt_indent_2 {
  text-indent: 10px;
}

#hzipfvorhs .gt_indent_3 {
  text-indent: 15px;
}

#hzipfvorhs .gt_indent_4 {
  text-indent: 20px;
}

#hzipfvorhs .gt_indent_5 {
  text-indent: 25px;
}

#hzipfvorhs .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hzipfvorhs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="count">count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="lowest_amount">lowest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="average_amount">average_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="highest_amount">highest_amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="count" class="gt_row gt_right">4</td>
<td headers="lowest_amount" class="gt_row gt_right">100</td>
<td headers="average_amount" class="gt_row gt_right">225</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="count" class="gt_row gt_right">3</td>
<td headers="lowest_amount" class="gt_row gt_right">200</td>
<td headers="average_amount" class="gt_row gt_right">200</td>
<td headers="highest_amount" class="gt_row gt_right">200</td>
<td headers="total_amount" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="count" class="gt_row gt_right">5</td>
<td headers="lowest_amount" class="gt_row gt_right">150</td>
<td headers="average_amount" class="gt_row gt_right">250</td>
<td headers="highest_amount" class="gt_row gt_right">350</td>
<td headers="total_amount" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
<section id="having-clause-with-group-by" class="level3" data-number="7.1.4">
<h3 data-number="7.1.4" class="anchored" data-anchor-id="having-clause-with-group-by"><span class="header-section-number">7.1.4</span> <code>HAVING</code> clause with GROUP BY</h3>
<p>The <code>HAVING</code> clause is used to filter groups <strong>after the aggregation</strong>.</p>
<section id="quick-illustration-of-using-having" class="level4" data-number="7.1.4.1">
<h4 data-number="7.1.4.1" class="anchored" data-anchor-id="quick-illustration-of-using-having"><span class="header-section-number">7.1.4.1</span> Quick Illustration of using HAVING</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-6-1"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-6-2"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1">1</button><span id="annotated-cell-6-3" class="code-annotation-target"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span>
<span id="annotated-cell-6-4"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-6-6"><a href="#annotated-cell-6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-6-7"><a href="#annotated-cell-6-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2">2</button><span id="annotated-cell-6-8" class="code-annotation-target"><a href="#annotated-cell-6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">600</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="3" data-code-annotation="1">Group the table using the <code>store_id</code></span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="8" data-code-annotation="2">Filter only stores with <code>total_amount</code> greater than 600</span>
</dd>
</dl>
</div>
</div>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="yzcgpgbkbs" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yzcgpgbkbs table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yzcgpgbkbs thead, #yzcgpgbkbs tbody, #yzcgpgbkbs tfoot, #yzcgpgbkbs tr, #yzcgpgbkbs td, #yzcgpgbkbs th {
  border-style: none;
}

#yzcgpgbkbs p {
  margin: 0;
  padding: 0;
}

#yzcgpgbkbs .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yzcgpgbkbs .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yzcgpgbkbs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yzcgpgbkbs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yzcgpgbkbs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzcgpgbkbs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzcgpgbkbs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yzcgpgbkbs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yzcgpgbkbs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yzcgpgbkbs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yzcgpgbkbs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yzcgpgbkbs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yzcgpgbkbs .gt_spanner_row {
  border-bottom-style: hidden;
}

#yzcgpgbkbs .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yzcgpgbkbs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yzcgpgbkbs .gt_from_md > :first-child {
  margin-top: 0;
}

#yzcgpgbkbs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yzcgpgbkbs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yzcgpgbkbs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yzcgpgbkbs .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yzcgpgbkbs .gt_row_group_first td {
  border-top-width: 2px;
}

#yzcgpgbkbs .gt_row_group_first th {
  border-top-width: 2px;
}

#yzcgpgbkbs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzcgpgbkbs .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yzcgpgbkbs .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yzcgpgbkbs .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzcgpgbkbs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzcgpgbkbs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yzcgpgbkbs .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yzcgpgbkbs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yzcgpgbkbs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yzcgpgbkbs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzcgpgbkbs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzcgpgbkbs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yzcgpgbkbs .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yzcgpgbkbs .gt_left {
  text-align: left;
}

#yzcgpgbkbs .gt_center {
  text-align: center;
}

#yzcgpgbkbs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yzcgpgbkbs .gt_font_normal {
  font-weight: normal;
}

#yzcgpgbkbs .gt_font_bold {
  font-weight: bold;
}

#yzcgpgbkbs .gt_font_italic {
  font-style: italic;
}

#yzcgpgbkbs .gt_super {
  font-size: 65%;
}

#yzcgpgbkbs .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yzcgpgbkbs .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yzcgpgbkbs .gt_indent_1 {
  text-indent: 5px;
}

#yzcgpgbkbs .gt_indent_2 {
  text-indent: 10px;
}

#yzcgpgbkbs .gt_indent_3 {
  text-indent: 15px;
}

#yzcgpgbkbs .gt_indent_4 {
  text-indent: 20px;
}

#yzcgpgbkbs .gt_indent_5 {
  text-indent: 25px;
}

#yzcgpgbkbs .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yzcgpgbkbs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Grouped Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">102</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder; font-size: 20;">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="vvwddpbzqn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vvwddpbzqn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vvwddpbzqn thead, #vvwddpbzqn tbody, #vvwddpbzqn tfoot, #vvwddpbzqn tr, #vvwddpbzqn td, #vvwddpbzqn th {
  border-style: none;
}

#vvwddpbzqn p {
  margin: 0;
  padding: 0;
}

#vvwddpbzqn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vvwddpbzqn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vvwddpbzqn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vvwddpbzqn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vvwddpbzqn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vvwddpbzqn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vvwddpbzqn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vvwddpbzqn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vvwddpbzqn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vvwddpbzqn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vvwddpbzqn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vvwddpbzqn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vvwddpbzqn .gt_spanner_row {
  border-bottom-style: hidden;
}

#vvwddpbzqn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vvwddpbzqn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vvwddpbzqn .gt_from_md > :first-child {
  margin-top: 0;
}

#vvwddpbzqn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vvwddpbzqn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vvwddpbzqn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vvwddpbzqn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vvwddpbzqn .gt_row_group_first td {
  border-top-width: 2px;
}

#vvwddpbzqn .gt_row_group_first th {
  border-top-width: 2px;
}

#vvwddpbzqn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvwddpbzqn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vvwddpbzqn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vvwddpbzqn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vvwddpbzqn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvwddpbzqn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vvwddpbzqn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vvwddpbzqn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vvwddpbzqn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vvwddpbzqn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vvwddpbzqn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvwddpbzqn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vvwddpbzqn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvwddpbzqn .gt_left {
  text-align: left;
}

#vvwddpbzqn .gt_center {
  text-align: center;
}

#vvwddpbzqn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vvwddpbzqn .gt_font_normal {
  font-weight: normal;
}

#vvwddpbzqn .gt_font_bold {
  font-weight: bold;
}

#vvwddpbzqn .gt_font_italic {
  font-style: italic;
}

#vvwddpbzqn .gt_super {
  font-size: 65%;
}

#vvwddpbzqn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vvwddpbzqn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vvwddpbzqn .gt_indent_1 {
  text-indent: 5px;
}

#vvwddpbzqn .gt_indent_2 {
  text-indent: 10px;
}

#vvwddpbzqn .gt_indent_3 {
  text-indent: 15px;
}

#vvwddpbzqn .gt_indent_4 {
  text-indent: 20px;
}

#vvwddpbzqn .gt_indent_5 {
  text-indent: 25px;
}

#vvwddpbzqn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vvwddpbzqn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false"><caption><p>Filtered Records</p></caption>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">101</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder; font-size: 20;">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: normal;">103</td>
<td headers="total_amount" class="gt_row gt_center" style="background-color: #F0F8FF; font-weight: bolder; font-size: 20;">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why HAVING when there is WHERE
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>HAVING</code> is used because <code>WHERE</code> can’t filter on aggregate functions (like <code>SUM</code>, <code>AVG</code>, <code>COUNT</code>) that are often used with grouped data.</p>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-7"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-7-1"><a href="#annotated-cell-7-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find stores with total sales greater than N300:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="1">1</button><span id="annotated-cell-7-2" class="code-annotation-target"><a href="#annotated-cell-7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> store_id, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-7-3"><a href="#annotated-cell-7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="2">2</button><span id="annotated-cell-7-4" class="code-annotation-target"><a href="#annotated-cell-7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-7" data-target-annotation="3">3</button><span id="annotated-cell-7-5" class="code-annotation-target"><a href="#annotated-cell-7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">HAVING</span> <span class="fu">SUM</span>(amount) <span class="op">&gt;</span> <span class="dv">300</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-7" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="4" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-7" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-7" data-code-lines="5" data-code-annotation="3">Filter all total_sales_amount greater than 300.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="wzgabhystw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wzgabhystw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wzgabhystw thead, #wzgabhystw tbody, #wzgabhystw tfoot, #wzgabhystw tr, #wzgabhystw td, #wzgabhystw th {
  border-style: none;
}

#wzgabhystw p {
  margin: 0;
  padding: 0;
}

#wzgabhystw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wzgabhystw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wzgabhystw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wzgabhystw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wzgabhystw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wzgabhystw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzgabhystw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wzgabhystw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wzgabhystw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wzgabhystw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wzgabhystw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wzgabhystw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wzgabhystw .gt_spanner_row {
  border-bottom-style: hidden;
}

#wzgabhystw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wzgabhystw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wzgabhystw .gt_from_md > :first-child {
  margin-top: 0;
}

#wzgabhystw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wzgabhystw .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wzgabhystw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#wzgabhystw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wzgabhystw .gt_row_group_first td {
  border-top-width: 2px;
}

#wzgabhystw .gt_row_group_first th {
  border-top-width: 2px;
}

#wzgabhystw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzgabhystw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wzgabhystw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wzgabhystw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzgabhystw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzgabhystw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wzgabhystw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wzgabhystw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wzgabhystw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wzgabhystw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wzgabhystw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzgabhystw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wzgabhystw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wzgabhystw .gt_left {
  text-align: left;
}

#wzgabhystw .gt_center {
  text-align: center;
}

#wzgabhystw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wzgabhystw .gt_font_normal {
  font-weight: normal;
}

#wzgabhystw .gt_font_bold {
  font-weight: bold;
}

#wzgabhystw .gt_font_italic {
  font-style: italic;
}

#wzgabhystw .gt_super {
  font-size: 65%;
}

#wzgabhystw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wzgabhystw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wzgabhystw .gt_indent_1 {
  text-indent: 5px;
}

#wzgabhystw .gt_indent_2 {
  text-indent: 10px;
}

#wzgabhystw .gt_indent_3 {
  text-indent: 15px;
}

#wzgabhystw .gt_indent_4 {
  text-indent: 20px;
}

#wzgabhystw .gt_indent_5 {
  text-indent: 25px;
}

#wzgabhystw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wzgabhystw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_left">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_left">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_left">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="group-by-with-date" class="level3" data-number="7.1.5">
<h3 data-number="7.1.5" class="anchored" data-anchor-id="group-by-with-date"><span class="header-section-number">7.1.5</span> GROUP BY with <code>DATE</code></h3>
<p>You can also group by date or time intervals.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- find the total sales per day:</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-2" class="code-annotation-target"><a href="#annotated-cell-8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> sales_date, <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-8-3"><a href="#annotated-cell-8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-4" class="code-annotation-target"><a href="#annotated-cell-8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> sales_date;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="2" data-code-annotation="1">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-8" data-code-lines="4" data-code-annotation="2">Group all rows by each unique date (day).</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="hankuojspc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hankuojspc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hankuojspc thead, #hankuojspc tbody, #hankuojspc tfoot, #hankuojspc tr, #hankuojspc td, #hankuojspc th {
  border-style: none;
}

#hankuojspc p {
  margin: 0;
  padding: 0;
}

#hankuojspc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hankuojspc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hankuojspc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hankuojspc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hankuojspc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hankuojspc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hankuojspc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hankuojspc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hankuojspc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hankuojspc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hankuojspc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hankuojspc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hankuojspc .gt_spanner_row {
  border-bottom-style: hidden;
}

#hankuojspc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hankuojspc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hankuojspc .gt_from_md > :first-child {
  margin-top: 0;
}

#hankuojspc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hankuojspc .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hankuojspc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#hankuojspc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hankuojspc .gt_row_group_first td {
  border-top-width: 2px;
}

#hankuojspc .gt_row_group_first th {
  border-top-width: 2px;
}

#hankuojspc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hankuojspc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hankuojspc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hankuojspc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hankuojspc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hankuojspc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hankuojspc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hankuojspc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hankuojspc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hankuojspc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hankuojspc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hankuojspc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hankuojspc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hankuojspc .gt_left {
  text-align: left;
}

#hankuojspc .gt_center {
  text-align: center;
}

#hankuojspc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hankuojspc .gt_font_normal {
  font-weight: normal;
}

#hankuojspc .gt_font_bold {
  font-weight: bold;
}

#hankuojspc .gt_font_italic {
  font-style: italic;
}

#hankuojspc .gt_super {
  font-size: 65%;
}

#hankuojspc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hankuojspc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hankuojspc .gt_indent_1 {
  text-indent: 5px;
}

#hankuojspc .gt_indent_2 {
  text-indent: 10px;
}

#hankuojspc .gt_indent_3 {
  text-indent: 15px;
}

#hankuojspc .gt_indent_4 {
  text-indent: 20px;
}

#hankuojspc .gt_indent_5 {
  text-indent: 25px;
}

#hankuojspc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hankuojspc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="daily_sales" class="gt_row gt_center">250</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="daily_sales" class="gt_row gt_center">450</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="daily_sales" class="gt_row gt_center">600</td></tr>
    <tr><td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="daily_sales" class="gt_row gt_center">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-expressions" class="level3" data-number="7.1.6">
<h3 data-number="7.1.6" class="anchored" data-anchor-id="group-by-with-expressions"><span class="header-section-number">7.1.6</span> GROUP BY with expressions</h3>
<p>You can also use expressions or functions in <code>GROUP BY</code></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-9-1"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Group by the year of the sales date:</span></span>
<span id="annotated-cell-9-2"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-9-3"><a href="#annotated-cell-9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span>  </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-4" class="code-annotation-target"><a href="#annotated-cell-9-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date) <span class="kw">AS</span> sales_day,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2">2</button><span id="annotated-cell-9-5" class="code-annotation-target"><a href="#annotated-cell-9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> daily_sales</span>
<span id="annotated-cell-9-6"><a href="#annotated-cell-9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="3">3</button><span id="annotated-cell-9-7" class="code-annotation-target"><a href="#annotated-cell-9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> <span class="fu">EXTRACT</span>(<span class="dt">DAY</span> <span class="kw">FROM</span> sales_date);</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="4" data-code-annotation="1">Extract the day from the date.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="5" data-code-annotation="2">Sum up all the total amount of sales per day.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="7" data-code-annotation="3">Group all rows by each unique day.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="yldprkuxmt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yldprkuxmt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yldprkuxmt thead, #yldprkuxmt tbody, #yldprkuxmt tfoot, #yldprkuxmt tr, #yldprkuxmt td, #yldprkuxmt th {
  border-style: none;
}

#yldprkuxmt p {
  margin: 0;
  padding: 0;
}

#yldprkuxmt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yldprkuxmt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yldprkuxmt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yldprkuxmt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yldprkuxmt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yldprkuxmt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yldprkuxmt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yldprkuxmt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yldprkuxmt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yldprkuxmt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yldprkuxmt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yldprkuxmt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yldprkuxmt .gt_spanner_row {
  border-bottom-style: hidden;
}

#yldprkuxmt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yldprkuxmt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yldprkuxmt .gt_from_md > :first-child {
  margin-top: 0;
}

#yldprkuxmt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yldprkuxmt .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yldprkuxmt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#yldprkuxmt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yldprkuxmt .gt_row_group_first td {
  border-top-width: 2px;
}

#yldprkuxmt .gt_row_group_first th {
  border-top-width: 2px;
}

#yldprkuxmt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yldprkuxmt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yldprkuxmt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yldprkuxmt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yldprkuxmt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yldprkuxmt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yldprkuxmt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yldprkuxmt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yldprkuxmt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yldprkuxmt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yldprkuxmt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yldprkuxmt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yldprkuxmt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yldprkuxmt .gt_left {
  text-align: left;
}

#yldprkuxmt .gt_center {
  text-align: center;
}

#yldprkuxmt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yldprkuxmt .gt_font_normal {
  font-weight: normal;
}

#yldprkuxmt .gt_font_bold {
  font-weight: bold;
}

#yldprkuxmt .gt_font_italic {
  font-style: italic;
}

#yldprkuxmt .gt_super {
  font-size: 65%;
}

#yldprkuxmt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yldprkuxmt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yldprkuxmt .gt_indent_1 {
  text-indent: 5px;
}

#yldprkuxmt .gt_indent_2 {
  text-indent: 10px;
}

#yldprkuxmt .gt_indent_3 {
  text-indent: 15px;
}

#yldprkuxmt .gt_indent_4 {
  text-indent: 20px;
}

#yldprkuxmt .gt_indent_5 {
  text-indent: 25px;
}

#yldprkuxmt .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yldprkuxmt div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="sales_day">sales_day</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="daily_sales">daily_sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">1</td>
<td headers="daily_sales" class="gt_row gt_right">250</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">2</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">3</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">4</td>
<td headers="daily_sales" class="gt_row gt_right">450</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">5</td>
<td headers="daily_sales" class="gt_row gt_right">600</td></tr>
    <tr><td headers="sales_day" class="gt_row gt_center" style="color: #2F4F4F; font-weight: bolder;">6</td>
<td headers="daily_sales" class="gt_row gt_right">550</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="group-by-with-order-by" class="level3" data-number="7.1.7">
<h3 data-number="7.1.7" class="anchored" data-anchor-id="group-by-with-order-by"><span class="header-section-number">7.1.7</span> GROUP BY with <code>ORDER BY</code></h3>
<p>You can order the results of a <code>GROUP BY</code> query by the aggregated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-10-2"><a href="#annotated-cell-10-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="1">1</button><span id="annotated-cell-10-3" class="code-annotation-target"><a href="#annotated-cell-10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">AS</span> total_sales_amount</span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="2">2</button><span id="annotated-cell-10-5" class="code-annotation-target"><a href="#annotated-cell-10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="3">3</button><span id="annotated-cell-10-6" class="code-annotation-target"><a href="#annotated-cell-10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> total_sales_amount <span class="kw">DESC</span>;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="3" data-code-annotation="1">Sum up all the total amount of sales per store.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="5" data-code-annotation="2">Group all rows by each unique store id.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-10" data-code-lines="6" data-code-annotation="3">Sort the aggregated output by the total sales amount in descending order.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="iydhsfqabg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#iydhsfqabg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#iydhsfqabg thead, #iydhsfqabg tbody, #iydhsfqabg tfoot, #iydhsfqabg tr, #iydhsfqabg td, #iydhsfqabg th {
  border-style: none;
}

#iydhsfqabg p {
  margin: 0;
  padding: 0;
}

#iydhsfqabg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iydhsfqabg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#iydhsfqabg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iydhsfqabg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iydhsfqabg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iydhsfqabg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iydhsfqabg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iydhsfqabg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iydhsfqabg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iydhsfqabg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iydhsfqabg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iydhsfqabg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iydhsfqabg .gt_spanner_row {
  border-bottom-style: hidden;
}

#iydhsfqabg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#iydhsfqabg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iydhsfqabg .gt_from_md > :first-child {
  margin-top: 0;
}

#iydhsfqabg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iydhsfqabg .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iydhsfqabg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#iydhsfqabg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#iydhsfqabg .gt_row_group_first td {
  border-top-width: 2px;
}

#iydhsfqabg .gt_row_group_first th {
  border-top-width: 2px;
}

#iydhsfqabg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iydhsfqabg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#iydhsfqabg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#iydhsfqabg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iydhsfqabg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iydhsfqabg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iydhsfqabg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#iydhsfqabg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iydhsfqabg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iydhsfqabg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iydhsfqabg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iydhsfqabg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iydhsfqabg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#iydhsfqabg .gt_left {
  text-align: left;
}

#iydhsfqabg .gt_center {
  text-align: center;
}

#iydhsfqabg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iydhsfqabg .gt_font_normal {
  font-weight: normal;
}

#iydhsfqabg .gt_font_bold {
  font-weight: bold;
}

#iydhsfqabg .gt_font_italic {
  font-style: italic;
}

#iydhsfqabg .gt_super {
  font-size: 65%;
}

#iydhsfqabg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#iydhsfqabg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#iydhsfqabg .gt_indent_1 {
  text-indent: 5px;
}

#iydhsfqabg .gt_indent_2 {
  text-indent: 10px;
}

#iydhsfqabg .gt_indent_3 {
  text-indent: 15px;
}

#iydhsfqabg .gt_indent_4 {
  text-indent: 20px;
}

#iydhsfqabg .gt_indent_5 {
  text-indent: 25px;
}

#iydhsfqabg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#iydhsfqabg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_sales_amount">total_sales_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="total_sales_amount" class="gt_row gt_center">1250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="total_sales_amount" class="gt_row gt_center">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="total_sales_amount" class="gt_row gt_center">600</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="grouping-with-a-conditional-aggregate" class="level3" data-number="7.1.8">
<h3 data-number="7.1.8" class="anchored" data-anchor-id="grouping-with-a-conditional-aggregate"><span class="header-section-number">7.1.8</span> Grouping with a conditional aggregate</h3>
<p>To calculate the number of sales and the total amount for each store, but only for sales over $100:</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-11"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-11-1"><a href="#annotated-cell-11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="1">1</button><span id="annotated-cell-11-2" class="code-annotation-target"><a href="#annotated-cell-11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">COUNT</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> <span class="dv">1</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_sales_count,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-11" data-target-annotation="2">2</button><span id="annotated-cell-11-3" class="code-annotation-target"><a href="#annotated-cell-11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(<span class="cf">CASE</span> <span class="cf">WHEN</span> amount <span class="op">&gt;</span> <span class="dv">100</span> <span class="cf">THEN</span> amount <span class="cf">ELSE</span> <span class="dv">0</span> <span class="cf">END</span>) <span class="kw">AS</span> high_value_total_amount</span>
<span id="annotated-cell-11-4"><a href="#annotated-cell-11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales</span>
<span id="annotated-cell-11-5"><a href="#annotated-cell-11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> store_id;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-11" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="2" data-code-annotation="1">If sales amount is greater than 100 count it.</span>
</dd>
<dt data-target-cell="annotated-cell-11" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-11" data-code-lines="3" data-code-annotation="2">If sales amount is greater than 100 then add sales amount else add zero.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="vxawmuhklk" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vxawmuhklk table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vxawmuhklk thead, #vxawmuhklk tbody, #vxawmuhklk tfoot, #vxawmuhklk tr, #vxawmuhklk td, #vxawmuhklk th {
  border-style: none;
}

#vxawmuhklk p {
  margin: 0;
  padding: 0;
}

#vxawmuhklk .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vxawmuhklk .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vxawmuhklk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vxawmuhklk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vxawmuhklk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vxawmuhklk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vxawmuhklk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vxawmuhklk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vxawmuhklk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vxawmuhklk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vxawmuhklk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vxawmuhklk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vxawmuhklk .gt_spanner_row {
  border-bottom-style: hidden;
}

#vxawmuhklk .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vxawmuhklk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vxawmuhklk .gt_from_md > :first-child {
  margin-top: 0;
}

#vxawmuhklk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vxawmuhklk .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vxawmuhklk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#vxawmuhklk .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vxawmuhklk .gt_row_group_first td {
  border-top-width: 2px;
}

#vxawmuhklk .gt_row_group_first th {
  border-top-width: 2px;
}

#vxawmuhklk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vxawmuhklk .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vxawmuhklk .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vxawmuhklk .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vxawmuhklk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vxawmuhklk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vxawmuhklk .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vxawmuhklk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vxawmuhklk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vxawmuhklk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vxawmuhklk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vxawmuhklk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vxawmuhklk .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vxawmuhklk .gt_left {
  text-align: left;
}

#vxawmuhklk .gt_center {
  text-align: center;
}

#vxawmuhklk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vxawmuhklk .gt_font_normal {
  font-weight: normal;
}

#vxawmuhklk .gt_font_bold {
  font-weight: bold;
}

#vxawmuhklk .gt_font_italic {
  font-style: italic;
}

#vxawmuhklk .gt_super {
  font-size: 65%;
}

#vxawmuhklk .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vxawmuhklk .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vxawmuhklk .gt_indent_1 {
  text-indent: 5px;
}

#vxawmuhklk .gt_indent_2 {
  text-indent: 10px;
}

#vxawmuhklk .gt_indent_3 {
  text-indent: 15px;
}

#vxawmuhklk .gt_indent_4 {
  text-indent: 20px;
}

#vxawmuhklk .gt_indent_5 {
  text-indent: 25px;
}

#vxawmuhklk .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vxawmuhklk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_sales_count">high_value_sales_count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="high_value_total_amount">high_value_total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">101</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">800</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">102</td>
<td headers="high_value_sales_count" class="gt_row gt_center">3</td>
<td headers="high_value_total_amount" class="gt_row gt_center">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">103</td>
<td headers="high_value_sales_count" class="gt_row gt_center">5</td>
<td headers="high_value_total_amount" class="gt_row gt_center">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Group by Summary
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>It is often used with aggregate functions <strong>to perform calculations on each group.</strong></p></li>
<li><p><code>HAVING</code> clause can be used to filter groups after the aggregation.</p></li>
<li><p><code>ORDER BY</code> can be combined with <code>GROUP BY</code> to sort the results by the aggregated values.</p></li>
</ul>
</div>
</div>
<p><br> <br> <br></p>
<!------- GROUP BY ---------------------------------------------------------->
</section>
</section>
<section id="window-function" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="window-function"><span class="header-section-number">7.2</span> Window Function</h2>
<p>Window functions <strong>perform calculations across a set of table rows related to the current row</strong>. Unlike aggregate functions, which return a single value after grouping rows, window functions return multiple rows with calculated values.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-12-2"><a href="#annotated-cell-12-2" aria-hidden="true" tabindex="-1"></a>  col_name1, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="1">1</button><span id="annotated-cell-12-3" class="code-annotation-target"><a href="#annotated-cell-12-3" aria-hidden="true" tabindex="-1"></a>  window_function() <span class="kw">OVER</span> ([<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2] [<span class="kw">ORDER</span> <span class="kw">BY</span> col_name3]) <span class="kw">AS</span> alias_name</span>
<span id="annotated-cell-12-4"><a href="#annotated-cell-12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> table_name;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-12" data-code-lines="3" data-code-annotation="1">Define the window function and how it should be grouped and sorted.</span>
</dd>
</dl>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Key Concepts of Window Function
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><code>OVER()</code> Clause defines the window of rows the function operates on.</li>
<li><code>PARTITION BY</code> divides the result set into <strong>partitions</strong> (like a GROUP BY).</li>
<li><code>ORDER BY</code> defines the order of rows within each partition.</li>
</ul>
</div>
</div>
<section id="row_number" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="row_number"><span class="header-section-number">7.2.1</span> ROW_NUMBER</h3>
<p>This function will assign a unique row number within a partition.</p>
</section>
<section id="quick-illustration-of-window-function" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="quick-illustration-of-window-function">Quick illustration of window function</h3>
<p>A Simple example of how window function works.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">row_number</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="laeiupqfte" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#laeiupqfte table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#laeiupqfte thead, #laeiupqfte tbody, #laeiupqfte tfoot, #laeiupqfte tr, #laeiupqfte td, #laeiupqfte th {
  border-style: none;
}

#laeiupqfte p {
  margin: 0;
  padding: 0;
}

#laeiupqfte .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#laeiupqfte .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#laeiupqfte .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#laeiupqfte .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#laeiupqfte .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#laeiupqfte .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#laeiupqfte .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#laeiupqfte .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#laeiupqfte .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#laeiupqfte .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#laeiupqfte .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#laeiupqfte .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#laeiupqfte .gt_spanner_row {
  border-bottom-style: hidden;
}

#laeiupqfte .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#laeiupqfte .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#laeiupqfte .gt_from_md > :first-child {
  margin-top: 0;
}

#laeiupqfte .gt_from_md > :last-child {
  margin-bottom: 0;
}

#laeiupqfte .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#laeiupqfte .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#laeiupqfte .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#laeiupqfte .gt_row_group_first td {
  border-top-width: 2px;
}

#laeiupqfte .gt_row_group_first th {
  border-top-width: 2px;
}

#laeiupqfte .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#laeiupqfte .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#laeiupqfte .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#laeiupqfte .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#laeiupqfte .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#laeiupqfte .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#laeiupqfte .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#laeiupqfte .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#laeiupqfte .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#laeiupqfte .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#laeiupqfte .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#laeiupqfte .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#laeiupqfte .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#laeiupqfte .gt_left {
  text-align: left;
}

#laeiupqfte .gt_center {
  text-align: center;
}

#laeiupqfte .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#laeiupqfte .gt_font_normal {
  font-weight: normal;
}

#laeiupqfte .gt_font_bold {
  font-weight: bold;
}

#laeiupqfte .gt_font_italic {
  font-style: italic;
}

#laeiupqfte .gt_super {
  font-size: 65%;
}

#laeiupqfte .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#laeiupqfte .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#laeiupqfte .gt_indent_1 {
  text-indent: 5px;
}

#laeiupqfte .gt_indent_2 {
  text-indent: 10px;
}

#laeiupqfte .gt_indent_3 {
  text-indent: 15px;
}

#laeiupqfte .gt_indent_4 {
  text-indent: 20px;
}

#laeiupqfte .gt_indent_5 {
  text-indent: 25px;
}

#laeiupqfte .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#laeiupqfte div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="row_number">row_number</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="row_number" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="row_number" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br></p>
<section id="unordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="unordered">Unordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-14"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-14-1"><a href="#annotated-cell-14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-14-2"><a href="#annotated-cell-14-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-14-3"><a href="#annotated-cell-14-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-14-4"><a href="#annotated-cell-14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-14" data-target-annotation="1">1</button><span id="annotated-cell-14-5" class="code-annotation-target"><a href="#annotated-cell-14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-14-6"><a href="#annotated-cell-14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-14" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-14" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id then get the row number for each partition.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="phesuasuxf" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#phesuasuxf table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#phesuasuxf thead, #phesuasuxf tbody, #phesuasuxf tfoot, #phesuasuxf tr, #phesuasuxf td, #phesuasuxf th {
  border-style: none;
}

#phesuasuxf p {
  margin: 0;
  padding: 0;
}

#phesuasuxf .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#phesuasuxf .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#phesuasuxf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#phesuasuxf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#phesuasuxf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#phesuasuxf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#phesuasuxf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#phesuasuxf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#phesuasuxf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#phesuasuxf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#phesuasuxf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#phesuasuxf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#phesuasuxf .gt_spanner_row {
  border-bottom-style: hidden;
}

#phesuasuxf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#phesuasuxf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#phesuasuxf .gt_from_md > :first-child {
  margin-top: 0;
}

#phesuasuxf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#phesuasuxf .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#phesuasuxf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#phesuasuxf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#phesuasuxf .gt_row_group_first td {
  border-top-width: 2px;
}

#phesuasuxf .gt_row_group_first th {
  border-top-width: 2px;
}

#phesuasuxf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#phesuasuxf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#phesuasuxf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#phesuasuxf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#phesuasuxf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#phesuasuxf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#phesuasuxf .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#phesuasuxf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#phesuasuxf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#phesuasuxf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#phesuasuxf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#phesuasuxf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#phesuasuxf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#phesuasuxf .gt_left {
  text-align: left;
}

#phesuasuxf .gt_center {
  text-align: center;
}

#phesuasuxf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#phesuasuxf .gt_font_normal {
  font-weight: normal;
}

#phesuasuxf .gt_font_bold {
  font-weight: bold;
}

#phesuasuxf .gt_font_italic {
  font-style: italic;
}

#phesuasuxf .gt_super {
  font-size: 65%;
}

#phesuasuxf .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#phesuasuxf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#phesuasuxf .gt_indent_1 {
  text-indent: 5px;
}

#phesuasuxf .gt_indent_2 {
  text-indent: 10px;
}

#phesuasuxf .gt_indent_3 {
  text-indent: 15px;
}

#phesuasuxf .gt_indent_4 {
  text-indent: 20px;
}

#phesuasuxf .gt_indent_5 {
  text-indent: 25px;
}

#phesuasuxf .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#phesuasuxf div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="ordered" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="ordered">Ordered</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-15"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-15-1"><a href="#annotated-cell-15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-15-2"><a href="#annotated-cell-15-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="annotated-cell-15-3"><a href="#annotated-cell-15-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="annotated-cell-15-4"><a href="#annotated-cell-15-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-15" data-target-annotation="1">1</button><span id="annotated-cell-15-5" class="code-annotation-target"><a href="#annotated-cell-15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> row_num</span>
<span id="annotated-cell-15-6"><a href="#annotated-cell-15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-15" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-15" data-code-lines="5" data-code-annotation="1">Partition the sales table by the unique store id, then order by the sales date. Then get the row number by the partition. In other words, the rows are numbered sequentially for each store_id based on sales_date.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="uegkcyglaq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uegkcyglaq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uegkcyglaq thead, #uegkcyglaq tbody, #uegkcyglaq tfoot, #uegkcyglaq tr, #uegkcyglaq td, #uegkcyglaq th {
  border-style: none;
}

#uegkcyglaq p {
  margin: 0;
  padding: 0;
}

#uegkcyglaq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uegkcyglaq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uegkcyglaq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uegkcyglaq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uegkcyglaq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uegkcyglaq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uegkcyglaq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uegkcyglaq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uegkcyglaq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uegkcyglaq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uegkcyglaq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uegkcyglaq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uegkcyglaq .gt_spanner_row {
  border-bottom-style: hidden;
}

#uegkcyglaq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uegkcyglaq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uegkcyglaq .gt_from_md > :first-child {
  margin-top: 0;
}

#uegkcyglaq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uegkcyglaq .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uegkcyglaq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#uegkcyglaq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uegkcyglaq .gt_row_group_first td {
  border-top-width: 2px;
}

#uegkcyglaq .gt_row_group_first th {
  border-top-width: 2px;
}

#uegkcyglaq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uegkcyglaq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uegkcyglaq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uegkcyglaq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uegkcyglaq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uegkcyglaq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uegkcyglaq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uegkcyglaq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uegkcyglaq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uegkcyglaq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uegkcyglaq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uegkcyglaq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uegkcyglaq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uegkcyglaq .gt_left {
  text-align: left;
}

#uegkcyglaq .gt_center {
  text-align: center;
}

#uegkcyglaq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uegkcyglaq .gt_font_normal {
  font-weight: normal;
}

#uegkcyglaq .gt_font_bold {
  font-weight: bold;
}

#uegkcyglaq .gt_font_italic {
  font-style: italic;
}

#uegkcyglaq .gt_super {
  font-size: 65%;
}

#uegkcyglaq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uegkcyglaq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uegkcyglaq .gt_indent_1 {
  text-indent: 5px;
}

#uegkcyglaq .gt_indent_2 {
  text-indent: 10px;
}

#uegkcyglaq .gt_indent_3 {
  text-indent: 15px;
}

#uegkcyglaq .gt_indent_4 {
  text-indent: 20px;
}

#uegkcyglaq .gt_indent_5 {
  text-indent: 25px;
}

#uegkcyglaq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uegkcyglaq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="row_num">row_num</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="row_num" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="row_num" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="row_num" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="aggregate-function-sum-as-a-window-function" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="aggregate-function-sum-as-a-window-function"><span class="header-section-number">7.2.2</span> Aggregate function: SUM() as a Window Function</h3>
<section id="quick-illustration-of-window-aggregate-functions" class="level4" data-number="7.2.2.1">
<h4 data-number="7.2.2.1" class="anchored" data-anchor-id="quick-illustration-of-window-aggregate-functions"><span class="header-section-number">7.2.2.1</span> Quick Illustration of window aggregate functions</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-16"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-16-1"><a href="#annotated-cell-16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="annotated-cell-16-2"><a href="#annotated-cell-16-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">month</span>, </span>
<span id="annotated-cell-16-3"><a href="#annotated-cell-16-3" aria-hidden="true" tabindex="-1"></a>  product, </span>
<span id="annotated-cell-16-4"><a href="#annotated-cell-16-4" aria-hidden="true" tabindex="-1"></a>  amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-16" data-target-annotation="1">1</button><span id="annotated-cell-16-5" class="code-annotation-target"><a href="#annotated-cell-16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span>) <span class="kw">AS</span> total_amount</span>
<span id="annotated-cell-16-6"><a href="#annotated-cell-16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-16" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-16" data-code-lines="5" data-code-annotation="1">Get the total amount of each partition.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="xtyvzmskkx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#xtyvzmskkx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#xtyvzmskkx thead, #xtyvzmskkx tbody, #xtyvzmskkx tfoot, #xtyvzmskkx tr, #xtyvzmskkx td, #xtyvzmskkx th {
  border-style: none;
}

#xtyvzmskkx p {
  margin: 0;
  padding: 0;
}

#xtyvzmskkx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xtyvzmskkx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#xtyvzmskkx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xtyvzmskkx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xtyvzmskkx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xtyvzmskkx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtyvzmskkx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xtyvzmskkx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xtyvzmskkx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xtyvzmskkx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xtyvzmskkx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xtyvzmskkx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xtyvzmskkx .gt_spanner_row {
  border-bottom-style: hidden;
}

#xtyvzmskkx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#xtyvzmskkx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xtyvzmskkx .gt_from_md > :first-child {
  margin-top: 0;
}

#xtyvzmskkx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xtyvzmskkx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xtyvzmskkx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xtyvzmskkx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xtyvzmskkx .gt_row_group_first td {
  border-top-width: 2px;
}

#xtyvzmskkx .gt_row_group_first th {
  border-top-width: 2px;
}

#xtyvzmskkx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtyvzmskkx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xtyvzmskkx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xtyvzmskkx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtyvzmskkx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtyvzmskkx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xtyvzmskkx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#xtyvzmskkx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xtyvzmskkx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xtyvzmskkx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xtyvzmskkx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtyvzmskkx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xtyvzmskkx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xtyvzmskkx .gt_left {
  text-align: left;
}

#xtyvzmskkx .gt_center {
  text-align: center;
}

#xtyvzmskkx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xtyvzmskkx .gt_font_normal {
  font-weight: normal;
}

#xtyvzmskkx .gt_font_bold {
  font-weight: bold;
}

#xtyvzmskkx .gt_font_italic {
  font-style: italic;
}

#xtyvzmskkx .gt_super {
  font-size: 65%;
}

#xtyvzmskkx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#xtyvzmskkx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xtyvzmskkx .gt_indent_1 {
  text-indent: 5px;
}

#xtyvzmskkx .gt_indent_2 {
  text-indent: 10px;
}

#xtyvzmskkx .gt_indent_3 {
  text-indent: 15px;
}

#xtyvzmskkx .gt_indent_4 {
  text-indent: 20px;
}

#xtyvzmskkx .gt_indent_5 {
  text-indent: 25px;
}

#xtyvzmskkx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#xtyvzmskkx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="total_amount">total_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">240</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="total_amount" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">180</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    sales_date, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> running_total</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="uauqpogque" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#uauqpogque table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#uauqpogque thead, #uauqpogque tbody, #uauqpogque tfoot, #uauqpogque tr, #uauqpogque td, #uauqpogque th {
  border-style: none;
}

#uauqpogque p {
  margin: 0;
  padding: 0;
}

#uauqpogque .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uauqpogque .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#uauqpogque .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uauqpogque .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uauqpogque .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uauqpogque .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uauqpogque .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uauqpogque .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uauqpogque .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uauqpogque .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uauqpogque .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uauqpogque .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uauqpogque .gt_spanner_row {
  border-bottom-style: hidden;
}

#uauqpogque .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#uauqpogque .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uauqpogque .gt_from_md > :first-child {
  margin-top: 0;
}

#uauqpogque .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uauqpogque .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uauqpogque .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#uauqpogque .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uauqpogque .gt_row_group_first td {
  border-top-width: 2px;
}

#uauqpogque .gt_row_group_first th {
  border-top-width: 2px;
}

#uauqpogque .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uauqpogque .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uauqpogque .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uauqpogque .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uauqpogque .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uauqpogque .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uauqpogque .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#uauqpogque .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uauqpogque .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uauqpogque .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uauqpogque .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uauqpogque .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uauqpogque .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uauqpogque .gt_left {
  text-align: left;
}

#uauqpogque .gt_center {
  text-align: center;
}

#uauqpogque .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uauqpogque .gt_font_normal {
  font-weight: normal;
}

#uauqpogque .gt_font_bold {
  font-weight: bold;
}

#uauqpogque .gt_font_italic {
  font-style: italic;
}

#uauqpogque .gt_super {
  font-size: 65%;
}

#uauqpogque .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#uauqpogque .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uauqpogque .gt_indent_1 {
  text-indent: 5px;
}

#uauqpogque .gt_indent_2 {
  text-indent: 10px;
}

#uauqpogque .gt_indent_3 {
  text-indent: 15px;
}

#uauqpogque .gt_indent_4 {
  text-indent: 20px;
}

#uauqpogque .gt_indent_5 {
  text-indent: 25px;
}

#uauqpogque .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#uauqpogque div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="running_total">running_total</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="running_total" class="gt_row gt_right">550</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="running_total" class="gt_row gt_right">600</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="running_total" class="gt_row gt_right">400</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">650</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="running_total" class="gt_row gt_right">900</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="running_total" class="gt_row gt_right">1250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="rank" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="rank"><span class="header-section-number">7.2.3</span> RANK</h3>
<p>Ranks the rows within a partition. Ties result in the same rank, but with gaps in the sequence.</p>
<section id="quick-illustration" class="level4" data-number="7.2.3.1">
<h4 data-number="7.2.3.1" class="anchored" data-anchor-id="quick-illustration"><span class="header-section-number">7.2.3.1</span> Quick Illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    product,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    amount</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="bnbqclikyi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#bnbqclikyi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#bnbqclikyi thead, #bnbqclikyi tbody, #bnbqclikyi tfoot, #bnbqclikyi tr, #bnbqclikyi td, #bnbqclikyi th {
  border-style: none;
}

#bnbqclikyi p {
  margin: 0;
  padding: 0;
}

#bnbqclikyi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bnbqclikyi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bnbqclikyi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bnbqclikyi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bnbqclikyi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bnbqclikyi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bnbqclikyi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bnbqclikyi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bnbqclikyi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bnbqclikyi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bnbqclikyi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bnbqclikyi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bnbqclikyi .gt_spanner_row {
  border-bottom-style: hidden;
}

#bnbqclikyi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bnbqclikyi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bnbqclikyi .gt_from_md > :first-child {
  margin-top: 0;
}

#bnbqclikyi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bnbqclikyi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bnbqclikyi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bnbqclikyi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bnbqclikyi .gt_row_group_first td {
  border-top-width: 2px;
}

#bnbqclikyi .gt_row_group_first th {
  border-top-width: 2px;
}

#bnbqclikyi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bnbqclikyi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bnbqclikyi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bnbqclikyi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bnbqclikyi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bnbqclikyi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bnbqclikyi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#bnbqclikyi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bnbqclikyi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bnbqclikyi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bnbqclikyi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bnbqclikyi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bnbqclikyi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bnbqclikyi .gt_left {
  text-align: left;
}

#bnbqclikyi .gt_center {
  text-align: center;
}

#bnbqclikyi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bnbqclikyi .gt_font_normal {
  font-weight: normal;
}

#bnbqclikyi .gt_font_bold {
  font-weight: bold;
}

#bnbqclikyi .gt_font_italic {
  font-style: italic;
}

#bnbqclikyi .gt_super {
  font-size: 65%;
}

#bnbqclikyi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#bnbqclikyi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bnbqclikyi .gt_indent_1 {
  text-indent: 5px;
}

#bnbqclikyi .gt_indent_2 {
  text-indent: 10px;
}

#bnbqclikyi .gt_indent_3 {
  text-indent: 15px;
}

#bnbqclikyi .gt_indent_4 {
  text-indent: 20px;
}

#bnbqclikyi .gt_indent_5 {
  text-indent: 25px;
}

#bnbqclikyi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#bnbqclikyi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">4</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">rank</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="icpgeiwbwu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#icpgeiwbwu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#icpgeiwbwu thead, #icpgeiwbwu tbody, #icpgeiwbwu tfoot, #icpgeiwbwu tr, #icpgeiwbwu td, #icpgeiwbwu th {
  border-style: none;
}

#icpgeiwbwu p {
  margin: 0;
  padding: 0;
}

#icpgeiwbwu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#icpgeiwbwu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#icpgeiwbwu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#icpgeiwbwu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#icpgeiwbwu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#icpgeiwbwu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#icpgeiwbwu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#icpgeiwbwu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#icpgeiwbwu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#icpgeiwbwu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#icpgeiwbwu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#icpgeiwbwu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#icpgeiwbwu .gt_spanner_row {
  border-bottom-style: hidden;
}

#icpgeiwbwu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#icpgeiwbwu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#icpgeiwbwu .gt_from_md > :first-child {
  margin-top: 0;
}

#icpgeiwbwu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#icpgeiwbwu .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#icpgeiwbwu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#icpgeiwbwu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#icpgeiwbwu .gt_row_group_first td {
  border-top-width: 2px;
}

#icpgeiwbwu .gt_row_group_first th {
  border-top-width: 2px;
}

#icpgeiwbwu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#icpgeiwbwu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#icpgeiwbwu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#icpgeiwbwu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#icpgeiwbwu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#icpgeiwbwu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#icpgeiwbwu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#icpgeiwbwu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#icpgeiwbwu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#icpgeiwbwu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#icpgeiwbwu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#icpgeiwbwu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#icpgeiwbwu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#icpgeiwbwu .gt_left {
  text-align: left;
}

#icpgeiwbwu .gt_center {
  text-align: center;
}

#icpgeiwbwu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#icpgeiwbwu .gt_font_normal {
  font-weight: normal;
}

#icpgeiwbwu .gt_font_bold {
  font-weight: bold;
}

#icpgeiwbwu .gt_font_italic {
  font-style: italic;
}

#icpgeiwbwu .gt_super {
  font-size: 65%;
}

#icpgeiwbwu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#icpgeiwbwu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#icpgeiwbwu .gt_indent_1 {
  text-indent: 5px;
}

#icpgeiwbwu .gt_indent_2 {
  text-indent: 10px;
}

#icpgeiwbwu .gt_indent_3 {
  text-indent: 15px;
}

#icpgeiwbwu .gt_indent_4 {
  text-indent: 20px;
}

#icpgeiwbwu .gt_indent_5 {
  text-indent: 25px;
}

#icpgeiwbwu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#icpgeiwbwu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">5</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>If two rows have the same amount within the same store_id, they will get the same rank, and the next rank will be skipped.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="dense_rank" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="dense_rank"><span class="header-section-number">7.2.4</span> DENSE_RANK</h3>
<p>Similar to <code>RANK()</code>, but without gaps in the ranking sequence.</p>
<section id="quick-illustration-1" class="level4" data-number="7.2.4.1">
<h4 data-number="7.2.4.1" class="anchored" data-anchor-id="quick-illustration-1"><span class="header-section-number">7.2.4.1</span> Quick Illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    product,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    amount</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> <span class="dt">month</span> <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="stmwqswjfu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#stmwqswjfu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#stmwqswjfu thead, #stmwqswjfu tbody, #stmwqswjfu tfoot, #stmwqswjfu tr, #stmwqswjfu td, #stmwqswjfu th {
  border-style: none;
}

#stmwqswjfu p {
  margin: 0;
  padding: 0;
}

#stmwqswjfu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#stmwqswjfu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#stmwqswjfu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#stmwqswjfu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#stmwqswjfu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stmwqswjfu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stmwqswjfu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#stmwqswjfu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#stmwqswjfu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#stmwqswjfu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#stmwqswjfu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#stmwqswjfu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#stmwqswjfu .gt_spanner_row {
  border-bottom-style: hidden;
}

#stmwqswjfu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#stmwqswjfu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#stmwqswjfu .gt_from_md > :first-child {
  margin-top: 0;
}

#stmwqswjfu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#stmwqswjfu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#stmwqswjfu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#stmwqswjfu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#stmwqswjfu .gt_row_group_first td {
  border-top-width: 2px;
}

#stmwqswjfu .gt_row_group_first th {
  border-top-width: 2px;
}

#stmwqswjfu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stmwqswjfu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#stmwqswjfu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#stmwqswjfu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stmwqswjfu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#stmwqswjfu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#stmwqswjfu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#stmwqswjfu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#stmwqswjfu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#stmwqswjfu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stmwqswjfu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stmwqswjfu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#stmwqswjfu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#stmwqswjfu .gt_left {
  text-align: left;
}

#stmwqswjfu .gt_center {
  text-align: center;
}

#stmwqswjfu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#stmwqswjfu .gt_font_normal {
  font-weight: normal;
}

#stmwqswjfu .gt_font_bold {
  font-weight: bold;
}

#stmwqswjfu .gt_font_italic {
  font-style: italic;
}

#stmwqswjfu .gt_super {
  font-size: 65%;
}

#stmwqswjfu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#stmwqswjfu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#stmwqswjfu .gt_indent_1 {
  text-indent: 5px;
}

#stmwqswjfu .gt_indent_2 {
  text-indent: 10px;
}

#stmwqswjfu .gt_indent_3 {
  text-indent: 15px;
}

#stmwqswjfu .gt_indent_4 {
  text-indent: 20px;
}

#stmwqswjfu .gt_indent_5 {
  text-indent: 25px;
}

#stmwqswjfu .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#stmwqswjfu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="dense_rank">dense_rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">120</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">100</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bolder;">Jan</td>
<td headers="product" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FAEBD7; font-weight: bold; color: #404040;">20</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #CD661D; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">80</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">70</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bolder;">Feb</td>
<td headers="product" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: normal;">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #C1FFC1; font-weight: bold; color: #404040;">30</td>
<td headers="dense_rank" class="gt_row gt_center" style="color: #458B74; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">DENSE_RANK</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> <span class="fu">dense_rank</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="djonftaizw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#djonftaizw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#djonftaizw thead, #djonftaizw tbody, #djonftaizw tfoot, #djonftaizw tr, #djonftaizw td, #djonftaizw th {
  border-style: none;
}

#djonftaizw p {
  margin: 0;
  padding: 0;
}

#djonftaizw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#djonftaizw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#djonftaizw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#djonftaizw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#djonftaizw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#djonftaizw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djonftaizw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#djonftaizw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#djonftaizw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#djonftaizw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#djonftaizw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#djonftaizw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#djonftaizw .gt_spanner_row {
  border-bottom-style: hidden;
}

#djonftaizw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#djonftaizw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#djonftaizw .gt_from_md > :first-child {
  margin-top: 0;
}

#djonftaizw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#djonftaizw .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#djonftaizw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#djonftaizw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#djonftaizw .gt_row_group_first td {
  border-top-width: 2px;
}

#djonftaizw .gt_row_group_first th {
  border-top-width: 2px;
}

#djonftaizw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#djonftaizw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#djonftaizw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#djonftaizw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djonftaizw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#djonftaizw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#djonftaizw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#djonftaizw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#djonftaizw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#djonftaizw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#djonftaizw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#djonftaizw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#djonftaizw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#djonftaizw .gt_left {
  text-align: left;
}

#djonftaizw .gt_center {
  text-align: center;
}

#djonftaizw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#djonftaizw .gt_font_normal {
  font-weight: normal;
}

#djonftaizw .gt_font_bold {
  font-weight: bold;
}

#djonftaizw .gt_font_italic {
  font-style: italic;
}

#djonftaizw .gt_super {
  font-size: 65%;
}

#djonftaizw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#djonftaizw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#djonftaizw .gt_indent_1 {
  text-indent: 5px;
}

#djonftaizw .gt_indent_2 {
  text-indent: 10px;
}

#djonftaizw .gt_indent_3 {
  text-indent: 15px;
}

#djonftaizw .gt_indent_4 {
  text-indent: 20px;
}

#djonftaizw .gt_indent_5 {
  text-indent: 25px;
}

#djonftaizw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#djonftaizw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rank">rank</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="rank" class="gt_row gt_right">4</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="rank" class="gt_row gt_right">1</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="rank" class="gt_row gt_right">2</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="rank" class="gt_row gt_right">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This will rank rows without gaps, even if there are ties.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="ntile" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="ntile"><span class="header-section-number">7.2.5</span> NTILE</h3>
<p>Divides the result set into a specified number of buckets.</p>
<section id="quick-illustration-2" class="level4" data-number="7.2.5.1">
<h4 data-number="7.2.5.1" class="anchored" data-anchor-id="quick-illustration-2"><span class="header-section-number">7.2.5.1</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    product, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">3</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="weigvgruxv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#weigvgruxv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#weigvgruxv thead, #weigvgruxv tbody, #weigvgruxv tfoot, #weigvgruxv tr, #weigvgruxv td, #weigvgruxv th {
  border-style: none;
}

#weigvgruxv p {
  margin: 0;
  padding: 0;
}

#weigvgruxv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#weigvgruxv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#weigvgruxv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#weigvgruxv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#weigvgruxv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#weigvgruxv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#weigvgruxv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#weigvgruxv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#weigvgruxv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#weigvgruxv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#weigvgruxv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#weigvgruxv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#weigvgruxv .gt_spanner_row {
  border-bottom-style: hidden;
}

#weigvgruxv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#weigvgruxv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#weigvgruxv .gt_from_md > :first-child {
  margin-top: 0;
}

#weigvgruxv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#weigvgruxv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#weigvgruxv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#weigvgruxv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#weigvgruxv .gt_row_group_first td {
  border-top-width: 2px;
}

#weigvgruxv .gt_row_group_first th {
  border-top-width: 2px;
}

#weigvgruxv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#weigvgruxv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#weigvgruxv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#weigvgruxv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#weigvgruxv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#weigvgruxv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#weigvgruxv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#weigvgruxv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#weigvgruxv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#weigvgruxv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#weigvgruxv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#weigvgruxv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#weigvgruxv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#weigvgruxv .gt_left {
  text-align: left;
}

#weigvgruxv .gt_center {
  text-align: center;
}

#weigvgruxv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#weigvgruxv .gt_font_normal {
  font-weight: normal;
}

#weigvgruxv .gt_font_bold {
  font-weight: bold;
}

#weigvgruxv .gt_font_italic {
  font-style: italic;
}

#weigvgruxv .gt_super {
  font-size: 65%;
}

#weigvgruxv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#weigvgruxv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#weigvgruxv .gt_indent_1 {
  text-indent: 5px;
}

#weigvgruxv .gt_indent_2 {
  text-indent: 10px;
}

#weigvgruxv .gt_indent_3 {
  text-indent: 15px;
}

#weigvgruxv .gt_indent_4 {
  text-indent: 20px;
}

#weigvgruxv .gt_indent_5 {
  text-indent: 25px;
}

#weigvgruxv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#weigvgruxv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col style="width:250px;">
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">20</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">30</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">30</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF7F24; font-size: 20; font-weight: bolder;">1</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">70</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">80</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #FF1493; font-size: 20; font-weight: bolder;">2</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">120</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">3</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">120</td>
<td headers="bucket" class="gt_row gt_center" style="background-color: #76EEC6; font-size: 20; font-weight: bolder;">3</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    sales_id, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">NTILE</span>(<span class="dv">4</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> bucket</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="anaurpdirl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#anaurpdirl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#anaurpdirl thead, #anaurpdirl tbody, #anaurpdirl tfoot, #anaurpdirl tr, #anaurpdirl td, #anaurpdirl th {
  border-style: none;
}

#anaurpdirl p {
  margin: 0;
  padding: 0;
}

#anaurpdirl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#anaurpdirl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#anaurpdirl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#anaurpdirl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#anaurpdirl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#anaurpdirl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#anaurpdirl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#anaurpdirl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#anaurpdirl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#anaurpdirl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#anaurpdirl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#anaurpdirl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#anaurpdirl .gt_spanner_row {
  border-bottom-style: hidden;
}

#anaurpdirl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#anaurpdirl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#anaurpdirl .gt_from_md > :first-child {
  margin-top: 0;
}

#anaurpdirl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#anaurpdirl .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#anaurpdirl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#anaurpdirl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#anaurpdirl .gt_row_group_first td {
  border-top-width: 2px;
}

#anaurpdirl .gt_row_group_first th {
  border-top-width: 2px;
}

#anaurpdirl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#anaurpdirl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#anaurpdirl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#anaurpdirl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#anaurpdirl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#anaurpdirl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#anaurpdirl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#anaurpdirl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#anaurpdirl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#anaurpdirl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#anaurpdirl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#anaurpdirl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#anaurpdirl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#anaurpdirl .gt_left {
  text-align: left;
}

#anaurpdirl .gt_center {
  text-align: center;
}

#anaurpdirl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#anaurpdirl .gt_font_normal {
  font-weight: normal;
}

#anaurpdirl .gt_font_bold {
  font-weight: bold;
}

#anaurpdirl .gt_font_italic {
  font-style: italic;
}

#anaurpdirl .gt_super {
  font-size: 65%;
}

#anaurpdirl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#anaurpdirl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#anaurpdirl .gt_indent_1 {
  text-indent: 5px;
}

#anaurpdirl .gt_indent_2 {
  text-indent: 10px;
}

#anaurpdirl .gt_indent_3 {
  text-indent: 15px;
}

#anaurpdirl .gt_indent_4 {
  text-indent: 20px;
}

#anaurpdirl .gt_indent_5 {
  text-indent: 25px;
}

#anaurpdirl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#anaurpdirl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_id">sales_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="bucket">bucket</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="sales_id" class="gt_row gt_right">1</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">100</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">2</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">6</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">150</td>
<td headers="bucket" class="gt_row gt_right">1</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">3</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">7</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">11</td>
<td headers="store_id" class="gt_row gt_right">102</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">200</td>
<td headers="bucket" class="gt_row gt_right">2</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">4</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">8</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">10</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">250</td>
<td headers="bucket" class="gt_row gt_right">3</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">5</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">300</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">9</td>
<td headers="store_id" class="gt_row gt_right">101</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
    <tr><td headers="sales_id" class="gt_row gt_right">12</td>
<td headers="store_id" class="gt_row gt_right">103</td>
<td headers="amount" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">350</td>
<td headers="bucket" class="gt_row gt_right">4</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>This divides the result set into 2 buckets based on the Amount. Rows with the highest amounts go into the first bucket, and so on.</p>
<p><br> <br> <br></p>
</section>
</section>
<section id="lag" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="lag"><span class="header-section-number">7.2.6</span> LAG</h3>
<p><code>LAG()</code> is a function that allows users to access data from a previous row within the same result set. It is particularly useful for performing comparisons between the current row and its preceding rows.</p>
<section id="basic-syntax" class="level4" data-number="7.2.6.1">
<h4 data-number="7.2.6.1" class="anchored" data-anchor-id="basic-syntax"><span class="header-section-number">7.2.6.1</span> Basic syntax</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LAG</span>(expression [, offset [, default_value]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><p><strong>expression:</strong> This is the column or expression from which you want to retrieve the value from a previous row.</p></li>
<li><p><strong>offset:</strong> This optional parameter specifies how many rows back to look. The default value is 1 if not specified.</p></li>
<li><p><strong>default_value:</strong> This optional parameter defines what value to return if there is no previous row available (e.g., when looking back beyond the first row). If omitted, NULL will be returned.</p></li>
</ul>
</section>
<section id="quick-illustration-3" class="level4" data-number="7.2.6.2">
<h4 data-number="7.2.6.2" class="anchored" data-anchor-id="quick-illustration-3"><span class="header-section-number">7.2.6.2</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-25-1"><a href="#annotated-cell-25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-25-2"><a href="#annotated-cell-25-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>,</span>
<span id="annotated-cell-25-3"><a href="#annotated-cell-25-3" aria-hidden="true" tabindex="-1"></a>      product,</span>
<span id="annotated-cell-25-4"><a href="#annotated-cell-25-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="1">1</button><span id="annotated-cell-25-5" class="code-annotation-target"><a href="#annotated-cell-25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="annotated-cell-25-6"><a href="#annotated-cell-25-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> tableName;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-25" data-code-lines="5" data-code-annotation="1">retrieve the value from the previous row in the amount column.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="vsvpyiroci" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vsvpyiroci table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vsvpyiroci thead, #vsvpyiroci tbody, #vsvpyiroci tfoot, #vsvpyiroci tr, #vsvpyiroci td, #vsvpyiroci th {
  border-style: none;
}

#vsvpyiroci p {
  margin: 0;
  padding: 0;
}

#vsvpyiroci .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vsvpyiroci .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vsvpyiroci .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vsvpyiroci .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vsvpyiroci .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vsvpyiroci .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vsvpyiroci .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vsvpyiroci .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vsvpyiroci .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vsvpyiroci .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vsvpyiroci .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vsvpyiroci .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vsvpyiroci .gt_spanner_row {
  border-bottom-style: hidden;
}

#vsvpyiroci .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vsvpyiroci .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vsvpyiroci .gt_from_md > :first-child {
  margin-top: 0;
}

#vsvpyiroci .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vsvpyiroci .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vsvpyiroci .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vsvpyiroci .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vsvpyiroci .gt_row_group_first td {
  border-top-width: 2px;
}

#vsvpyiroci .gt_row_group_first th {
  border-top-width: 2px;
}

#vsvpyiroci .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vsvpyiroci .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vsvpyiroci .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vsvpyiroci .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vsvpyiroci .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vsvpyiroci .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vsvpyiroci .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vsvpyiroci .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vsvpyiroci .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vsvpyiroci .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vsvpyiroci .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vsvpyiroci .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vsvpyiroci .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vsvpyiroci .gt_left {
  text-align: left;
}

#vsvpyiroci .gt_center {
  text-align: center;
}

#vsvpyiroci .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vsvpyiroci .gt_font_normal {
  font-weight: normal;
}

#vsvpyiroci .gt_font_bold {
  font-weight: bold;
}

#vsvpyiroci .gt_font_italic {
  font-style: italic;
}

#vsvpyiroci .gt_super {
  font-size: 65%;
}

#vsvpyiroci .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vsvpyiroci .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vsvpyiroci .gt_indent_1 {
  text-indent: 5px;
}

#vsvpyiroci .gt_indent_2 {
  text-indent: 10px;
}

#vsvpyiroci .gt_indent_3 {
  text-indent: 15px;
}

#vsvpyiroci .gt_indent_4 {
  text-indent: 20px;
}

#vsvpyiroci .gt_indent_5 {
  text-indent: 25px;
}

#vsvpyiroci .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vsvpyiroci div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">100</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #CD69C9; font-size: 20; font-weight: bolder;">0</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">120</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">100</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">20</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">120</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">80</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">20</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">70</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">80</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center">30</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">70</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong> Get the previous row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="lumihkbinq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#lumihkbinq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#lumihkbinq thead, #lumihkbinq tbody, #lumihkbinq tfoot, #lumihkbinq tr, #lumihkbinq td, #lumihkbinq th {
  border-style: none;
}

#lumihkbinq p {
  margin: 0;
  padding: 0;
}

#lumihkbinq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#lumihkbinq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#lumihkbinq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#lumihkbinq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#lumihkbinq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lumihkbinq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lumihkbinq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#lumihkbinq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#lumihkbinq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#lumihkbinq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#lumihkbinq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#lumihkbinq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#lumihkbinq .gt_spanner_row {
  border-bottom-style: hidden;
}

#lumihkbinq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#lumihkbinq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#lumihkbinq .gt_from_md > :first-child {
  margin-top: 0;
}

#lumihkbinq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#lumihkbinq .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#lumihkbinq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#lumihkbinq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#lumihkbinq .gt_row_group_first td {
  border-top-width: 2px;
}

#lumihkbinq .gt_row_group_first th {
  border-top-width: 2px;
}

#lumihkbinq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lumihkbinq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#lumihkbinq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#lumihkbinq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lumihkbinq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#lumihkbinq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#lumihkbinq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#lumihkbinq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#lumihkbinq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#lumihkbinq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lumihkbinq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lumihkbinq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#lumihkbinq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#lumihkbinq .gt_left {
  text-align: left;
}

#lumihkbinq .gt_center {
  text-align: center;
}

#lumihkbinq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#lumihkbinq .gt_font_normal {
  font-weight: normal;
}

#lumihkbinq .gt_font_bold {
  font-weight: bold;
}

#lumihkbinq .gt_font_italic {
  font-style: italic;
}

#lumihkbinq .gt_super {
  font-size: 65%;
}

#lumihkbinq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#lumihkbinq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#lumihkbinq .gt_indent_1 {
  text-indent: 5px;
}

#lumihkbinq .gt_indent_2 {
  text-indent: 10px;
}

#lumihkbinq .gt_indent_3 {
  text-indent: 15px;
}

#lumihkbinq .gt_indent_4 {
  text-indent: 20px;
}

#lumihkbinq .gt_indent_5 {
  text-indent: 25px;
}

#lumihkbinq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#lumihkbinq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="partition-by-store_id" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="pyrdemhkdj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pyrdemhkdj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pyrdemhkdj thead, #pyrdemhkdj tbody, #pyrdemhkdj tfoot, #pyrdemhkdj tr, #pyrdemhkdj td, #pyrdemhkdj th {
  border-style: none;
}

#pyrdemhkdj p {
  margin: 0;
  padding: 0;
}

#pyrdemhkdj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pyrdemhkdj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pyrdemhkdj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pyrdemhkdj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pyrdemhkdj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pyrdemhkdj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pyrdemhkdj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pyrdemhkdj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pyrdemhkdj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pyrdemhkdj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pyrdemhkdj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pyrdemhkdj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pyrdemhkdj .gt_spanner_row {
  border-bottom-style: hidden;
}

#pyrdemhkdj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pyrdemhkdj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pyrdemhkdj .gt_from_md > :first-child {
  margin-top: 0;
}

#pyrdemhkdj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pyrdemhkdj .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pyrdemhkdj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#pyrdemhkdj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pyrdemhkdj .gt_row_group_first td {
  border-top-width: 2px;
}

#pyrdemhkdj .gt_row_group_first th {
  border-top-width: 2px;
}

#pyrdemhkdj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pyrdemhkdj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pyrdemhkdj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pyrdemhkdj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pyrdemhkdj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pyrdemhkdj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pyrdemhkdj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pyrdemhkdj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pyrdemhkdj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pyrdemhkdj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pyrdemhkdj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pyrdemhkdj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pyrdemhkdj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pyrdemhkdj .gt_left {
  text-align: left;
}

#pyrdemhkdj .gt_center {
  text-align: center;
}

#pyrdemhkdj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pyrdemhkdj .gt_font_normal {
  font-weight: normal;
}

#pyrdemhkdj .gt_font_bold {
  font-weight: bold;
}

#pyrdemhkdj .gt_font_italic {
  font-style: italic;
}

#pyrdemhkdj .gt_super {
  font-size: 65%;
}

#pyrdemhkdj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pyrdemhkdj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pyrdemhkdj .gt_indent_1 {
  text-indent: 5px;
}

#pyrdemhkdj .gt_indent_2 {
  text-indent: 10px;
}

#pyrdemhkdj .gt_indent_3 {
  text-indent: 15px;
}

#pyrdemhkdj .gt_indent_4 {
  text-indent: 20px;
}

#pyrdemhkdj .gt_indent_5 {
  text-indent: 25px;
}

#pyrdemhkdj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pyrdemhkdj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">100</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="lead" class="level3" data-number="7.2.7">
<h3 data-number="7.2.7" class="anchored" data-anchor-id="lead"><span class="header-section-number">7.2.7</span> LEAD</h3>
<p>The <code>LEAD()</code> function allows users to access data from subsequent rows in a result set. It is particularly useful for comparing values between the current row and one or more following rows.</p>
<section id="basic-syntax-1" class="level4" data-number="7.2.7.1">
<h4 data-number="7.2.7.1" class="anchored" data-anchor-id="basic-syntax-1"><span class="header-section-number">7.2.7.1</span> Basic syntax</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">LEAD</span>(expression [, offset [, default_value]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><p><strong>expression:</strong> This is the column or expression whose value you want to retrieve from the following row.</p></li>
<li><p><strong>offset:</strong> This optional parameter specifies how many rows forward from the current row you want to look. If not specified, it defaults to 1.</p></li>
<li><p><strong>default_value:</strong> This optional parameter defines what value should be returned if there is no following row available (e.g., at the end of a dataset). By default, this is NULL.</p></li>
</ul>
</section>
<section id="quick-illustration-4" class="level4" data-number="7.2.7.2">
<h4 data-number="7.2.7.2" class="anchored" data-anchor-id="quick-illustration-4"><span class="header-section-number">7.2.7.2</span> Quick illustration</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="annotated-cell-29"><pre class="sourceCode sql code-annotation-code code-with-copy code-annotated"><code class="sourceCode sql"><span id="annotated-cell-29-1"><a href="#annotated-cell-29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="annotated-cell-29-2"><a href="#annotated-cell-29-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">month</span>,</span>
<span id="annotated-cell-29-3"><a href="#annotated-cell-29-3" aria-hidden="true" tabindex="-1"></a>      product,</span>
<span id="annotated-cell-29-4"><a href="#annotated-cell-29-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="1">1</button><span id="annotated-cell-29-5" class="code-annotation-target"><a href="#annotated-cell-29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> amount) <span class="kw">AS</span> next_amount</span>
<span id="annotated-cell-29-6"><a href="#annotated-cell-29-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-29" data-code-lines="5" data-code-annotation="1">retrieve the value from the next row in the amount column.</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="vscdahnphn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vscdahnphn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vscdahnphn thead, #vscdahnphn tbody, #vscdahnphn tfoot, #vscdahnphn tr, #vscdahnphn td, #vscdahnphn th {
  border-style: none;
}

#vscdahnphn p {
  margin: 0;
  padding: 0;
}

#vscdahnphn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 600px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vscdahnphn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vscdahnphn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vscdahnphn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vscdahnphn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vscdahnphn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vscdahnphn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vscdahnphn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vscdahnphn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vscdahnphn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vscdahnphn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vscdahnphn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vscdahnphn .gt_spanner_row {
  border-bottom-style: hidden;
}

#vscdahnphn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vscdahnphn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vscdahnphn .gt_from_md > :first-child {
  margin-top: 0;
}

#vscdahnphn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vscdahnphn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vscdahnphn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vscdahnphn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vscdahnphn .gt_row_group_first td {
  border-top-width: 2px;
}

#vscdahnphn .gt_row_group_first th {
  border-top-width: 2px;
}

#vscdahnphn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vscdahnphn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vscdahnphn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vscdahnphn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vscdahnphn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vscdahnphn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vscdahnphn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vscdahnphn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vscdahnphn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vscdahnphn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vscdahnphn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vscdahnphn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vscdahnphn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vscdahnphn .gt_left {
  text-align: left;
}

#vscdahnphn .gt_center {
  text-align: center;
}

#vscdahnphn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vscdahnphn .gt_font_normal {
  font-weight: normal;
}

#vscdahnphn .gt_font_bold {
  font-weight: bold;
}

#vscdahnphn .gt_font_italic {
  font-style: italic;
}

#vscdahnphn .gt_super {
  font-size: 65%;
}

#vscdahnphn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vscdahnphn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vscdahnphn .gt_indent_1 {
  text-indent: 5px;
}

#vscdahnphn .gt_indent_2 {
  text-indent: 10px;
}

#vscdahnphn .gt_indent_3 {
  text-indent: 15px;
}

#vscdahnphn .gt_indent_4 {
  text-indent: 20px;
}

#vscdahnphn .gt_indent_5 {
  text-indent: 25px;
}

#vscdahnphn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vscdahnphn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" style="table-layout: fixed;; width: 600px" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <colgroup>
    <col>
    <col>
    <col>
    <col>
  </colgroup>
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="month">month</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="product">product</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="next_amount">next_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center">100</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">120</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Shoe</td>
<td headers="amount" class="gt_row gt_center" style="color: #EE7621; font-size: 20; font-weight: bolder;">120</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">20</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Jan</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #00008B; font-size: 20; font-weight: bolder;">20</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">80</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #6E8B3D; font-size: 20; font-weight: bolder;">80</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">70</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">T-Shirt</td>
<td headers="amount" class="gt_row gt_center" style="color: #EEC900; font-size: 20; font-weight: bolder;">70</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">30</td></tr>
    <tr><td headers="month" class="gt_row gt_center">Feb</td>
<td headers="product" class="gt_row gt_center">Cup</td>
<td headers="amount" class="gt_row gt_center" style="color: #FF1493; font-size: 20; font-weight: bolder;">30</td>
<td headers="new_amount" class="gt_row gt_center" style="color: #CD69C9; font-size: 20; font-weight: bolder;">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><strong>Example:</strong> Get the next row’s amount.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="wiqeppvdqa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wiqeppvdqa table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wiqeppvdqa thead, #wiqeppvdqa tbody, #wiqeppvdqa tfoot, #wiqeppvdqa tr, #wiqeppvdqa td, #wiqeppvdqa th {
  border-style: none;
}

#wiqeppvdqa p {
  margin: 0;
  padding: 0;
}

#wiqeppvdqa .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wiqeppvdqa .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wiqeppvdqa .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wiqeppvdqa .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wiqeppvdqa .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wiqeppvdqa .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wiqeppvdqa .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wiqeppvdqa .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wiqeppvdqa .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wiqeppvdqa .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wiqeppvdqa .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wiqeppvdqa .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wiqeppvdqa .gt_spanner_row {
  border-bottom-style: hidden;
}

#wiqeppvdqa .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wiqeppvdqa .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wiqeppvdqa .gt_from_md > :first-child {
  margin-top: 0;
}

#wiqeppvdqa .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wiqeppvdqa .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wiqeppvdqa .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#wiqeppvdqa .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wiqeppvdqa .gt_row_group_first td {
  border-top-width: 2px;
}

#wiqeppvdqa .gt_row_group_first th {
  border-top-width: 2px;
}

#wiqeppvdqa .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wiqeppvdqa .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wiqeppvdqa .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wiqeppvdqa .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wiqeppvdqa .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wiqeppvdqa .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wiqeppvdqa .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wiqeppvdqa .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wiqeppvdqa .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wiqeppvdqa .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wiqeppvdqa .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wiqeppvdqa .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wiqeppvdqa .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wiqeppvdqa .gt_left {
  text-align: left;
}

#wiqeppvdqa .gt_center {
  text-align: center;
}

#wiqeppvdqa .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wiqeppvdqa .gt_font_normal {
  font-weight: normal;
}

#wiqeppvdqa .gt_font_bold {
  font-weight: bold;
}

#wiqeppvdqa .gt_font_italic {
  font-style: italic;
}

#wiqeppvdqa .gt_super {
  font-size: 65%;
}

#wiqeppvdqa .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wiqeppvdqa .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wiqeppvdqa .gt_indent_1 {
  text-indent: 5px;
}

#wiqeppvdqa .gt_indent_2 {
  text-indent: 10px;
}

#wiqeppvdqa .gt_indent_3 {
  text-indent: 15px;
}

#wiqeppvdqa .gt_indent_4 {
  text-indent: 20px;
}

#wiqeppvdqa .gt_indent_5 {
  text-indent: 25px;
}

#wiqeppvdqa .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wiqeppvdqa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">101</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">102</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right">103</td>
<td headers="sales_date" class="gt_row gt_right" style="color: #2F4F4F; font-weight: bolder;">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="partition-by-store_id-1" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="partition-by-store_id-1">PARTITION BY store_id</h4>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    store_id,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>      sales_date,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LEAD</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> next_amount</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="twpxblxqyv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#twpxblxqyv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#twpxblxqyv thead, #twpxblxqyv tbody, #twpxblxqyv tfoot, #twpxblxqyv tr, #twpxblxqyv td, #twpxblxqyv th {
  border-style: none;
}

#twpxblxqyv p {
  margin: 0;
  padding: 0;
}

#twpxblxqyv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#twpxblxqyv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#twpxblxqyv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#twpxblxqyv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#twpxblxqyv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twpxblxqyv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twpxblxqyv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#twpxblxqyv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#twpxblxqyv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 13px;
  font-weight: bold;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#twpxblxqyv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#twpxblxqyv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#twpxblxqyv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#twpxblxqyv .gt_spanner_row {
  border-bottom-style: hidden;
}

#twpxblxqyv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#twpxblxqyv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#twpxblxqyv .gt_from_md > :first-child {
  margin-top: 0;
}

#twpxblxqyv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#twpxblxqyv .gt_row {
  padding-top: 2px;
  padding-bottom: 2px;
  padding-left: 2px;
  padding-right: 2px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#twpxblxqyv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 2px;
  padding-right: 2px;
}

#twpxblxqyv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#twpxblxqyv .gt_row_group_first td {
  border-top-width: 2px;
}

#twpxblxqyv .gt_row_group_first th {
  border-top-width: 2px;
}

#twpxblxqyv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#twpxblxqyv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#twpxblxqyv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#twpxblxqyv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twpxblxqyv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#twpxblxqyv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#twpxblxqyv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#twpxblxqyv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#twpxblxqyv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#twpxblxqyv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twpxblxqyv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#twpxblxqyv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#twpxblxqyv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#twpxblxqyv .gt_left {
  text-align: left;
}

#twpxblxqyv .gt_center {
  text-align: center;
}

#twpxblxqyv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#twpxblxqyv .gt_font_normal {
  font-weight: normal;
}

#twpxblxqyv .gt_font_bold {
  font-weight: bold;
}

#twpxblxqyv .gt_font_italic {
  font-style: italic;
}

#twpxblxqyv .gt_super {
  font-size: 65%;
}

#twpxblxqyv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#twpxblxqyv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#twpxblxqyv .gt_indent_1 {
  text-indent: 5px;
}

#twpxblxqyv .gt_indent_2 {
  text-indent: 10px;
}

#twpxblxqyv .gt_indent_3 {
  text-indent: 15px;
}

#twpxblxqyv .gt_indent_4 {
  text-indent: 20px;
}

#twpxblxqyv .gt_indent_5 {
  text-indent: 25px;
}

#twpxblxqyv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#twpxblxqyv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="gt_table" data-quarto-disable-processing="true" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="store_id">store_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sales_date">sales_date</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="amount">amount</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="previous_amount">previous_amount</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">100</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-01</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">300</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">300</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #141414; font-weight: bolder;">101</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">200</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #616161; font-weight: bolder;">102</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">200</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-02</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">150</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-03</td>
<td headers="amount" class="gt_row gt_right">150</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-04</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">250</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-05</td>
<td headers="amount" class="gt_row gt_right">250</td>
<td headers="previous_amount" class="gt_row gt_right">350</td></tr>
    <tr><td headers="store_id" class="gt_row gt_right" style="color: #A1A1A1; font-weight: bolder;">103</td>
<td headers="sales_date" class="gt_row gt_right">2024-01-06</td>
<td headers="amount" class="gt_row gt_right">350</td>
<td headers="previous_amount" class="gt_row gt_right">0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p><br> <br> <br></p>
</section>
</section>
<section id="combining-multiple-window-functions" class="level3" data-number="7.2.8">
<h3 data-number="7.2.8" class="anchored" data-anchor-id="combining-multiple-window-functions"><span class="header-section-number">7.2.8</span> Combining multiple window functions</h3>
<p>You can combine multiple window functions in a single query.</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    store_id, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    amount,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ROW_NUMBER</span>() <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id <span class="kw">ORDER</span> <span class="kw">BY</span> amount <span class="kw">DESC</span>) <span class="kw">AS</span> row_num,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">SUM</span>(amount) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> store_id) <span class="kw">AS</span> total_amount,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">LAG</span>(amount, <span class="dv">1</span>, <span class="dv">0</span>) <span class="kw">OVER</span> (<span class="kw">ORDER</span> <span class="kw">BY</span> sales_date) <span class="kw">AS</span> previous_amount</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> sales;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>This query assigns a row number, calculates the total amount per store, and retrieves the previous amount for each sale.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<code>FRAME</code> Clause
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>SQL</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AVG</span>(sale) <span class="kw">OVER</span> (<span class="kw">PARTITION</span> <span class="kw">BY</span> col_name2 <span class="kw">ORDER</span> <span class="kw">BY</span> col_name3 <span class="kw">ROWS</span> <span class="kw">BETWEEN</span> <span class="kw">CURRENT</span> <span class="kw">ROW</span> <span class="kw">AND</span> <span class="kw">UNBOUNDED</span> <span class="kw">PRECEDING</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<ul>
<li><strong>ROWS:</strong> The frame type. values such as ROWS or RANGE</li>
<li><strong>CURRENT ROW:</strong> The frame boundary (Lower value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING</li>
<li><strong>UNBOUNDED PRECEDING:</strong> The frame Boundary (Higher value). It can include values such as CURRENT ROW, N PRECEDING or UNBOUNDED PRECEDING.</li>
</ul>
<p><br></p>
<p><strong>Rules:</strong> - You can only use the Frame clause with Order by clause.</p>
<ul>
<li>The lower value should be placed before the higher value.</li>
</ul>
</div>
</div>
</div>
<p><br> <br> <br></p>
<!------- Window Function -------------------------------------------------->
</section>
</section>
<section id="task" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="task"><span class="header-section-number">7.3</span> Task</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./sql_data_cleaning.html" class="pagination-link" aria-label="Data Cleaning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Cleaning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./sql_join.html" class="pagination-link" aria-label="Joins">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Joins</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>